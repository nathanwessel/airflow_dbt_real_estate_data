

============================== 2023-06-30 00:55:07.760590 | 536f22d4-8264-402e-a4c2-4abce3229263 ==============================
[0m00:55:07.760590 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:55:07.762044 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:55:07.762259 [debug] [MainThread]: Tracking: tracking
[0m00:55:07.781390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7dae0>]}
[0m00:55:08.099744 [debug] [MainThread]: Executing "git --help"
[0m00:55:08.124152 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:55:08.124813 [debug] [MainThread]: STDERR: "b''"
[0m00:55:08.133018 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:55:08.134682 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:55:08.134926 [debug] [MainThread]: On debug: select 1 as id
[0m00:55:08.135093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:09.597810 [debug] [MainThread]: SQL status: SUCCESS 1 in 1 seconds
[0m00:55:09.599291 [debug] [MainThread]: On debug: Close
[0m00:55:09.871994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b00d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f74eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b3cdf0>]}
[0m00:55:09.872691 [debug] [MainThread]: Flushing usage events
[0m00:55:10.543730 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-06-30 01:00:31.340341 | 442c4066-7838-4456-8ca6-3f13e6e9590c ==============================
[0m01:00:31.340341 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:00:31.341794 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m01:00:31.341963 [debug] [MainThread]: Tracking: tracking
[0m01:00:31.365134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf1a50>]}
[0m01:00:31.696790 [debug] [MainThread]: Executing "git --help"
[0m01:00:31.724374 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:00:31.725018 [debug] [MainThread]: STDERR: "b''"
[0m01:00:31.733406 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:00:31.734296 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:00:31.734457 [debug] [MainThread]: On debug: select 1 as id
[0m01:00:31.734610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:33.356484 [debug] [MainThread]: SQL status: SUCCESS 1 in 2 seconds
[0m01:00:33.357897 [debug] [MainThread]: On debug: Close
[0m01:00:33.617262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201c99c0>]}
[0m01:00:33.618384 [debug] [MainThread]: Flushing usage events
[0m01:00:34.553315 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-06-30 01:00:48.586209 | 1eb900d1-fd80-497a-a3c7-3f2d8447cdfb ==============================
[0m01:00:48.586209 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:00:48.587520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m01:00:48.587677 [debug] [MainThread]: Tracking: tracking
[0m01:00:48.608432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106826e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106825ae0>]}
[0m01:00:48.935880 [debug] [MainThread]: Executing "git --help"
[0m01:00:48.964755 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:00:48.965300 [debug] [MainThread]: STDERR: "b''"
[0m01:00:48.971724 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:00:48.972651 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:00:48.972835 [debug] [MainThread]: On debug: select 1 as id
[0m01:00:48.973001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:50.344631 [debug] [MainThread]: SQL status: SUCCESS 1 in 1 seconds
[0m01:00:50.346097 [debug] [MainThread]: On debug: Close
[0m01:00:50.536130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107794d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782cdf0>]}
[0m01:00:50.536784 [debug] [MainThread]: Flushing usage events
[0m01:00:51.237049 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-07-03 16:33:13.283100 | 1e1310ed-b0bf-44fe-80d7-40f3614bdcfe ==============================
[0m16:33:13.283100 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:33:13.284778 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:33:13.284957 [debug] [MainThread]: Tracking: tracking
[0m16:33:13.306170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3ca0>]}
[0m16:33:13.308134 [debug] [MainThread]: Set downloads directory='/var/folders/bc/hzhmpw894rxgr_jl9kxy34km0000gn/T/dbt-downloads-ut96ktzq'
[0m16:33:13.308693 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:33:13.696107 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:33:13.696764 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:33:13.992088 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:33:13.999511 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:33:14.424095 [info ] [MainThread]:   Installed from version 1.1.1
[0m16:33:14.424422 [info ] [MainThread]:   Up to date!
[0m16:33:14.424704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1e1310ed-b0bf-44fe-80d7-40f3614bdcfe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a17b0>]}
[0m16:33:14.425749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a38e0>]}
[0m16:33:14.426218 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 16:56:43.981060 | cef37afd-915d-4868-bd5f-a325152b9818 ==============================
[0m16:56:43.981060 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:56:43.984562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:56:43.984880 [debug] [MainThread]: Tracking: tracking
[0m16:56:43.985625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109523010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109520c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109521e40>]}
[0m16:56:44.048372 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:56:44.053842 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:56:44.054121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106901e70>]}
[0m16:56:44.810167 [debug] [MainThread]: 1699: static parser successfully parsed staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:56:44.819239 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:56:44.821830 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:56:44.891432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe3e80>]}
[0m16:56:44.897601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f94d00>]}
[0m16:56:44.897846 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:56:44.898069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10315fd00>]}
[0m16:56:44.899276 [info ] [MainThread]: 
[0m16:56:44.901323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:44.902234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m16:56:44.912393 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m16:56:44.912644 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m16:56:44.912794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:46.711110 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m16:56:46.712540 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m16:56:46.874021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f08ca0>]}
[0m16:56:46.875158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:46.875627 [info ] [MainThread]: 
[0m16:56:46.880108 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:56:46.880365 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:56:46.880875 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m16:56:46.881056 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:56:46.891662 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:56:46.893079 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-07-03 16:56:46.881163 => 2023-07-03 16:56:46.893018
[0m16:56:46.893291 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:56:46.914703 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:56:46.916256 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:56:46.916698 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:56:46.916983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:47.520894 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9f48-0050-3987000a41ce
[0m16:56:47.521141 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m16:56:47.521361 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-07-03 16:56:46.893408 => 2023-07-03 16:56:47.521322
[0m16:56:47.521504 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m16:56:47.688790 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:56:47.689151 [error] [Thread-1 (]: 1 of 6 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.81s]
[0m16:56:47.690663 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:56:47.691207 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m16:56:47.691742 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:56:47.692671 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m16:56:47.693068 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m16:56:47.698794 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m16:56:47.699426 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-07-03 16:56:47.693311 => 2023-07-03 16:56:47.699367
[0m16:56:47.699631 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m16:56:47.746899 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m16:56:47.748054 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m16:56:47.748214 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:56:47.748346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:48.564056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9e30-0050-3987000a0162
[0m16:56:48.564553 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m16:56:48.565252 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-07-03 16:56:47.699748 => 2023-07-03 16:56:48.565133
[0m16:56:48.565640 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:56:48.724364 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m16:56:48.725039 [error] [Thread-1 (]: 2 of 6 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 1.03s]
[0m16:56:48.725534 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m16:56:48.725959 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m16:56:48.726433 [info ] [Thread-1 (]: 3 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m16:56:48.728205 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m16:56:48.728463 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m16:56:48.733881 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m16:56:48.735031 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-03 16:56:48.728594 => 2023-07-03 16:56:48.734844
[0m16:56:48.735521 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m16:56:48.738452 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m16:56:48.739539 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m16:56:48.739696 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m16:56:48.739846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:49.711577 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9fbb-0050-3987000a60ca
[0m16:56:49.712187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m16:56:49.712637 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-03 16:56:48.735804 => 2023-07-03 16:56:49.712558
[0m16:56:49.712939 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m16:56:49.861498 [debug] [Thread-1 (]: Database Error in test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_not_null_realty_mole_pr_3bb4300005e774a0ca7597884dbca3b7.sql
[0m16:56:49.862212 [error] [Thread-1 (]: 3 of 6 ERROR source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[31mERROR[0m in 1.14s]
[0m16:56:49.862745 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m16:56:49.863411 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m16:56:49.863923 [info ] [Thread-1 (]: 4 of 6 START test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m16:56:49.864945 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0'
[0m16:56:49.865406 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m16:56:49.873528 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m16:56:49.874157 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0 (compile): 2023-07-03 16:56:49.865660 => 2023-07-03 16:56:49.874105
[0m16:56:49.874359 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m16:56:49.878187 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m16:56:49.879941 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m16:56:49.880367 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID as unique_field,
    count(*) as n_records

from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is not null
group by _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:56:49.880711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:50.645981 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9fbb-0050-3987000a60ce
[0m16:56:50.646440 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m16:56:50.646871 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0 (execute): 2023-07-03 16:56:49.874482 => 2023-07-03 16:56:50.646790
[0m16:56:50.647166 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0: Close
[0m16:56:50.820221 [debug] [Thread-1 (]: Database Error in test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_unique_realty_mole_prop_63c5f22da60d46a3fd1151a3a7ff960c.sql
[0m16:56:50.820909 [error] [Thread-1 (]: 4 of 6 ERROR source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[31mERROR[0m in 0.96s]
[0m16:56:50.821425 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m16:56:50.821880 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m16:56:50.822290 [info ] [Thread-1 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:56:50.823526 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321'
[0m16:56:50.823906 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m16:56:50.829789 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m16:56:50.830345 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-07-03 16:56:50.824124 => 2023-07-03 16:56:50.830296
[0m16:56:50.830534 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m16:56:50.833249 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m16:56:50.834563 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m16:56:50.834776 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:56:50.834937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:51.478355 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9fbb-0050-3987000a60d2
[0m16:56:51.478789 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m16:56:51.479211 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-07-03 16:56:50.830648 => 2023-07-03 16:56:51.479131
[0m16:56:51.479594 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m16:56:51.617199 [debug] [Thread-1 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m16:56:51.617548 [error] [Thread-1 (]: 5 of 6 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.79s]
[0m16:56:51.617802 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m16:56:51.618039 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m16:56:51.618368 [info ] [Thread-1 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:56:51.618901 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493'
[0m16:56:51.619063 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m16:56:51.622113 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:56:51.622610 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-07-03 16:56:51.619169 => 2023-07-03 16:56:51.622568
[0m16:56:51.622765 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m16:56:51.624697 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:56:51.625346 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:56:51.625470 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:56:51.625583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:52.429049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9f48-0050-3987000a41d2
[0m16:56:52.429462 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.429872 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-07-03 16:56:51.622865 => 2023-07-03 16:56:52.429799
[0m16:56:52.430143 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m16:56:52.582925 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m16:56:52.583311 [error] [Thread-1 (]: 6 of 6 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.96s]
[0m16:56:52.583594 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m16:56:52.585134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:52.586014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:52.586346 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:56:52.586824 [info ] [MainThread]: 
[0m16:56:52.587635 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 7.69 seconds (7.69s).
[0m16:56:52.588083 [debug] [MainThread]: Command end result
[0m16:56:52.596898 [info ] [MainThread]: 
[0m16:56:52.597230 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m16:56:52.597418 [info ] [MainThread]: 
[0m16:56:52.597600 [error] [MainThread]: [33mDatabase Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:56:52.597822 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m16:56:52.598434 [error] [MainThread]:   Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.598922 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:56:52.599458 [info ] [MainThread]: 
[0m16:56:52.600091 [error] [MainThread]: [33mDatabase Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m16:56:52.600532 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m16:56:52.601008 [error] [MainThread]:   Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.601823 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m16:56:52.602495 [info ] [MainThread]: 
[0m16:56:52.603303 [error] [MainThread]: [33mDatabase Error in test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)[0m
[0m16:56:52.604097 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m16:56:52.604651 [error] [MainThread]:   Database 'RAW' does not exist or not authorized.
[0m16:56:52.605142 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_not_null_realty_mole_pr_3bb4300005e774a0ca7597884dbca3b7.sql
[0m16:56:52.605481 [info ] [MainThread]: 
[0m16:56:52.605680 [error] [MainThread]: [33mDatabase Error in test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)[0m
[0m16:56:52.606224 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m16:56:52.606582 [error] [MainThread]:   Database 'RAW' does not exist or not authorized.
[0m16:56:52.606838 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_unique_realty_mole_prop_63c5f22da60d46a3fd1151a3a7ff960c.sql
[0m16:56:52.609261 [info ] [MainThread]: 
[0m16:56:52.609451 [error] [MainThread]: [33mDatabase Error in test unique_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:56:52.609634 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m16:56:52.609796 [error] [MainThread]:   Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.610054 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m16:56:52.610323 [info ] [MainThread]: 
[0m16:56:52.610512 [error] [MainThread]: [33mDatabase Error in test unique_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m16:56:52.610679 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m16:56:52.610839 [error] [MainThread]:   Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.610996 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m16:56:52.611195 [info ] [MainThread]: 
[0m16:56:52.611388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m16:56:52.611638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ca200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f2e60>]}
[0m16:56:52.611847 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 16:58:00.789715 | 40a99208-a176-44f1-86e0-02369da66ebb ==============================
[0m16:58:00.789715 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:58:00.793406 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:58:00.793859 [debug] [MainThread]: Tracking: tracking
[0m16:58:00.794184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108323010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108320c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108321e40>]}
[0m16:58:00.847294 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:58:00.884305 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 51 files added, 0 files changed.
[0m16:58:00.884699 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m16:58:00.884890 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m16:58:00.885053 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m16:58:00.885207 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m16:58:00.885359 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m16:58:00.885511 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m16:58:00.885654 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m16:58:00.885803 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m16:58:00.885947 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m16:58:00.886093 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m16:58:00.886263 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m16:58:00.886405 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m16:58:00.886548 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m16:58:00.886688 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m16:58:00.886829 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m16:58:00.886968 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m16:58:00.887108 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m16:58:00.887245 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m16:58:00.887540 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m16:58:00.887722 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m16:58:00.887881 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m16:58:00.888031 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m16:58:00.888180 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m16:58:00.888324 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m16:58:00.888525 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m16:58:00.888673 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m16:58:00.888814 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m16:58:00.888952 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m16:58:00.889092 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m16:58:00.889229 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m16:58:00.889375 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m16:58:00.889514 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m16:58:00.889651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m16:58:00.889790 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m16:58:00.889930 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m16:58:00.890073 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m16:58:00.890211 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m16:58:00.890351 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m16:58:00.890493 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m16:58:00.890655 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m16:58:00.890793 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m16:58:00.890932 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m16:58:00.891081 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m16:58:00.891221 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m16:58:00.891368 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m16:58:00.891507 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m16:58:00.891646 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m16:58:00.891783 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m16:58:00.891920 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m16:58:00.892090 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m16:58:00.892232 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m16:58:00.892528 [debug] [MainThread]: Partial parsing: deleted file: real_estate_dbt_project://models/example/my_first_dbt_model.sql
[0m16:58:00.892658 [debug] [MainThread]: Partial parsing: deleted file: real_estate_dbt_project://models/example/my_second_dbt_model.sql
[0m16:58:01.118105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m16:58:01.126317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d6050>]}
[0m16:58:01.137004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849a410>]}
[0m16:58:01.137797 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:58:01.138403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848f7c0>]}
[0m16:58:01.139396 [info ] [MainThread]: 
[0m16:58:01.141329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:01.142410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m16:58:01.159958 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m16:58:01.160265 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m16:58:01.160430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:02.299525 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:58:02.300817 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m16:58:02.449220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m16:58:02.454737 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m16:58:02.454955 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m16:58:02.455109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:03.342674 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m16:58:03.345751 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m16:58:03.496440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849ad70>]}
[0m16:58:03.497688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:03.498268 [info ] [MainThread]: 
[0m16:58:03.502773 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:03.503142 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m16:58:03.503922 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m16:58:03.504371 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:03.509417 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:03.510006 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 16:58:03.504650 => 2023-07-03 16:58:03.509874
[0m16:58:03.510337 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:03.551883 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:03.553464 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:03.554048 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m16:58:03.554464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:04.380997 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad621a-0504-9e30-0050-3987000a016e
[0m16:58:04.381253 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT_NDW'
[0m16:58:04.381480 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 16:58:03.510467 => 2023-07-03 16:58:04.381439
[0m16:58:04.381624 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m16:58:04.538031 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT_NDW'
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:58:04.538736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109757430>]}
[0m16:58:04.539335 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 1.04s]
[0m16:58:04.541537 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:04.542704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:04.543111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:04.543249 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m16:58:04.543395 [info ] [MainThread]: 
[0m16:58:04.543604 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m16:58:04.544001 [debug] [MainThread]: Command end result
[0m16:58:04.550240 [info ] [MainThread]: 
[0m16:58:04.550597 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:04.550796 [info ] [MainThread]: 
[0m16:58:04.550980 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m16:58:04.551253 [error] [MainThread]:   003001 (42501): SQL access control error:
[0m16:58:04.551430 [error] [MainThread]:   Insufficient privileges to operate on schema 'DBT_NDW'
[0m16:58:04.551906 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:58:04.552304 [info ] [MainThread]: 
[0m16:58:04.552831 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:04.553444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108499e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108498e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084996c0>]}
[0m16:58:04.553862 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 16:58:25.828164 | 7508af0c-3a5d-4f9a-85f9-525dfb4c8117 ==============================
[0m16:58:25.828164 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:58:25.837006 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:58:25.838253 [debug] [MainThread]: Tracking: tracking
[0m16:58:25.838600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fbae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112125450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112125420>]}
[0m16:58:25.904816 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:58:25.949388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:25.949759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:25.950522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m16:58:25.957650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d600d0>]}
[0m16:58:25.963834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d29990>]}
[0m16:58:25.964124 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:58:25.964511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b25960>]}
[0m16:58:25.966150 [info ] [MainThread]: 
[0m16:58:25.968095 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:25.969083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m16:58:25.981873 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m16:58:25.982162 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m16:58:25.982371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:26.962534 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:58:26.964824 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m16:58:27.151940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m16:58:27.160060 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m16:58:27.160296 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m16:58:27.160442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:28.048579 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m16:58:28.050960 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m16:58:28.204374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0efe0>]}
[0m16:58:28.205347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:28.205790 [info ] [MainThread]: 
[0m16:58:28.210351 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:28.211033 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m16:58:28.211678 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m16:58:28.211862 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:28.214008 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:28.214656 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 16:58:28.211980 => 2023-07-03 16:58:28.214599
[0m16:58:28.214869 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:28.245130 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:28.245830 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:28.245974 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m16:58:28.246095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:28.989973 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad621a-0504-9fbb-0050-3987000a60da
[0m16:58:28.990409 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT_NDW'
[0m16:58:28.990637 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 16:58:28.214995 => 2023-07-03 16:58:28.990595
[0m16:58:28.990942 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m16:58:29.139001 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT_NDW'
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:58:29.139667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da09a0>]}
[0m16:58:29.140295 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 0.93s]
[0m16:58:29.142425 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:29.143484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:29.143832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:29.143949 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m16:58:29.144085 [info ] [MainThread]: 
[0m16:58:29.144319 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m16:58:29.144623 [debug] [MainThread]: Command end result
[0m16:58:29.150670 [info ] [MainThread]: 
[0m16:58:29.150984 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:29.151200 [info ] [MainThread]: 
[0m16:58:29.151362 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m16:58:29.151748 [error] [MainThread]:   003001 (42501): SQL access control error:
[0m16:58:29.152152 [error] [MainThread]:   Insufficient privileges to operate on schema 'DBT_NDW'
[0m16:58:29.152496 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:58:29.152849 [info ] [MainThread]: 
[0m16:58:29.153160 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:29.153709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113383370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113383070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133832b0>]}
[0m16:58:29.154108 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:03:38.132868 | 41661397-7f2e-4d68-8a19-24eb6ebd8aa6 ==============================
[0m17:03:38.132868 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:03:38.141558 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:03:38.141720 [debug] [MainThread]: Tracking: tracking
[0m17:03:38.142035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119dbb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119db9de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119db8ee0>]}
[0m17:03:38.313091 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:03:38.378334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:38.378851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:38.379747 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:03:38.390675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f900d0>]}
[0m17:03:38.406008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f59840>]}
[0m17:03:38.407092 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:03:38.407661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f59750>]}
[0m17:03:38.409295 [info ] [MainThread]: 
[0m17:03:38.411108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:38.413081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:03:38.444907 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:03:38.445446 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:03:38.445830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:39.730232 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:03:39.737005 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:03:39.897451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:03:39.903508 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:03:39.903750 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:03:39.903928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:40.706955 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m17:03:40.713614 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:03:40.878683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2534c0>]}
[0m17:03:40.880123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:40.880493 [info ] [MainThread]: 
[0m17:03:40.885110 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:03:40.885535 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:03:40.886106 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:03:40.886600 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:03:40.895650 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:03:40.897423 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 17:03:40.886947 => 2023-07-03 17:03:40.897345
[0m17:03:40.898258 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:03:40.937085 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:03:40.938310 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:03:40.938696 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:03:40.938962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:41.755264 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad621f-0504-9e30-0050-3987000a0202
[0m17:03:41.755555 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT_NDW'
[0m17:03:41.755815 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 17:03:40.898439 => 2023-07-03 17:03:41.755769
[0m17:03:41.755981 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:03:41.901969 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT_NDW'
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m17:03:41.902745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2509a0>]}
[0m17:03:41.903399 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 1.02s]
[0m17:03:41.905836 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:03:41.907592 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:41.908423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:41.908759 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m17:03:41.909066 [info ] [MainThread]: 
[0m17:03:41.909588 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m17:03:41.910155 [debug] [MainThread]: Command end result
[0m17:03:41.921470 [info ] [MainThread]: 
[0m17:03:41.921826 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:41.922024 [info ] [MainThread]: 
[0m17:03:41.922209 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m17:03:41.922850 [error] [MainThread]:   003001 (42501): SQL access control error:
[0m17:03:41.923310 [error] [MainThread]:   Insufficient privileges to operate on schema 'DBT_NDW'
[0m17:03:41.923708 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m17:03:41.924162 [info ] [MainThread]: 
[0m17:03:41.924624 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:41.925073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1cf2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1cff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1cf340>]}
[0m17:03:41.925627 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:07:13.214092 | 4380fdad-d61b-40b3-8c2b-9749098bcc2f ==============================
[0m17:07:13.214092 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:07:13.218894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:07:13.219070 [debug] [MainThread]: Tracking: tracking
[0m17:07:13.219359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b23790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b21de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b20ee0>]}
[0m17:07:13.281147 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:07:13.327065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:13.327310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:13.327715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:07:13.335101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077680d0>]}
[0m17:07:13.346606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772d840>]}
[0m17:07:13.346973 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:07:13.347218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772d750>]}
[0m17:07:13.348408 [info ] [MainThread]: 
[0m17:07:13.349913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:13.350689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:07:13.369385 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:07:13.369687 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:07:13.369869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:14.442544 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:07:14.445089 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:07:14.597443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:07:14.602654 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:07:14.602861 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:07:14.603007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:15.516796 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m17:07:15.519179 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:07:15.673227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ab4c0>]}
[0m17:07:15.674251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:15.674693 [info ] [MainThread]: 
[0m17:07:15.679123 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:07:15.679675 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:07:15.680253 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:07:15.680439 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:07:15.683336 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:07:15.684497 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 17:07:15.680561 => 2023-07-03 17:07:15.684437
[0m17:07:15.684706 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:07:15.711572 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:07:15.712371 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:07:15.712530 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:07:15.712668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:16.431036 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6223-0504-9f86-0050-3987000a51f2
[0m17:07:16.431331 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m17:07:16.431593 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 17:07:15.684827 => 2023-07-03 17:07:16.431546
[0m17:07:16.431758 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:07:16.576181 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m17:07:16.576880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a89a0>]}
[0m17:07:16.577511 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 0.90s]
[0m17:07:16.579502 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:07:16.581461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:16.582266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:16.582563 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m17:07:16.582907 [info ] [MainThread]: 
[0m17:07:16.583307 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m17:07:16.583795 [debug] [MainThread]: Command end result
[0m17:07:16.592850 [info ] [MainThread]: 
[0m17:07:16.593189 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:07:16.593451 [info ] [MainThread]: 
[0m17:07:16.593667 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m17:07:16.594054 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m17:07:16.594246 [error] [MainThread]:   Database 'RAW' does not exist or not authorized.
[0m17:07:16.594420 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m17:07:16.594662 [info ] [MainThread]: 
[0m17:07:16.594998 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:07:16.595268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d872b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d87130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d874f0>]}
[0m17:07:16.595481 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:19:04.214811 | 0c9c63f1-8fce-42ff-b66e-762b3aa303c7 ==============================
[0m17:19:04.214811 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:19:04.218998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:19:04.219207 [debug] [MainThread]: Tracking: tracking
[0m17:19:04.219492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a027010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a025e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a024310>]}
[0m17:19:04.293398 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:19:04.329461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:04.329719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:04.330170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:19:04.338750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac500d0>]}
[0m17:19:04.349019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac157e0>]}
[0m17:19:04.349310 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:19:04.349518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac156f0>]}
[0m17:19:04.351401 [info ] [MainThread]: 
[0m17:19:04.352882 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:04.353602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:19:04.366554 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:19:04.366896 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:19:04.367083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:05.497044 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:19:05.500559 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:19:05.649453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:19:05.656270 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:19:05.656511 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:19:05.656659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:06.401222 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m17:19:06.403676 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:19:06.569112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abfee30>]}
[0m17:19:06.570136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:06.570538 [info ] [MainThread]: 
[0m17:19:06.573645 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:06.573973 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:19:06.574980 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:19:06.575370 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:06.577488 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:19:06.578279 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 17:19:06.575502 => 2023-07-03 17:19:06.578221
[0m17:19:06.578603 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:06.606170 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:19:06.607189 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:19:06.607368 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:19:06.607513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:07.658051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:19:07.679948 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 17:19:06.578904 => 2023-07-03 17:19:07.679896
[0m17:19:07.680238 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:19:07.818268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac949a0>]}
[0m17:19:07.819038 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.24s]
[0m17:19:07.821462 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:07.822921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:07.823707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:07.823987 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m17:19:07.824267 [info ] [MainThread]: 
[0m17:19:07.824654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m17:19:07.825172 [debug] [MainThread]: Command end result
[0m17:19:07.833327 [info ] [MainThread]: 
[0m17:19:07.833935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:07.834297 [info ] [MainThread]: 
[0m17:19:07.834637 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:19:07.835082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f32380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b36bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3689a0>]}
[0m17:19:07.835479 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:19:39.374157 | 94463f9d-8c20-441e-83a5-23a581be0c0f ==============================
[0m17:19:39.374157 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:19:39.377541 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m17:19:39.377721 [debug] [MainThread]: Tracking: tracking
[0m17:19:39.378043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb8f10>]}
[0m17:19:39.519453 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:19:39.595736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:39.596526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:39.598384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:19:39.615307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94463f9d-8c20-441e-83a5-23a581be0c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d900d0>]}
[0m17:19:39.628158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94463f9d-8c20-441e-83a5-23a581be0c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d59b40>]}
[0m17:19:39.628510 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:19:39.628754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94463f9d-8c20-441e-83a5-23a581be0c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d59780>]}
[0m17:19:39.630069 [info ] [MainThread]: 
[0m17:19:39.632966 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:39.635682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:19:39.663546 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:19:39.663885 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:19:39.664069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:40.908418 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:19:40.911326 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:19:41.058049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:19:41.072324 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:19:41.072692 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:19:41.072892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:41.790528 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m17:19:41.793062 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:19:41.934765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94463f9d-8c20-441e-83a5-23a581be0c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705b4f0>]}
[0m17:19:41.936051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:41.936568 [info ] [MainThread]: 
[0m17:19:41.940832 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:19:41.941150 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:19:41.941703 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m17:19:41.941927 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:19:41.953899 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:19:41.954859 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-03 17:19:41.942066 => 2023-07-03 17:19:41.954795
[0m17:19:41.955077 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:19:41.973539 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:19:41.974532 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:19:41.974701 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m17:19:41.974860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:43.589819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m17:19:43.606074 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-03 17:19:41.955216 => 2023-07-03 17:19:43.606003
[0m17:19:43.606365 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m17:19:43.737505 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.80s]
[0m17:19:43.739861 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:19:43.740414 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m17:19:43.740837 [info ] [Thread-1 (]: 2 of 3 START test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:19:43.741364 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0'
[0m17:19:43.741528 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m17:19:43.748603 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m17:19:43.749220 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0 (compile): 2023-07-03 17:19:43.741637 => 2023-07-03 17:19:43.749168
[0m17:19:43.749502 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m17:19:43.752982 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m17:19:43.754231 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m17:19:43.754589 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID as unique_field,
    count(*) as n_records

from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is not null
group by _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
having count(*) > 1



      
    ) dbt_internal_test
[0m17:19:43.754842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:45.583024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m17:19:45.586300 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0 (execute): 2023-07-03 17:19:43.749853 => 2023-07-03 17:19:45.586199
[0m17:19:45.586684 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0: Close
[0m17:19:45.732613 [error] [Thread-1 (]: 2 of 3 FAIL 513 source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[31mFAIL 513[0m in 1.99s]
[0m17:19:45.733530 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m17:19:45.734876 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:45.735404 [info ] [Thread-1 (]: 3 of 3 SKIP relation DBT_NDW.stg_property_sale_listings ........................ [[33mSKIP[0m]
[0m17:19:45.736070 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:45.738490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:45.738929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:45.739063 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0' was properly closed.
[0m17:19:45.739220 [info ] [MainThread]: 
[0m17:19:45.739427 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m17:19:45.740259 [debug] [MainThread]: Command end result
[0m17:19:45.751343 [info ] [MainThread]: 
[0m17:19:45.752214 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:19:45.752561 [info ] [MainThread]: 
[0m17:19:45.752761 [error] [MainThread]: [31mFailure in test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)[0m
[0m17:19:45.752933 [error] [MainThread]:   Got 513 results, configured to fail if != 0
[0m17:19:45.753089 [info ] [MainThread]: 
[0m17:19:45.753582 [info ] [MainThread]:   compiled Code at target/compiled/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_unique_realty_mole_prop_63c5f22da60d46a3fd1151a3a7ff960c.sql
[0m17:19:45.753757 [info ] [MainThread]: 
[0m17:19:45.753915 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:19:45.754160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11038ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d59720>]}
[0m17:19:45.754353 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:22:20.831125 | d4a52cb6-f733-4eb7-9609-6fbbfd1860b1 ==============================
[0m17:22:20.831125 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:22:20.836924 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m17:22:20.837182 [debug] [MainThread]: Tracking: tracking
[0m17:22:20.837493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32b6a0>]}
[0m17:22:20.911093 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:22:20.942836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m17:22:20.943188 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m17:22:20.943374 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m17:22:20.943535 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m17:22:20.943685 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m17:22:20.943831 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m17:22:20.943978 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m17:22:20.944120 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m17:22:20.944262 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m17:22:20.944404 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m17:22:20.944543 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m17:22:20.944686 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m17:22:20.944825 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m17:22:20.944965 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m17:22:20.945109 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m17:22:20.945247 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m17:22:20.945387 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m17:22:20.945528 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m17:22:20.945670 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m17:22:20.945811 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m17:22:20.945952 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m17:22:20.946091 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m17:22:20.946230 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m17:22:20.946366 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m17:22:20.946501 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m17:22:20.946642 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m17:22:20.946780 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:22:20.946918 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m17:22:20.947054 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m17:22:20.947191 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m17:22:20.947326 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m17:22:20.947462 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m17:22:20.947601 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m17:22:20.947738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m17:22:20.947877 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m17:22:20.948014 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m17:22:20.948152 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m17:22:20.948287 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m17:22:20.948426 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m17:22:20.948562 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m17:22:20.948734 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m17:22:20.948872 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m17:22:20.949008 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m17:22:20.949145 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m17:22:20.949280 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m17:22:20.949418 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m17:22:20.949557 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m17:22:20.949691 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m17:22:20.949826 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m17:22:20.950270 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m17:22:20.950738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m17:22:20.951011 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m17:22:21.156556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:22:21.161221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4a52cb6-f733-4eb7-9609-6fbbfd1860b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0d5540>]}
[0m17:22:21.169185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4a52cb6-f733-4eb7-9609-6fbbfd1860b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d098430>]}
[0m17:22:21.169624 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:22:21.170099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a52cb6-f733-4eb7-9609-6fbbfd1860b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a3e20>]}
[0m17:22:21.171855 [info ] [MainThread]: 
[0m17:22:21.173344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:21.174083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:22:21.187103 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:22:21.187394 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:22:21.187566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:22.338685 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:22:22.340831 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:22:22.490276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:22:22.498261 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:22:22.498530 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:22:22.498697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:23.514793 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m17:22:23.517371 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:22:23.706543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a52cb6-f733-4eb7-9609-6fbbfd1860b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2bdf30>]}
[0m17:22:23.707697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:23.708199 [info ] [MainThread]: 
[0m17:22:23.712898 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb
[0m17:22:23.713482 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT  [RUN]
[0m17:22:23.714144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb'
[0m17:22:23.714590 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb
[0m17:22:23.726119 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb"
[0m17:22:23.726695 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb (compile): 2023-07-03 17:22:23.714826 => 2023-07-03 17:22:23.726644
[0m17:22:23.726889 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb
[0m17:22:23.753234 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb"
[0m17:22:23.754159 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb"
[0m17:22:23.754321 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMMITED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMMITED_AT is null



      
    ) dbt_internal_test
[0m17:22:23.754461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:24.592615 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6232-0504-9fbb-0050-3987000a627a
[0m17:22:24.593072 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier '_AIRBYTE_EMMITED_AT'
[0m17:22:24.593487 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb (execute): 2023-07-03 17:22:23.727011 => 2023-07-03 17:22:24.593409
[0m17:22:24.593960 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb: Close
[0m17:22:24.751209 [debug] [Thread-1 (]: Database Error in test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT (models/staging/property_sale_listings/src_property_sale_listings.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier '_AIRBYTE_EMMITED_AT'
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_not_null_realty_mole_pr_7f1cbe6b133c3b2fd5884310674af600.sql
[0m17:22:24.751868 [error] [Thread-1 (]: 1 of 3 ERROR source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT  [[31mERROR[0m in 1.04s]
[0m17:22:24.753967 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb
[0m17:22:24.754339 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:22:24.754610 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:22:24.755363 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m17:22:24.755808 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:22:24.763401 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:22:24.764434 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-03 17:22:24.756047 => 2023-07-03 17:22:24.764360
[0m17:22:24.764669 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:22:24.766908 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:22:24.767818 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:22:24.768194 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m17:22:24.768461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:25.474368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:22:25.484035 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-03 17:22:24.764811 => 2023-07-03 17:22:25.483962
[0m17:22:25.484318 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m17:22:25.637273 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.88s]
[0m17:22:25.638071 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:22:25.639029 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:22:25.639476 [info ] [Thread-1 (]: 3 of 3 SKIP relation DBT_NDW.stg_property_sale_listings ........................ [[33mSKIP[0m]
[0m17:22:25.639984 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:22:25.641439 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:25.642933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:25.643320 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46' was properly closed.
[0m17:22:25.643519 [info ] [MainThread]: 
[0m17:22:25.643727 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m17:22:25.644023 [debug] [MainThread]: Command end result
[0m17:22:25.652421 [info ] [MainThread]: 
[0m17:22:25.662462 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:25.662671 [info ] [MainThread]: 
[0m17:22:25.662855 [error] [MainThread]: [33mDatabase Error in test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT (models/staging/property_sale_listings/src_property_sale_listings.yml)[0m
[0m17:22:25.663022 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
[0m17:22:25.663175 [error] [MainThread]:   invalid identifier '_AIRBYTE_EMMITED_AT'
[0m17:22:25.663563 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_not_null_realty_mole_pr_7f1cbe6b133c3b2fd5884310674af600.sql
[0m17:22:25.663745 [info ] [MainThread]: 
[0m17:22:25.663915 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:22:25.664147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d533910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80e500>]}
[0m17:22:25.664349 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:23:26.608106 | ecc4f082-20fd-48e4-8513-0500a332816f ==============================
[0m17:23:26.608106 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:23:26.613960 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m17:23:26.614221 [debug] [MainThread]: Tracking: tracking
[0m17:23:26.616625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106622fb0>]}
[0m17:23:26.691335 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:23:26.739897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m17:23:26.740268 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m17:23:26.740456 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m17:23:26.741004 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m17:23:26.741195 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m17:23:26.741354 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m17:23:26.741506 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m17:23:26.741658 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m17:23:26.741803 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m17:23:26.741950 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m17:23:26.742091 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m17:23:26.742230 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m17:23:26.742370 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m17:23:26.742512 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m17:23:26.742651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m17:23:26.742788 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m17:23:26.742926 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m17:23:26.743060 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m17:23:26.743195 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m17:23:26.743327 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m17:23:26.743461 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m17:23:26.743595 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m17:23:26.743729 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m17:23:26.743863 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:23:26.743995 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m17:23:26.744127 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m17:23:26.744264 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m17:23:26.744397 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m17:23:26.744531 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m17:23:26.744667 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m17:23:26.744802 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m17:23:26.744936 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m17:23:26.745073 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m17:23:26.745210 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m17:23:26.745349 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m17:23:26.745483 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m17:23:26.745616 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m17:23:26.745750 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m17:23:26.745884 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m17:23:26.746018 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m17:23:26.746185 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m17:23:26.746322 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m17:23:26.746455 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m17:23:26.746593 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m17:23:26.746727 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m17:23:26.746865 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m17:23:26.747143 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m17:23:26.747340 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m17:23:26.747493 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m17:23:26.747634 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m17:23:26.747794 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m17:23:26.747929 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m17:23:27.055774 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:23:27.063728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d8be0>]}
[0m17:23:27.074928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a3e20>]}
[0m17:23:27.075275 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:23:27.075505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412ff70>]}
[0m17:23:27.076515 [info ] [MainThread]: 
[0m17:23:27.078107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:27.079078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:23:27.094720 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:23:27.095260 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:23:27.095579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:28.479721 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:23:28.481859 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:23:28.685482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:23:28.692200 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:23:28.692471 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:23:28.692632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:29.503937 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m17:23:29.506358 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:23:29.647687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ba950>]}
[0m17:23:29.648713 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:29.649031 [info ] [MainThread]: 
[0m17:23:29.654135 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:23:29.654690 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m17:23:29.655390 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m17:23:29.655596 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:23:29.669915 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:23:29.673954 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-03 17:23:29.655723 => 2023-07-03 17:23:29.673893
[0m17:23:29.674154 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:23:29.690505 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:23:29.691411 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:23:29.691566 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m17:23:29.691701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:30.938290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:23:30.948328 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-03 17:23:29.674265 => 2023-07-03 17:23:30.948262
[0m17:23:30.948575 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m17:23:31.092769 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.44s]
[0m17:23:31.095619 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:23:31.096712 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:23:31.097157 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:23:31.097731 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m17:23:31.097924 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:23:31.101983 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:23:31.102519 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-03 17:23:31.098045 => 2023-07-03 17:23:31.102472
[0m17:23:31.102695 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:23:31.104652 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:23:31.105364 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:23:31.105500 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m17:23:31.105629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:31.863852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:23:31.866695 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-03 17:23:31.102810 => 2023-07-03 17:23:31.866599
[0m17:23:31.867087 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m17:23:32.025300 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.93s]
[0m17:23:32.026125 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:23:32.027895 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:23:32.028676 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:23:32.029595 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:23:32.029835 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:23:32.031995 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:23:32.032853 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 17:23:32.029953 => 2023-07-03 17:23:32.032800
[0m17:23:32.033037 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:23:32.056259 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:23:32.057636 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:23:32.058904 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:23:32.059236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:32.981414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:23:33.002888 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 17:23:32.033148 => 2023-07-03 17:23:33.002839
[0m17:23:33.003161 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:23:33.156905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fcf6d0>]}
[0m17:23:33.157638 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.13s]
[0m17:23:33.158161 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:23:33.159708 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:33.160511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:33.160833 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m17:23:33.161120 [info ] [MainThread]: 
[0m17:23:33.161526 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m17:23:33.162301 [debug] [MainThread]: Command end result
[0m17:23:33.169592 [info ] [MainThread]: 
[0m17:23:33.169899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:33.170445 [info ] [MainThread]: 
[0m17:23:33.170656 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:23:33.171217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ba950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f8a6b0>]}
[0m17:23:33.171463 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:19:06.610158 | 35b78dd9-2590-4c6d-b557-e3134f0381f3 ==============================
[0m21:19:06.610158 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:19:06.615531 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:19:06.615700 [debug] [MainThread]: Tracking: tracking
[0m21:19:06.615931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cdb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd8f10>]}
[0m21:19:06.690454 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:19:06.741675 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 51 files added, 0 files changed.
[0m21:19:06.741960 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:19:06.742089 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:19:06.742196 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:19:06.742294 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:19:06.742389 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:19:06.742485 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:19:06.742579 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:19:06.742830 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:19:06.743190 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:19:06.743325 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:19:06.743431 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:19:06.743530 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:19:06.743628 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:19:06.743722 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:19:06.743814 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:19:06.743905 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:19:06.743993 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:19:06.744083 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:19:06.744173 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:19:06.744261 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:19:06.744351 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:19:06.744438 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:19:06.744526 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:19:06.744616 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:19:06.744705 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:19:06.744798 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:19:06.744890 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:19:06.744979 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:19:06.745069 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:19:06.745156 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:19:06.745244 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:19:06.745334 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:19:06.745428 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:19:06.745520 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:19:06.745614 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:19:06.745703 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:19:06.745793 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:19:06.745883 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:19:06.745997 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:19:06.746088 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:19:06.746178 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:19:06.746268 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:19:06.746358 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:19:06.746715 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:19:06.747136 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:19:06.747294 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:19:06.747411 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:19:06.747515 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:19:06.747616 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:19:06.747717 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:19:06.747938 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:19:06.748206 [debug] [MainThread]: Partial parsing: deleted file: real_estate_dbt_project://models/staging/property_sale_listings/old_stg_property_sale_listings.sql
[0m21:19:06.908473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:19:06.912128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139359f0>]}
[0m21:19:06.921491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f32b0>]}
[0m21:19:06.921770 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:19:06.921934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112c640>]}
[0m21:19:06.923159 [info ] [MainThread]: 
[0m21:19:06.926016 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:06.927232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:19:06.938658 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:19:06.939039 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:19:06.939159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:08.753944 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m21:19:08.756186 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:19:08.931407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:19:08.939193 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:19:08.939410 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:19:08.939726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:09.996206 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:19:09.998706 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:19:10.166201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f3730>]}
[0m21:19:10.167345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:10.167805 [info ] [MainThread]: 
[0m21:19:10.171013 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:10.171267 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:19:10.172215 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:19:10.172653 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:10.183935 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:10.186289 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:19:10.173308 => 2023-07-05 21:19:10.186229
[0m21:19:10.186453 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:10.199348 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:10.200015 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:10.200128 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:19:10.200231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:12.081442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m21:19:12.093664 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:19:10.186546 => 2023-07-05 21:19:12.093542
[0m21:19:12.094151 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:19:12.275366 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 2.10s]
[0m21:19:12.278026 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:12.278649 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:12.279244 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:19:12.280123 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:19:12.280315 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:12.284239 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:12.284924 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:19:12.280410 => 2023-07-05 21:19:12.284879
[0m21:19:12.285075 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:12.286612 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:12.287164 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:12.287267 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:19:12.287360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:13.228526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:19:13.229929 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:19:12.285164 => 2023-07-05 21:19:13.229892
[0m21:19:13.230078 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:19:13.435044 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.16s]
[0m21:19:13.435519 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:13.436076 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:13.436292 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:19:13.436652 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:19:13.436894 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:13.440646 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:13.441706 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:19:13.437239 => 2023-07-05 21:19:13.441576
[0m21:19:13.442220 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:13.457750 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:13.458488 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:13.458595 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple stream lit app that shows the end table
-- then add it to linkedin
-- then call it done
select _airbyte_emitted_at as iteration_date,
id
listeddate as listed_date,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
formattedaddress as formatted_address,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:19:13.458689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:14.243633 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6e5f-0504-a156-0050-3987000a9006
[0m21:19:14.243882 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 11 unexpected 'as'.
[0m21:19:14.244073 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:19:13.442351 => 2023-07-05 21:19:14.244037
[0m21:19:14.244195 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:19:14.416421 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 11 unexpected 'as'.
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m21:19:14.417063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4ceb0>]}
[0m21:19:14.417612 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 0.98s]
[0m21:19:14.418125 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:14.419377 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:14.419739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:14.419843 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:19:14.419965 [info ] [MainThread]: 
[0m21:19:14.420124 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m21:19:14.420358 [debug] [MainThread]: Command end result
[0m21:19:14.425290 [info ] [MainThread]: 
[0m21:19:14.425531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:19:14.425671 [info ] [MainThread]: 
[0m21:19:14.425803 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m21:19:14.425986 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m21:19:14.426122 [error] [MainThread]:   syntax error line 18 at position 11 unexpected 'as'.
[0m21:19:14.426318 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m21:19:14.426507 [info ] [MainThread]: 
[0m21:19:14.426802 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:19:14.427062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f1570>]}
[0m21:19:14.427219 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:19:33.839641 | ec8101ab-8a58-426d-93d3-16b99d435619 ==============================
[0m21:19:33.839641 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:19:33.843748 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:19:33.844029 [debug] [MainThread]: Tracking: tracking
[0m21:19:33.844583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c27730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c246a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c25e10>]}
[0m21:19:33.897961 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:19:33.929910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m21:19:33.930199 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:19:33.930374 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:19:33.930537 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:19:33.930670 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:19:33.930816 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:19:33.930946 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:19:33.931062 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:19:33.931203 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:19:33.931321 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:19:33.931435 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:19:33.931572 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:19:33.931686 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:19:33.931798 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:19:33.931905 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:19:33.932008 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:19:33.932144 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:19:33.932252 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:19:33.932356 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:19:33.932462 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:19:33.932568 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:19:33.932673 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:19:33.932779 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:19:33.932886 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:19:33.933019 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:19:33.933125 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:19:33.933231 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:19:33.933335 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:19:33.933441 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:19:33.933545 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:19:33.933652 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:19:33.933758 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:19:33.933862 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:19:33.933967 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:19:33.934074 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:19:33.934180 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:19:33.934282 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:19:33.934383 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:19:33.934485 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:19:33.934664 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:19:33.934896 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:19:33.935058 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:19:33.935182 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:19:33.935301 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:19:33.935417 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:19:33.935536 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:19:33.935653 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:19:33.935770 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:19:33.935885 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:19:33.936005 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:19:33.936125 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:19:33.936237 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:19:34.136560 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:19:34.142303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd56c0>]}
[0m21:19:34.152256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8dea0>]}
[0m21:19:34.152558 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:19:34.152738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111216d70>]}
[0m21:19:34.153463 [info ] [MainThread]: 
[0m21:19:34.155111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:34.156013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:19:34.165802 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:19:34.166090 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:19:34.166222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:35.289512 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m21:19:35.291202 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:19:35.458790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:19:35.463075 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:19:35.463261 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:19:35.463386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:36.439175 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:19:36.441493 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:19:36.611660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8ead0>]}
[0m21:19:36.612490 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:36.612732 [info ] [MainThread]: 
[0m21:19:36.615372 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:36.615601 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:19:36.616282 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:19:36.616721 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:36.629928 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:36.630560 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:19:36.616964 => 2023-07-05 21:19:36.630513
[0m21:19:36.630725 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:36.650750 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:36.651532 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:36.651674 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:19:36.651788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.751022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:19:37.759429 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:19:36.630834 => 2023-07-05 21:19:37.759375
[0m21:19:37.759647 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:19:37.932460 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.32s]
[0m21:19:37.935283 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:37.936008 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:37.936486 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:19:37.937445 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:19:37.937924 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:37.942644 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:37.943140 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:19:37.938033 => 2023-07-05 21:19:37.943099
[0m21:19:37.943285 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:37.944944 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:37.945698 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:37.945820 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:19:37.945927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:38.601846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:19:38.604822 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:19:37.943375 => 2023-07-05 21:19:38.604711
[0m21:19:38.605264 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:19:38.754196 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.82s]
[0m21:19:38.754936 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:38.755876 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:38.756450 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:19:38.757427 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:19:38.757808 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:38.761261 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:38.761751 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:19:38.758043 => 2023-07-05 21:19:38.761705
[0m21:19:38.761901 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:38.781010 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:38.781816 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:38.781937 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple stream lit app that shows the end table
-- then add it to linkedin
-- then call it done
select _airbyte_emitted_at as iteration_date,
id,
listeddate as listed_date,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
formattedaddress as formatted_address,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:19:38.782049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:39.896688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:19:39.913825 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:19:38.761993 => 2023-07-05 21:19:39.913785
[0m21:19:39.914036 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:19:40.068396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc88e0>]}
[0m21:19:40.069176 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.31s]
[0m21:19:40.069744 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:40.071449 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:40.072539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:40.072845 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:19:40.073152 [info ] [MainThread]: 
[0m21:19:40.073577 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m21:19:40.074307 [debug] [MainThread]: Command end result
[0m21:19:40.080600 [info ] [MainThread]: 
[0m21:19:40.081091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:40.081336 [info ] [MainThread]: 
[0m21:19:40.081544 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:19:40.081994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120280850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bcb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138b7b20>]}
[0m21:19:40.082193 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:23:46.934336 | 76d393f4-46a1-44de-8f59-0e3773bb7dbb ==============================
[0m21:23:46.934336 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:23:46.939004 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:23:46.939196 [debug] [MainThread]: Tracking: tracking
[0m21:23:46.939495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110423790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110421de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110420ee0>]}
[0m21:23:47.003783 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:23:47.033416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m21:23:47.033735 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:23:47.033914 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:23:47.034059 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:23:47.034195 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:23:47.034416 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:23:47.034589 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:23:47.034737 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:23:47.034880 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:23:47.035016 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:23:47.035151 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:23:47.035282 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:23:47.035413 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:23:47.035545 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:23:47.035674 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:23:47.035803 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:23:47.036011 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:23:47.036140 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:23:47.036265 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:23:47.036390 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:23:47.036515 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:23:47.036638 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:23:47.036770 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:23:47.036906 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:23:47.037033 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:23:47.037155 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:23:47.037279 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:23:47.037402 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:23:47.037526 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:23:47.037649 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:23:47.037777 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:23:47.037901 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:23:47.038026 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:23:47.038148 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:23:47.038277 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:23:47.038404 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:23:47.038526 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:23:47.038651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:23:47.038776 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:23:47.038897 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:23:47.039052 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:23:47.039177 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:23:47.039303 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:23:47.039424 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:23:47.039545 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:23:47.039673 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:23:47.039800 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:23:47.039927 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:23:47.040052 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:23:47.040192 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:23:47.040318 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:23:47.040446 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:23:47.264897 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:23:47.271910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105cccd0>]}
[0m21:23:47.280272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056c190>]}
[0m21:23:47.280590 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:23:47.280801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e16d40>]}
[0m21:23:47.282308 [info ] [MainThread]: 
[0m21:23:47.285000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:47.286157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:23:47.299898 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:23:47.300199 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:23:47.300382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:48.915649 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m21:23:48.917746 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:23:49.106201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:23:49.114339 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:23:49.114597 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:23:49.114747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:50.212277 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:23:50.214597 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:23:50.395023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e16d40>]}
[0m21:23:50.396208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:50.397121 [info ] [MainThread]: 
[0m21:23:50.399997 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:23:50.400213 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:23:50.400681 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:23:50.400854 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:23:50.413756 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:23:50.415186 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:23:50.400975 => 2023-07-05 21:23:50.415044
[0m21:23:50.415463 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:23:50.435277 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:23:50.436342 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:23:50.436512 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:23:50.436651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:51.609090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:23:51.618243 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:23:50.415586 => 2023-07-05 21:23:51.618180
[0m21:23:51.618499 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:23:51.885309 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.48s]
[0m21:23:51.887611 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:23:51.888211 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:23:51.888711 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:23:51.889699 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:23:51.890089 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:23:51.898166 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:23:51.898860 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:23:51.890322 => 2023-07-05 21:23:51.898809
[0m21:23:51.899079 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:23:51.902963 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:23:51.903826 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:23:51.903974 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:23:51.904096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:52.990237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:23:52.995975 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:23:51.899243 => 2023-07-05 21:23:52.995860
[0m21:23:52.996446 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:23:53.290836 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.40s]
[0m21:23:53.291586 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:23:53.292795 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:23:53.293520 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:23:53.294699 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:23:53.295194 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:23:53.298405 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:23:53.299322 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:23:53.295445 => 2023-07-05 21:23:53.299247
[0m21:23:53.299547 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:23:53.322561 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:23:53.323647 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:23:53.323798 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple stream lit app that shows the end table
-- then add it to linkedin
-- then call it done
select _airbyte_emitted_at as iteration_date,
id,
listeddate as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:23:53.323926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:54.823323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:23:54.844704 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:23:53.299669 => 2023-07-05 21:23:54.844610
[0m21:23:54.845138 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:23:55.116585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d3610>]}
[0m21:23:55.117440 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.82s]
[0m21:23:55.118087 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:23:55.119989 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:55.120436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:55.120571 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:23:55.120726 [info ] [MainThread]: 
[0m21:23:55.120925 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m21:23:55.121225 [debug] [MainThread]: Command end result
[0m21:23:55.128010 [info ] [MainThread]: 
[0m21:23:55.128335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:55.128571 [info ] [MainThread]: 
[0m21:23:55.128772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:23:55.129731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11059dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8820>]}
[0m21:23:55.130187 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:29:11.200912 | 1aef08df-5d7d-4a50-8d05-ef997fae4145 ==============================
[0m21:29:11.200912 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:29:11.204427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:29:11.204595 [debug] [MainThread]: Tracking: tracking
[0m21:29:11.204902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c123730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c121de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c122e90>]}
[0m21:29:11.275487 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:29:11.303919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m21:29:11.304251 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:29:11.304422 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:29:11.304565 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:29:11.304699 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:29:11.304828 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:29:11.304963 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:29:11.305095 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:29:11.305228 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:29:11.305361 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:29:11.305491 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:29:11.305620 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:29:11.305745 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:29:11.305872 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:29:11.305996 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:29:11.306133 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:29:11.306258 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:29:11.306383 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:29:11.306512 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:29:11.306635 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:29:11.306758 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:29:11.306892 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:29:11.307018 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:29:11.307145 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:29:11.307278 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:29:11.307407 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:29:11.307528 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:29:11.307657 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:29:11.307777 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:29:11.307898 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:29:11.308022 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:29:11.308143 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:29:11.308265 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:29:11.308385 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:29:11.308509 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:29:11.308628 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:29:11.308758 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:29:11.308888 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:29:11.309010 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:29:11.309132 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:29:11.309303 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:29:11.309441 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:29:11.309580 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:29:11.309718 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:29:11.309948 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:29:11.310134 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:29:11.310292 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:29:11.310439 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:29:11.310585 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:29:11.310733 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:29:11.310880 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:29:11.311024 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:29:11.531083 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:29:11.537993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ccca0>]}
[0m21:29:11.544905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c26c040>]}
[0m21:29:11.545220 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:29:11.545486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c26c070>]}
[0m21:29:11.546444 [info ] [MainThread]: 
[0m21:29:11.547985 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:11.548682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:29:11.561836 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:29:11.562121 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:29:11.562289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:12.652974 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m21:29:12.655184 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:29:12.804862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:29:12.812502 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:29:12.812750 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:29:12.812899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:14.087075 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:29:14.089534 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:29:14.256606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c247e50>]}
[0m21:29:14.257740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:14.258374 [info ] [MainThread]: 
[0m21:29:14.261594 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:29:14.261852 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:29:14.262658 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:29:14.262910 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:29:14.272501 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:29:14.273592 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:29:14.263032 => 2023-07-05 21:29:14.273540
[0m21:29:14.273792 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:29:14.304194 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:29:14.306142 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:29:14.306545 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:29:14.306709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:15.459219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:29:15.469677 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:29:14.273919 => 2023-07-05 21:29:15.469610
[0m21:29:15.469961 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:29:15.657149 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.39s]
[0m21:29:15.659802 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:29:15.660438 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:29:15.660800 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:29:15.662054 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:29:15.662514 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:29:15.671007 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:29:15.672131 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:29:15.662763 => 2023-07-05 21:29:15.672017
[0m21:29:15.672690 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:29:15.675765 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:29:15.676942 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:29:15.677086 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:29:15.677214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:16.341353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:29:16.344380 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:29:15.672929 => 2023-07-05 21:29:16.344267
[0m21:29:16.344819 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:29:16.509169 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.85s]
[0m21:29:16.509903 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:29:16.510969 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:29:16.511537 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:29:16.512483 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:29:16.512831 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:29:16.515711 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:29:16.516811 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:29:16.513514 => 2023-07-05 21:29:16.516754
[0m21:29:16.517020 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:29:16.545409 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:29:16.546608 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:29:16.546788 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple stream lit app that shows the end table
-- then add it to linkedin
-- then call it done

-- format me as a date
select date(_airbyte_emitted_at) as iteration_date,
id,
-- format me as a date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:29:16.546933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:17.479526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:29:17.498221 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:29:16.517137 => 2023-07-05 21:29:17.498179
[0m21:29:17.498448 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:29:17.660930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca23190>]}
[0m21:29:17.661681 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.15s]
[0m21:29:17.662218 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:29:17.663940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:17.664758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:17.665049 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:29:17.665356 [info ] [MainThread]: 
[0m21:29:17.665769 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m21:29:17.666442 [debug] [MainThread]: Command end result
[0m21:29:17.673770 [info ] [MainThread]: 
[0m21:29:17.674139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:17.674359 [info ] [MainThread]: 
[0m21:29:17.674556 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:29:17.674833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca23820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca23a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca23dc0>]}
[0m21:29:17.675048 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:31:48.087382 | d2f232d7-3e17-4ac5-82a9-08ee04173d88 ==============================
[0m21:31:48.087382 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:31:48.092860 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:31:48.093378 [debug] [MainThread]: Tracking: tracking
[0m21:31:48.094888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112622fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112621e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112621e40>]}
[0m21:31:48.166340 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:31:48.213035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m21:31:48.213389 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:31:48.213578 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:31:48.213740 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:31:48.213907 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:31:48.214058 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:31:48.214212 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:31:48.214356 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:31:48.214501 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:31:48.214645 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:31:48.214790 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:31:48.214937 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:31:48.215079 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:31:48.215225 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:31:48.215366 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:31:48.215509 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:31:48.215651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:31:48.215792 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:31:48.215931 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:31:48.216074 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:31:48.216216 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:31:48.216353 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:31:48.216490 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:31:48.216627 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:31:48.216765 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:31:48.216901 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:31:48.217040 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:31:48.217177 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:31:48.217314 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:31:48.217451 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:31:48.217596 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:31:48.217736 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:31:48.217876 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:31:48.218012 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:31:48.218153 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:31:48.218292 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:31:48.218428 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:31:48.218564 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:31:48.218695 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:31:48.218829 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:31:48.218994 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:31:48.219130 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:31:48.219269 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:31:48.219406 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:31:48.219540 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:31:48.219678 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:31:48.219813 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:31:48.219949 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:31:48.220086 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:31:48.220222 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:31:48.220363 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:31:48.220505 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:31:48.497126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:31:48.504204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d4c40>]}
[0m21:31:48.512475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11276c130>]}
[0m21:31:48.512802 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:31:48.513037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a7f40>]}
[0m21:31:48.513984 [info ] [MainThread]: 
[0m21:31:48.515458 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:31:48.516378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:31:48.528801 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:31:48.529097 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:31:48.529264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:49.856678 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m21:31:49.858533 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:31:50.030687 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:31:50.039593 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:31:50.039887 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:31:50.040057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:51.046413 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:31:51.050042 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:31:51.266351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112797f70>]}
[0m21:31:51.268203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:31:51.268565 [info ] [MainThread]: 
[0m21:31:51.272843 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:31:51.273176 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:31:51.273812 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:31:51.274009 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:31:51.294344 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:31:51.297615 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:31:51.274133 => 2023-07-05 21:31:51.297471
[0m21:31:51.299111 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:31:51.323403 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:31:51.324249 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:31:51.324393 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:31:51.324527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:52.068135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:31:52.074180 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:31:51.299502 => 2023-07-05 21:31:52.074119
[0m21:31:52.074422 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:31:52.236252 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.96s]
[0m21:31:52.237719 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:31:52.237989 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:31:52.238151 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:31:52.239214 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:31:52.239594 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:31:52.245774 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:31:52.246358 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:31:52.239842 => 2023-07-05 21:31:52.246306
[0m21:31:52.246555 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:31:52.249395 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:31:52.250291 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:31:52.250446 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:31:52.250591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:53.174288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:31:53.175927 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:31:52.246668 => 2023-07-05 21:31:53.175878
[0m21:31:53.176119 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:31:53.339893 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.10s]
[0m21:31:53.340843 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:31:53.341902 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:31:53.342547 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:31:53.343548 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:31:53.343966 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:31:53.348077 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:31:53.349124 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:31:53.344218 => 2023-07-05 21:31:53.349075
[0m21:31:53.349326 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:31:53.370037 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:31:53.371089 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:31:53.371254 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
select date(_airbyte_emitted_at) as iteration_date,
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:31:53.371397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:54.367193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:31:54.386122 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:31:53.349453 => 2023-07-05 21:31:54.386074
[0m21:31:54.386379 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:31:54.574228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d1f6d0>]}
[0m21:31:54.574651 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.23s]
[0m21:31:54.574928 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:31:54.576353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:31:54.576720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:54.576837 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:31:54.576975 [info ] [MainThread]: 
[0m21:31:54.578136 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m21:31:54.578558 [debug] [MainThread]: Command end result
[0m21:31:54.584547 [info ] [MainThread]: 
[0m21:31:54.584918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:54.585099 [info ] [MainThread]: 
[0m21:31:54.585270 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:31:54.585545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11329f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cdcd30>]}
[0m21:31:54.585731 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:15:47.267049 | eb19b6ee-4b39-4a20-b6c4-64f530823858 ==============================
[0m22:15:47.267049 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:15:47.271667 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:15:47.271870 [debug] [MainThread]: Tracking: tracking
[0m22:15:47.272173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c27790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c24580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c25e10>]}
[0m22:15:47.337950 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:15:47.377135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:47.377576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:47.378361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:15:47.387819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfc0d0>]}
[0m22:15:47.399295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc1990>]}
[0m22:15:47.399644 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:15:47.400054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d31e70>]}
[0m22:15:47.401602 [info ] [MainThread]: 
[0m22:15:47.403297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:47.404938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:15:47.417964 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:15:47.418243 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:15:47.418412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:48.717482 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:15:48.719733 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:15:48.900398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:15:48.906231 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:15:48.906462 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:15:48.906613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:49.740039 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:15:49.742437 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:15:49.915632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107267400>]}
[0m22:15:49.916677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:49.917110 [info ] [MainThread]: 
[0m22:15:49.920968 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:15:49.921232 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:15:49.921702 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:15:49.921855 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:15:49.932160 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:15:49.932830 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:15:49.921962 => 2023-07-05 22:15:49.932779
[0m22:15:49.933022 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:15:49.948376 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:15:49.949195 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:15:49.949328 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:15:49.949450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:51.133777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:15:51.146151 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:15:49.933137 => 2023-07-05 22:15:51.146079
[0m22:15:51.146419 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:15:51.340799 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.42s]
[0m22:15:51.343478 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:15:51.344117 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:15:51.344568 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:15:51.345572 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:15:51.346238 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:15:51.350126 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:15:51.350670 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:15:51.346384 => 2023-07-05 22:15:51.350621
[0m22:15:51.350850 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:15:51.355462 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:15:51.356331 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:15:51.356477 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:15:51.356610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:52.323616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:15:52.326621 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:15:51.350963 => 2023-07-05 22:15:52.326503
[0m22:15:52.327082 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:15:52.511515 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.17s]
[0m22:15:52.512242 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:15:52.513130 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:15:52.513809 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:15:52.514811 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:15:52.515202 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:15:52.517617 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:15:52.518541 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:15:52.515479 => 2023-07-05 22:15:52.518493
[0m22:15:52.518725 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:15:52.536456 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:15:52.537979 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:15:52.538492 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
select date(_airbyte_emitted_at) as iteration_date,
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:15:52.539071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:53.490458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:15:53.509108 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:15:52.518828 => 2023-07-05 22:15:53.509057
[0m22:15:53.509372 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:15:53.659148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c31600>]}
[0m22:15:53.659585 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.14s]
[0m22:15:53.659888 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:15:53.661669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:53.662452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:53.662731 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:15:53.663038 [info ] [MainThread]: 
[0m22:15:53.663484 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m22:15:53.664241 [debug] [MainThread]: Command end result
[0m22:15:53.675673 [info ] [MainThread]: 
[0m22:15:53.676322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:53.676895 [info ] [MainThread]: 
[0m22:15:53.677558 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:15:53.677931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c22a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c20400>]}
[0m22:15:53.678154 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:16:51.969141 | 31d87165-1ef8-4cce-9a96-d824b1841a5a ==============================
[0m22:16:51.969141 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:16:51.973506 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:16:51.973717 [debug] [MainThread]: Tracking: tracking
[0m22:16:51.973992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a23010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a20c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a21e40>]}
[0m22:16:52.038066 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:16:52.078896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:52.079140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:52.079533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:16:52.086160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fc0d0>]}
[0m22:16:52.093662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c1b40>]}
[0m22:16:52.093977 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:16:52.094205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c1780>]}
[0m22:16:52.095096 [info ] [MainThread]: 
[0m22:16:52.096542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:52.097243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:16:52.110755 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:16:52.111032 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:16:52.111200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:53.338789 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:16:53.339924 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:16:53.722286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:16:53.728952 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:16:53.729211 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:16:53.729363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:54.839736 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:16:54.841471 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:16:55.068378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b2fb0>]}
[0m22:16:55.069381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:16:55.069848 [info ] [MainThread]: 
[0m22:16:55.074751 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:16:55.075015 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:16:55.075505 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:16:55.075700 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:16:55.084756 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:16:55.085443 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:16:55.075824 => 2023-07-05 22:16:55.085393
[0m22:16:55.085640 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:16:55.101754 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:16:55.102604 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:16:55.102766 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:16:55.102907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:55.867156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:16:55.874739 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:16:55.085759 => 2023-07-05 22:16:55.874681
[0m22:16:55.874985 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:16:56.054215 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.98s]
[0m22:16:56.056828 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:16:56.057411 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:16:56.057844 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:16:56.058796 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:16:56.059026 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:16:56.063220 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:16:56.063687 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:16:56.059146 => 2023-07-05 22:16:56.063641
[0m22:16:56.063933 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:16:56.067772 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:16:56.068590 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:16:56.068743 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:16:56.068884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:57.083609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:16:57.086702 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:16:56.064080 => 2023-07-05 22:16:57.086586
[0m22:16:57.087151 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:16:57.235768 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.18s]
[0m22:16:57.236182 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:16:57.236953 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:16:57.237288 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:16:57.237736 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:16:57.237891 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:16:57.239999 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:16:57.240746 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:16:57.237996 => 2023-07-05 22:16:57.240703
[0m22:16:57.240924 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:16:57.262288 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:16:57.263980 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:16:57.264481 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
select date(_airbyte_emitted_at) as iteration_date,
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:16:57.264672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:58.178784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:16:58.198859 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:16:57.241032 => 2023-07-05 22:16:58.198807
[0m22:16:58.199191 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:16:58.347929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107031f30>]}
[0m22:16:58.348814 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.11s]
[0m22:16:58.349353 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:16:58.350764 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:58.351214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:58.351359 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:16:58.351519 [info ] [MainThread]: 
[0m22:16:58.351730 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m22:16:58.352166 [debug] [MainThread]: Command end result
[0m22:16:58.360403 [info ] [MainThread]: 
[0m22:16:58.360997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:16:58.361230 [info ] [MainThread]: 
[0m22:16:58.361509 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:16:58.361811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070299f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070283d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107028760>]}
[0m22:16:58.362044 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:23:28.198606 | 470901d3-11a9-4887-bada-6ddab2dffc22 ==============================
[0m22:23:28.198606 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:23:28.204064 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:23:28.204514 [debug] [MainThread]: Tracking: tracking
[0m22:23:28.205054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f20a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f236a0>]}
[0m22:23:28.282026 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:23:28.324455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m22:23:28.324817 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:23:28.325012 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:23:28.325175 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:23:28.325328 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:23:28.325482 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:23:28.325636 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:23:28.325785 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:23:28.325938 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:23:28.326086 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:23:28.326234 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:23:28.326381 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:23:28.326883 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:23:28.327283 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:23:28.327492 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:23:28.327654 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:23:28.328072 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:23:28.328428 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:23:28.328830 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:23:28.329226 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:23:28.329539 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:23:28.329849 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:23:28.330158 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:23:28.330448 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:23:28.330741 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:23:28.331092 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:23:28.331452 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:23:28.331760 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:23:28.332057 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:23:28.332353 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:23:28.332636 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:23:28.332976 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:23:28.333381 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:23:28.333720 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:23:28.333924 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:23:28.334080 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:23:28.334230 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:23:28.334379 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:23:28.334524 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:23:28.334668 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:23:28.334859 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:23:28.335001 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:23:28.335146 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:23:28.335288 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:23:28.335433 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:23:28.335572 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:23:28.335715 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:23:28.335856 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:23:28.335998 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:23:28.336226 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:23:28.336418 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:23:28.336642 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:23:28.641556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:23:28.649835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b98c40>]}
[0m22:23:28.663833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b34130>]}
[0m22:23:28.664197 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:23:28.664509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030fbe20>]}
[0m22:23:28.665845 [info ] [MainThread]: 
[0m22:23:28.667272 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:23:28.667955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:23:28.686845 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:23:28.687355 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:23:28.687672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:29.918088 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:23:29.919532 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:23:30.076857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:23:30.082909 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:23:30.083176 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:23:30.083335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:31.038552 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:23:31.041032 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:23:31.199431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc5930>]}
[0m22:23:31.200487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:31.200940 [info ] [MainThread]: 
[0m22:23:31.205696 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:23:31.206245 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:23:31.207428 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:23:31.207678 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:23:31.221615 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:23:31.222352 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:23:31.207824 => 2023-07-05 22:23:31.222297
[0m22:23:31.222576 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:23:31.246779 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:23:31.247735 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:23:31.247902 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:23:31.248046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:31.933979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:23:31.944044 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:23:31.222708 => 2023-07-05 22:23:31.943975
[0m22:23:31.944319 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:23:32.075402 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.87s]
[0m22:23:32.078099 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:23:32.078774 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:23:32.079248 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:23:32.080219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:23:32.080703 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:23:32.087699 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:23:32.088672 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:23:32.080964 => 2023-07-05 22:23:32.088524
[0m22:23:32.089115 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:23:32.091468 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:23:32.092339 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:23:32.092503 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:23:32.092919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:32.952327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:23:32.955385 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:23:32.089432 => 2023-07-05 22:23:32.955262
[0m22:23:32.955852 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:23:33.113667 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.03s]
[0m22:23:33.114449 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:23:33.115422 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:23:33.116033 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:23:33.117036 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:23:33.117427 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:23:33.123819 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:23:33.125198 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:23:33.119316 => 2023-07-05 22:23:33.125118
[0m22:23:33.125460 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:23:33.151344 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:23:33.152685 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:23:33.152884 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
select date(_airbyte_emitted_at)||'_'||id as home_iteration_id,
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:23:33.153031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:33.991438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:23:34.010423 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:23:33.125591 => 2023-07-05 22:23:34.010372
[0m22:23:34.010792 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:23:34.232888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d36d0>]}
[0m22:23:34.233329 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.12s]
[0m22:23:34.233627 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:23:34.234739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:23:34.235151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:34.235295 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:23:34.235416 [debug] [MainThread]: Connection 'list_ANALYTICS_DBT_NDW' was properly closed.
[0m22:23:34.235580 [info ] [MainThread]: 
[0m22:23:34.235788 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m22:23:34.237243 [debug] [MainThread]: Command end result
[0m22:23:34.244063 [info ] [MainThread]: 
[0m22:23:34.244908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:34.245155 [info ] [MainThread]: 
[0m22:23:34.245344 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:23:34.245953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dc790>]}
[0m22:23:34.246512 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:24:49.416358 | d05119ea-21c6-4a27-b8f4-6bd2491bde19 ==============================
[0m22:24:49.416358 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:24:49.421810 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:24:49.422043 [debug] [MainThread]: Tracking: tracking
[0m22:24:49.422352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd23010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd20c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd21e40>]}
[0m22:24:49.494665 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:24:49.524576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m22:24:49.524930 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:24:49.525116 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:24:49.525274 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:24:49.525426 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:24:49.525574 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:24:49.525725 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:24:49.525870 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:24:49.526015 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:24:49.526155 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:24:49.526304 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:24:49.526445 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:24:49.526586 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:24:49.526727 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:24:49.526869 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:24:49.527009 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:24:49.527153 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:24:49.527294 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:24:49.527429 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:24:49.527564 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:24:49.527698 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:24:49.527832 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:24:49.527967 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:24:49.528102 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:24:49.528236 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:24:49.528704 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:24:49.529026 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:24:49.529178 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:24:49.529323 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:24:49.529459 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:24:49.529601 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:24:49.529738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:24:49.529877 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:24:49.530015 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:24:49.530157 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:24:49.530298 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:24:49.530436 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:24:49.530575 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:24:49.530712 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:24:49.530849 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:24:49.531017 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:24:49.531154 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:24:49.531288 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:24:49.531422 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:24:49.531559 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:24:49.531691 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:24:49.531824 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:24:49.531959 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:24:49.532093 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:24:49.532231 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:24:49.532367 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:24:49.532500 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:24:49.748349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:24:49.753799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ced1690>]}
[0m22:24:49.761444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce9f850>]}
[0m22:24:49.761868 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:24:49.762130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118801e70>]}
[0m22:24:49.763072 [info ] [MainThread]: 
[0m22:24:49.765678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:49.766942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:24:49.778752 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:24:49.779065 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:24:49.779261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:50.861763 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:24:50.863878 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:24:51.027626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:24:51.035176 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:24:51.035450 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:24:51.035596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:52.012136 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:24:52.014484 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:24:52.165255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccb9f00>]}
[0m22:24:52.166477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:52.166792 [info ] [MainThread]: 
[0m22:24:52.170970 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:24:52.171462 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:24:52.172767 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:24:52.173554 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:24:52.189115 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:24:52.189825 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:24:52.173863 => 2023-07-05 22:24:52.189775
[0m22:24:52.190076 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:24:52.209647 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:24:52.210519 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:24:52.210686 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:24:52.210844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:52.962132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:24:52.969497 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:24:52.190224 => 2023-07-05 22:24:52.969432
[0m22:24:52.969762 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:24:53.113810 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.94s]
[0m22:24:53.116297 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:24:53.116785 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:24:53.117868 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:24:53.118612 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:24:53.118785 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:24:53.124040 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:24:53.124887 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:24:53.118891 => 2023-07-05 22:24:53.124804
[0m22:24:53.125259 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:24:53.127427 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:24:53.128262 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:24:53.128409 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:24:53.128542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:54.094983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:24:54.097302 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:24:53.125520 => 2023-07-05 22:24:54.097201
[0m22:24:54.097694 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:24:54.275961 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.16s]
[0m22:24:54.276363 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:24:54.277337 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:24:54.277956 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:24:54.278772 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:24:54.279188 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:24:54.283752 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:24:54.285468 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:24:54.279403 => 2023-07-05 22:24:54.285342
[0m22:24:54.285753 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:24:54.308379 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:24:54.309733 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:24:54.309927 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:24:54.310073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:55.265010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:24:55.283715 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:24:54.285883 => 2023-07-05 22:24:55.283662
[0m22:24:55.283972 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:24:55.460852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d62bdf0>]}
[0m22:24:55.461817 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.18s]
[0m22:24:55.462414 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:24:55.464145 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:55.465440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:55.465916 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:24:55.466317 [info ] [MainThread]: 
[0m22:24:55.466802 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m22:24:55.467480 [debug] [MainThread]: Command end result
[0m22:24:55.475401 [info ] [MainThread]: 
[0m22:24:55.475743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:55.475947 [info ] [MainThread]: 
[0m22:24:55.476202 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:24:55.476510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db80820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccc9c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d62ba60>]}
[0m22:24:55.476747 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:27:14.018378 | 52a2e6b1-5b6b-4394-b535-7d508acead3e ==============================
[0m22:27:14.018378 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:27:14.021655 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:27:14.021867 [debug] [MainThread]: Tracking: tracking
[0m22:27:14.022161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105923730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105921de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105922e90>]}
[0m22:27:14.081417 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:27:14.116045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m22:27:14.116399 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:27:14.116593 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:27:14.116755 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:27:14.116908 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:27:14.117061 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:27:14.117210 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:27:14.117354 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:27:14.117492 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:27:14.117632 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:27:14.117813 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:27:14.117956 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:27:14.118101 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:27:14.118247 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:27:14.118393 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:27:14.118534 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:27:14.118677 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:27:14.118816 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:27:14.118957 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:27:14.119093 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:27:14.119235 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:27:14.119373 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:27:14.119515 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:27:14.119658 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:27:14.119801 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:27:14.119945 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:27:14.120085 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:27:14.120227 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:27:14.120371 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:27:14.120514 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:27:14.120660 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:27:14.120804 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:27:14.120946 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:27:14.121085 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:27:14.121228 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:27:14.121367 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:27:14.121509 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:27:14.121736 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:27:14.121920 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:27:14.122079 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:27:14.122263 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:27:14.122410 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:27:14.122554 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:27:14.122702 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:27:14.122843 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:27:14.122987 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:27:14.123130 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:27:14.123269 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:27:14.123409 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:27:14.123552 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:27:14.123694 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:27:14.123834 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:27:14.335784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:27:14.340509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0ca0>]}
[0m22:27:14.349389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6c040>]}
[0m22:27:14.349681 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:27:14.349904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa2da0>]}
[0m22:27:14.350867 [info ] [MainThread]: 
[0m22:27:14.352184 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:27:14.352795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:27:14.368470 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:27:14.368757 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:27:14.368938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:15.410129 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:27:15.412394 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:27:15.569593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:27:15.576975 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:27:15.577209 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:27:15.577357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:16.556035 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:27:16.558518 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:27:16.711241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a47ee0>]}
[0m22:27:16.712382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:27:16.712839 [info ] [MainThread]: 
[0m22:27:16.720070 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:27:16.720390 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:27:16.721211 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:27:16.721657 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:27:16.735149 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:27:16.736092 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:27:16.721901 => 2023-07-05 22:27:16.736025
[0m22:27:16.736328 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:27:16.756185 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:27:16.757191 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:27:16.757374 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:27:16.757523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:17.445736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:27:17.451303 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:27:16.736461 => 2023-07-05 22:27:17.451247
[0m22:27:17.451534 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:27:17.610072 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.89s]
[0m22:27:17.611542 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:27:17.611829 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:27:17.612077 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:27:17.612594 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:27:17.612778 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:27:17.618940 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:27:17.619560 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:27:17.612901 => 2023-07-05 22:27:17.619491
[0m22:27:17.619762 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:27:17.622717 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:27:17.623572 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:27:17.623730 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:27:17.623867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:18.381325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:27:18.384426 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:27:17.619883 => 2023-07-05 22:27:18.384303
[0m22:27:18.384896 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:27:18.553886 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.94s]
[0m22:27:18.554620 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:27:18.555551 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:27:18.556133 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:27:18.557099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:27:18.557454 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:27:18.560185 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:27:18.561017 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:27:18.557669 => 2023-07-05 22:27:18.560959
[0m22:27:18.561218 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:27:18.586827 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:27:18.587923 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:27:18.588098 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - START BACK HERE: then add definitions and tests to the silver model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:27:18.588240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:19.406142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:27:19.423727 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:27:18.561335 => 2023-07-05 22:27:19.423679
[0m22:27:19.423979 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:27:19.589169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd36d0>]}
[0m22:27:19.589992 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.03s]
[0m22:27:19.590739 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:27:19.593083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:27:19.593582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:19.593736 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:27:19.593904 [info ] [MainThread]: 
[0m22:27:19.594131 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m22:27:19.594464 [debug] [MainThread]: Command end result
[0m22:27:19.600267 [info ] [MainThread]: 
[0m22:27:19.600582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:27:19.600772 [info ] [MainThread]: 
[0m22:27:19.600950 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:27:19.601192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f90e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106731690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067305b0>]}
[0m22:27:19.601400 [debug] [MainThread]: Flushing usage events


============================== 2023-07-06 21:49:35.952474 | b7fd027f-825f-403e-9bf3-3d71db7d3350 ==============================
[0m21:49:35.952474 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:49:35.959362 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:49:35.959553 [debug] [MainThread]: Tracking: tracking
[0m21:49:35.960010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d237c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d21e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d20f10>]}
[0m21:49:36.027056 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:49:36.064006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 1 files changed.
[0m21:49:36.064358 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:49:36.064543 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:49:36.064699 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:49:36.064850 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:49:36.064998 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:49:36.065142 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:49:36.065283 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:49:36.065426 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:49:36.065564 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:49:36.065702 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:49:36.065836 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:49:36.065971 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:49:36.066108 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:49:36.066245 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:49:36.066378 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:49:36.066517 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:49:36.066651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:49:36.066786 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:49:36.066920 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:49:36.067054 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:49:36.067188 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:49:36.067320 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:49:36.067454 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:49:36.067585 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:49:36.067717 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:49:36.067852 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:49:36.067986 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:49:36.068121 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:49:36.068250 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:49:36.068401 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:49:36.068543 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:49:36.068676 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:49:36.068807 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:49:36.068939 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:49:36.069070 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:49:36.069204 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:49:36.069338 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:49:36.069504 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:49:36.069641 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:49:36.069776 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:49:36.069910 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:49:36.070120 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:49:36.070255 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:49:36.070390 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:49:36.070523 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:49:36.070671 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:49:36.070809 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:49:36.070943 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:49:36.071076 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:49:36.071208 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:49:36.071354 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:49:36.071640 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/staging/property_sale_listings/stg_property_sales_listings.yml
[0m21:49:36.305353 [debug] [MainThread]: 1699: static parser successfully parsed staging/property_sale_listings/stg_property_sale_listings.sql
[0m21:49:36.325204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115946410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159816c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159820e0>]}
[0m21:49:36.325512 [debug] [MainThread]: Flushing usage events
[0m21:49:36.906632 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/staging/property_sale_listings/stg_property_sales_listings.yml @ models: {'name': 'stg_property_sale_listings', 'description': 'Staged property sale listings data for single-family homes in a particular zipcode.', 'columns': [{'name': 'addr_iteration_date_id', 'description': 'Concatenation of Address (in ID form) with the Iteration Date when the data was fetched.', 'tests': ['unique', 'not_null']}, {'name': 'iteration_date', 'description': 'Date (with timestamp removed) when the data was inserted into the raw schema from the API.', 'tests': ['not_null']}, {'name': 'id', 'description': 'Address of the home in id form (Ex. 123-Muffin-Man-Ln,-Seattle,-WA-12345)'}, {'name': 'listed_date', 'description': 'Date the home was listed.'}, {'name': 'formatted_address', 'description': 'Properly-formatted address of the home (Ex. 123 Muffin Man Ln, Seattle, WA 12345)'}, {'name': 'num_bathrooms', 'description': 'Number of bathrooms in the home (can be a decimal for half-baths).'}, {'name': 'num_bedrooms', 'description': 'Number of bedrooms in the home.'}, {'name': None}], 'original_file_path': 'models/staging/property_sale_listings/stg_property_sales_listings.yml', 'yaml_key': 'models', 'package_name': 'real_estate_dbt_project'} - at path ['columns'][7]['name']: None is not of type 'string'


============================== 2023-07-06 21:49:52.187154 | 7bd0c8c9-c329-4de4-ab62-b185755ad903 ==============================
[0m21:49:52.187154 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:49:52.190535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:49:52.190716 [debug] [MainThread]: Tracking: tracking
[0m21:49:52.191032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109743f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3cb670>]}
[0m21:49:52.275093 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:49:52.311431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 1 files changed.
[0m21:49:52.311841 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:49:52.312039 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:49:52.312205 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:49:52.312357 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:49:52.312512 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:49:52.312658 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:49:52.312805 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:49:52.312953 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:49:52.313095 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:49:52.313235 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:49:52.313376 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:49:52.313543 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:49:52.313694 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:49:52.313842 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:49:52.313980 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:49:52.314118 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:49:52.314257 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:49:52.314397 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:49:52.314536 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:49:52.314674 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:49:52.314813 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:49:52.314948 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:49:52.315084 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:49:52.315218 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:49:52.315355 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:49:52.315493 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:49:52.315632 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:49:52.315770 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:49:52.315908 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:49:52.316053 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:49:52.316189 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:49:52.316330 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:49:52.316465 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:49:52.316602 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:49:52.316738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:49:52.316874 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:49:52.317011 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:49:52.317289 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:49:52.317434 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:49:52.317570 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:49:52.317707 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:49:52.317847 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:49:52.317990 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:49:52.318132 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:49:52.318269 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:49:52.318399 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:49:52.318522 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:49:52.318645 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:49:52.318768 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:49:52.318891 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:49:52.319012 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:49:52.319217 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/staging/property_sale_listings/stg_property_sales_listings.yml
[0m21:49:52.534043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:49:52.540210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ab820>]}
[0m21:49:52.553641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2b9900>]}
[0m21:49:52.554005 [info ] [MainThread]: Found 1 model, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:49:52.554242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2bacb0>]}
[0m21:49:52.555295 [info ] [MainThread]: 
[0m21:49:52.556721 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:49:52.557496 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:49:52.571717 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:49:52.572166 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:49:52.572695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:54.134964 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m21:49:54.137205 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:49:54.307596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:49:54.315797 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:49:54.316058 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:49:54.316211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:55.221001 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:49:55.223366 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:49:55.369458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d174220>]}
[0m21:49:55.370045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:55.370303 [info ] [MainThread]: 
[0m21:49:55.373475 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:49:55.373687 [info ] [Thread-1 (]: 1 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:49:55.374113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:49:55.374259 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:49:55.387209 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:49:55.389023 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-06 21:49:55.374368 => 2023-07-06 21:49:55.388723
[0m21:49:55.389378 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:49:55.415480 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:49:55.416603 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:49:55.416782 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:49:55.416922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:56.627439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:49:56.638785 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-06 21:49:55.389502 => 2023-07-06 21:49:56.638629
[0m21:49:56.639259 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:49:56.789850 [info ] [Thread-1 (]: 1 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.42s]
[0m21:49:56.791604 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:49:56.792189 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:49:56.792577 [info ] [Thread-1 (]: 2 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:49:56.793340 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:49:56.793523 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:49:56.797106 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:49:56.797976 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-06 21:49:56.793636 => 2023-07-06 21:49:56.797862
[0m21:49:56.798417 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:49:56.801148 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:49:56.802385 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:49:56.802803 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:49:56.803150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:57.531651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:49:57.534713 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-06 21:49:56.798671 => 2023-07-06 21:49:57.534601
[0m21:49:57.535273 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:49:57.689350 [info ] [Thread-1 (]: 2 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.90s]
[0m21:49:57.690109 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:49:57.691072 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:49:57.691641 [info ] [Thread-1 (]: 3 of 6 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:49:57.692589 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:49:57.693009 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:49:57.697328 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:49:57.698305 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-06 21:49:57.693291 => 2023-07-06 21:49:57.698135
[0m21:49:57.699172 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:49:57.721853 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:49:57.723585 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:49:57.723985 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - START BACK HERE: then add definitions and tests to the silver model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:49:57.724278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:58.635828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:49:58.653960 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-06 21:49:57.699313 => 2023-07-06 21:49:58.653916
[0m21:49:58.654223 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:49:58.813125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f75d1b0>]}
[0m21:49:58.813954 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.12s]
[0m21:49:58.816037 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:49:58.817590 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m21:49:58.818263 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m21:49:58.819326 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m21:49:58.819784 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m21:49:58.823596 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m21:49:58.824297 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-06 21:49:58.819942 => 2023-07-06 21:49:58.824167
[0m21:49:58.824657 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m21:49:58.827950 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m21:49:58.829594 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m21:49:58.829948 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m21:49:58.830101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:59.884548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:49:59.887445 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-06 21:49:58.824775 => 2023-07-06 21:49:59.887344
[0m21:49:59.887866 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m21:50:00.049331 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.23s]
[0m21:50:00.050136 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m21:50:00.050631 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m21:50:00.051753 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m21:50:00.053260 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m21:50:00.053545 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m21:50:00.060407 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m21:50:00.062223 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-06 21:50:00.053663 => 2023-07-06 21:50:00.062124
[0m21:50:00.062682 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m21:50:00.069532 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m21:50:00.071034 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m21:50:00.071261 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m21:50:00.071428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:01.326803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:50:01.355021 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-06 21:50:00.062988 => 2023-07-06 21:50:01.354526
[0m21:50:01.356068 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m21:50:01.510835 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.46s]
[0m21:50:01.516691 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m21:50:01.517602 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m21:50:01.518529 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m21:50:01.519864 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m21:50:01.520533 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m21:50:01.534257 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m21:50:01.535526 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-06 21:50:01.520809 => 2023-07-06 21:50:01.535447
[0m21:50:01.535806 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m21:50:01.544364 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m21:50:01.549841 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m21:50:01.550156 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:50:01.550356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:02.530937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:50:02.563247 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-06 21:50:01.536042 => 2023-07-06 21:50:02.560236
[0m21:50:02.565083 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m21:50:02.732524 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.21s]
[0m21:50:02.737302 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m21:50:02.744795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:02.745353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:02.745486 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m21:50:02.745686 [info ] [MainThread]: 
[0m21:50:02.746831 [info ] [MainThread]: Finished running 5 tests, 1 view model in 0 hours 0 minutes and 10.19 seconds (10.19s).
[0m21:50:02.748031 [debug] [MainThread]: Command end result
[0m21:50:02.776194 [info ] [MainThread]: 
[0m21:50:02.777109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:50:02.777348 [info ] [MainThread]: 
[0m21:50:02.777534 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:50:02.778274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1572b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f90370>]}
[0m21:50:02.779119 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 17:50:46.904491 | 49418761-6523-437c-915d-fd892087b08d ==============================
[0m17:50:46.904491 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:50:46.908428 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m17:50:46.908849 [debug] [MainThread]: Tracking: tracking
[0m17:50:46.909354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b23010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b20c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b21e40>]}
[0m17:50:46.978838 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:50:47.009367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m17:50:47.010384 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m17:50:47.010900 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m17:50:47.011117 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m17:50:47.011262 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m17:50:47.011391 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m17:50:47.011517 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m17:50:47.011639 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m17:50:47.011761 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m17:50:47.011883 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m17:50:47.011998 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m17:50:47.012115 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m17:50:47.012281 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m17:50:47.012781 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m17:50:47.013449 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m17:50:47.013668 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m17:50:47.013807 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m17:50:47.013929 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m17:50:47.014050 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m17:50:47.014500 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m17:50:47.015159 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m17:50:47.015539 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m17:50:47.016049 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m17:50:47.016549 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m17:50:47.016710 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m17:50:47.016914 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m17:50:47.017060 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m17:50:47.017188 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:50:47.017309 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m17:50:47.017427 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m17:50:47.017549 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m17:50:47.017665 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m17:50:47.017779 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m17:50:47.017968 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m17:50:47.018093 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m17:50:47.018214 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m17:50:47.018330 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m17:50:47.018721 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m17:50:47.018902 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m17:50:47.019467 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m17:50:47.020157 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m17:50:47.020282 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m17:50:47.020403 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m17:50:47.020516 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m17:50:47.020632 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m17:50:47.020762 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m17:50:47.020876 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m17:50:47.020989 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m17:50:47.021103 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m17:50:47.021361 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m17:50:47.021488 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m17:50:47.021605 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m17:50:47.220509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:50:47.225493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce15a0>]}
[0m17:50:47.233496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abb220>]}
[0m17:50:47.233786 [info ] [MainThread]: Found 1 model, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:50:47.233983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a32890>]}
[0m17:50:47.235000 [info ] [MainThread]: 
[0m17:50:47.237501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:47.239199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:50:47.252956 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:50:47.253207 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:50:47.253356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:49.682473 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m17:50:49.684803 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:50:50.016077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:50:50.020745 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:50:50.020945 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:50:50.021088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:50.835570 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m17:50:50.838025 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:50:51.072107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f4cd0>]}
[0m17:50:51.073253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:51.073720 [info ] [MainThread]: 
[0m17:50:51.077554 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:50:51.077870 [info ] [Thread-1 (]: 1 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m17:50:51.078307 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m17:50:51.078716 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:50:51.088897 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:50:51.089981 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 17:50:51.078817 => 2023-07-08 17:50:51.089916
[0m17:50:51.090196 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:50:51.105795 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:50:51.106949 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:50:51.107322 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m17:50:51.107728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:52.553988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:52.566219 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 17:50:51.090310 => 2023-07-08 17:50:52.566164
[0m17:50:52.566453 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m17:50:52.786749 [info ] [Thread-1 (]: 1 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.71s]
[0m17:50:52.789413 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:50:52.790103 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:50:52.790570 [info ] [Thread-1 (]: 2 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:50:52.791584 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m17:50:52.792134 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:50:52.801145 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:50:52.802136 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 17:50:52.792379 => 2023-07-08 17:50:52.802081
[0m17:50:52.802343 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:50:52.805723 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:50:52.806569 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:50:52.806734 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m17:50:52.806856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:53.735893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:53.738776 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 17:50:52.802596 => 2023-07-08 17:50:53.738671
[0m17:50:53.739181 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m17:50:53.991564 [info ] [Thread-1 (]: 2 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.20s]
[0m17:50:53.992296 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:50:53.993308 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:50:53.993911 [info ] [Thread-1 (]: 3 of 6 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:50:53.994853 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:50:53.995252 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:50:54.000531 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:50:54.001289 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 17:50:53.995505 => 2023-07-08 17:50:54.001244
[0m17:50:54.001455 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:50:54.019535 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:50:54.020567 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:50:54.020725 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - START BACK HERE: then add definitions and tests to the silver model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:50:54.020844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:54.779287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:54.799406 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 17:50:54.001552 => 2023-07-08 17:50:54.799363
[0m17:50:54.799664 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:50:55.126939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107212500>]}
[0m17:50:55.127741 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.13s]
[0m17:50:55.128368 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:50:55.129068 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m17:50:55.129308 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m17:50:55.129754 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m17:50:55.129921 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m17:50:55.134176 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m17:50:55.135446 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 17:50:55.130500 => 2023-07-08 17:50:55.135282
[0m17:50:55.136150 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m17:50:55.139492 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m17:50:55.140229 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m17:50:55.140367 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m17:50:55.140485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:55.786500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:55.789551 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 17:50:55.136465 => 2023-07-08 17:50:55.789440
[0m17:50:55.790059 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m17:50:56.108875 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 0.98s]
[0m17:50:56.109665 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m17:50:56.110241 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m17:50:56.110605 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m17:50:56.111724 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m17:50:56.112145 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m17:50:56.117957 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m17:50:56.118468 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 17:50:56.112378 => 2023-07-08 17:50:56.118425
[0m17:50:56.118633 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m17:50:56.122966 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m17:50:56.123691 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m17:50:56.123831 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m17:50:56.123956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:56.725426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:56.728336 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 17:50:56.118734 => 2023-07-08 17:50:56.728234
[0m17:50:56.728766 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m17:50:56.960695 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 0.85s]
[0m17:50:56.961445 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m17:50:56.961954 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m17:50:56.962443 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m17:50:56.963501 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m17:50:56.963914 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m17:50:56.970914 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m17:50:56.971874 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 17:50:56.964158 => 2023-07-08 17:50:56.971811
[0m17:50:56.972121 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m17:50:56.975631 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m17:50:56.976614 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m17:50:56.976760 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:50:56.976879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:58.404954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:58.409008 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 17:50:56.972263 => 2023-07-08 17:50:58.408943
[0m17:50:58.409420 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m17:50:58.682261 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.72s]
[0m17:50:58.683027 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m17:50:58.684810 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:58.685676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:58.686271 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m17:50:58.686500 [info ] [MainThread]: 
[0m17:50:58.686709 [info ] [MainThread]: Finished running 5 tests, 1 view model in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m17:50:58.687453 [debug] [MainThread]: Command end result
[0m17:50:58.695126 [info ] [MainThread]: 
[0m17:50:58.695416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:58.695589 [info ] [MainThread]: 
[0m17:50:58.695741 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:50:58.695962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a32890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c78760>]}
[0m17:50:58.696140 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 18:00:41.629976 | 82033c60-dd7e-4a76-98be-fe80f084380f ==============================
[0m18:00:41.629976 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:00:41.633984 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m18:00:41.634175 [debug] [MainThread]: Tracking: tracking
[0m18:00:41.634613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066206a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106621e10>]}
[0m18:00:41.699150 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:00:41.739740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:41.739981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:41.740387 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m18:00:41.747762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074100d0>]}
[0m18:00:41.755430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e2350>]}
[0m18:00:41.756039 [info ] [MainThread]: Found 1 model, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:00:41.756704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105716da0>]}
[0m18:00:41.757717 [info ] [MainThread]: 
[0m18:00:41.759382 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:41.760737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m18:00:41.775934 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m18:00:41.776276 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m18:00:41.776473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:43.098674 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m18:00:43.106465 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m18:00:43.440343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m18:00:43.455789 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m18:00:43.456463 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m18:00:43.456738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:44.521056 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m18:00:44.522943 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m18:00:44.880061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745bd60>]}
[0m18:00:44.880748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:44.881004 [info ] [MainThread]: 
[0m18:00:44.884434 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:00:44.884700 [info ] [Thread-1 (]: 1 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m18:00:44.885372 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m18:00:44.885869 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:00:44.910312 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:00:44.913106 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 18:00:44.886125 => 2023-07-08 18:00:44.913009
[0m18:00:44.913409 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:00:44.938579 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:00:44.939517 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:00:44.939692 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m18:00:44.939841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:45.668973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:45.679469 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 18:00:44.913536 => 2023-07-08 18:00:45.679341
[0m18:00:45.679972 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m18:00:45.976087 [info ] [Thread-1 (]: 1 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.09s]
[0m18:00:45.978148 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:00:45.978620 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:00:45.979077 [info ] [Thread-1 (]: 2 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m18:00:45.979609 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m18:00:45.979780 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:00:45.987144 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:00:45.988143 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 18:00:45.979895 => 2023-07-08 18:00:45.988023
[0m18:00:45.988581 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:00:45.991552 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:00:45.993468 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:00:45.994246 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m18:00:45.997570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:47.025100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:47.028269 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 18:00:45.988836 => 2023-07-08 18:00:47.028141
[0m18:00:47.028711 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m18:00:47.381489 [info ] [Thread-1 (]: 2 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.40s]
[0m18:00:47.382242 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:00:47.383211 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:00:47.383791 [info ] [Thread-1 (]: 3 of 6 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m18:00:47.384787 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m18:00:47.385288 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:00:47.390028 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:00:47.392188 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 18:00:47.385598 => 2023-07-08 18:00:47.392108
[0m18:00:47.392537 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:00:47.422011 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:00:47.423232 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:00:47.423413 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - START BACK HERE: then add definitions and tests to the silver model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m18:00:47.423566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:48.391383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:48.412737 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 18:00:47.392914 => 2023-07-08 18:00:48.412661
[0m18:00:48.413072 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m18:00:48.708454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d078e0>]}
[0m18:00:48.709292 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.32s]
[0m18:00:48.709834 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:00:48.710937 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:00:48.711521 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m18:00:48.712574 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m18:00:48.713022 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:00:48.721260 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:00:48.722506 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 18:00:48.713315 => 2023-07-08 18:00:48.722436
[0m18:00:48.722744 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:00:48.726058 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:00:48.726819 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:00:48.726990 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m18:00:48.727132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.008525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:50.012102 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 18:00:48.722904 => 2023-07-08 18:00:50.011965
[0m18:00:50.012712 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m18:00:50.242256 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.53s]
[0m18:00:50.243017 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:00:50.243541 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:00:50.244144 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m18:00:50.245365 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m18:00:50.245844 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:00:50.250830 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:00:50.251408 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 18:00:50.246080 => 2023-07-08 18:00:50.251358
[0m18:00:50.251630 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:00:50.253876 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:00:50.254808 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:00:50.254973 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m18:00:50.255111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:52.119575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m18:00:52.122555 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 18:00:50.251755 => 2023-07-08 18:00:52.122451
[0m18:00:52.122945 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m18:00:52.449697 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 2.20s]
[0m18:00:52.450398 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:00:52.450888 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:00:52.451328 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m18:00:52.452262 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m18:00:52.452623 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:00:52.460491 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:00:52.461494 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 18:00:52.452830 => 2023-07-08 18:00:52.461401
[0m18:00:52.461818 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:00:52.465353 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:00:52.467089 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:00:52.467280 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:52.467421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:53.886038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:53.889105 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 18:00:52.461951 => 2023-07-08 18:00:53.889019
[0m18:00:53.889460 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m18:00:54.259346 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.81s]
[0m18:00:54.260095 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:00:54.261944 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:54.262728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:54.262944 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m18:00:54.263138 [info ] [MainThread]: 
[0m18:00:54.263425 [info ] [MainThread]: Finished running 5 tests, 1 view model in 0 hours 0 minutes and 12.50 seconds (12.50s).
[0m18:00:54.264014 [debug] [MainThread]: Command end result
[0m18:00:54.274967 [info ] [MainThread]: 
[0m18:00:54.275332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:54.275916 [info ] [MainThread]: 
[0m18:00:54.277405 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:00:54.277983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3f670>]}
[0m18:00:54.278259 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 18:10:45.312505 | bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2 ==============================
[0m18:10:45.312505 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:10:45.317834 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m18:10:45.318104 [debug] [MainThread]: Tracking: tracking
[0m18:10:45.318493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b20be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b236a0>]}
[0m18:10:45.385824 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:10:45.422711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:45.422981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:45.423761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m18:10:45.430891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890c0d0>]}
[0m18:10:45.440282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6230>]}
[0m18:10:45.440678 [info ] [MainThread]: Found 1 model, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:10:45.440991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6200>]}
[0m18:10:45.442240 [info ] [MainThread]: 
[0m18:10:45.444181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:45.445206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m18:10:45.459981 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m18:10:45.460329 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m18:10:45.460553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:46.620269 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m18:10:46.622468 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m18:10:46.908976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m18:10:46.917540 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m18:10:46.917868 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m18:10:46.918079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:47.777862 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m18:10:47.780235 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m18:10:48.078239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108953ca0>]}
[0m18:10:48.079508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:48.079990 [info ] [MainThread]: 
[0m18:10:48.083900 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:10:48.084230 [info ] [Thread-1 (]: 1 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m18:10:48.085012 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m18:10:48.085285 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:10:48.099909 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:10:48.101342 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 18:10:48.085458 => 2023-07-08 18:10:48.101269
[0m18:10:48.101641 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:10:48.122673 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:10:48.123971 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:10:48.124226 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m18:10:48.124426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:49.183368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:49.196804 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 18:10:48.101796 => 2023-07-08 18:10:49.196724
[0m18:10:49.197154 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m18:10:49.502843 [info ] [Thread-1 (]: 1 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.42s]
[0m18:10:49.505478 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:10:49.506150 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:10:49.508281 [info ] [Thread-1 (]: 2 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m18:10:49.509572 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m18:10:49.510110 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:10:49.517792 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:10:49.518740 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 18:10:49.510472 => 2023-07-08 18:10:49.518609
[0m18:10:49.519073 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:10:49.522125 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:10:49.523431 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:10:49.523672 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m18:10:49.523863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:50.263073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:50.266064 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 18:10:49.519246 => 2023-07-08 18:10:50.265950
[0m18:10:50.266500 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m18:10:50.486705 [info ] [Thread-1 (]: 2 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.98s]
[0m18:10:50.487524 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:10:50.488499 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:10:50.489155 [info ] [Thread-1 (]: 3 of 6 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m18:10:50.490219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m18:10:50.490618 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:10:50.495554 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:10:50.497808 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 18:10:50.490853 => 2023-07-08 18:10:50.497728
[0m18:10:50.498083 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:10:50.526006 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:10:50.527327 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:10:50.527544 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m18:10:50.527732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:51.310880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:51.332650 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 18:10:50.498226 => 2023-07-08 18:10:51.332594
[0m18:10:51.332987 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m18:10:51.638268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091050f0>]}
[0m18:10:51.639113 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.15s]
[0m18:10:51.639677 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:10:51.640628 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:10:51.641227 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m18:10:51.642354 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m18:10:51.642855 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:10:51.650609 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:10:51.651539 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 18:10:51.643114 => 2023-07-08 18:10:51.651412
[0m18:10:51.653122 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:10:51.658734 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:10:51.660594 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:10:51.660887 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m18:10:51.661503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:53.058942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:53.060746 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 18:10:51.653333 => 2023-07-08 18:10:53.060696
[0m18:10:53.060956 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m18:10:53.359095 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.72s]
[0m18:10:53.359850 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:10:53.360352 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:10:53.360830 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m18:10:53.361882 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m18:10:53.362322 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:10:53.368968 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:10:53.370208 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 18:10:53.362571 => 2023-07-08 18:10:53.370023
[0m18:10:53.370831 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:10:53.373968 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:10:53.374999 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:10:53.375194 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m18:10:53.375366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:54.408133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:54.411004 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 18:10:53.371205 => 2023-07-08 18:10:54.410928
[0m18:10:54.411299 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m18:10:54.720080 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.36s]
[0m18:10:54.720840 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:10:54.721309 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:10:54.721694 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m18:10:54.722639 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m18:10:54.723077 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:10:54.734687 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:10:54.736106 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 18:10:54.723334 => 2023-07-08 18:10:54.736017
[0m18:10:54.736436 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:10:54.740030 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:10:54.741183 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:10:54.741381 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:10:54.741554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:55.535967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:55.538939 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 18:10:54.736631 => 2023-07-08 18:10:55.538837
[0m18:10:55.539363 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m18:10:55.859992 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.14s]
[0m18:10:55.860454 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:10:55.862195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:55.862978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:55.863268 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m18:10:55.863568 [info ] [MainThread]: 
[0m18:10:55.863951 [info ] [MainThread]: Finished running 5 tests, 1 view model in 0 hours 0 minutes and 10.42 seconds (10.42s).
[0m18:10:55.864702 [debug] [MainThread]: Command end result
[0m18:10:55.874882 [info ] [MainThread]: 
[0m18:10:55.875530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:55.875982 [info ] [MainThread]: 
[0m18:10:55.876412 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:10:55.877019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108953670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108953ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940e890>]}
[0m18:10:55.877463 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:01:07.733273 | c4e269fb-3f3c-42ad-ab8a-bc51bf26432d ==============================
[0m19:01:07.733273 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:01:07.745887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:01:07.746678 [debug] [MainThread]: Tracking: tracking
[0m19:01:07.747455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bcc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bde40>]}
[0m19:01:07.974282 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:01:08.097220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:08.098649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:08.099559 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:01:08.114483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087340d0>]}
[0m19:01:08.136048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084764d0>]}
[0m19:01:08.137348 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:01:08.137849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084765f0>]}
[0m19:01:08.143665 [info ] [MainThread]: 
[0m19:01:08.147235 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:08.148454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:01:08.185189 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:01:08.187512 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:01:08.188194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:09.645369 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:01:09.651052 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:01:09.892090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:01:09.911129 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:01:09.911517 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:01:09.912033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:10.810508 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m19:01:10.819251 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:01:11.031710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108475570>]}
[0m19:01:11.037908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:11.038352 [info ] [MainThread]: 
[0m19:01:11.057128 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:11.057769 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:01:11.059117 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:01:11.059847 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:11.068160 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:11.069985 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:01:11.060156 => 2023-07-08 19:01:11.069713
[0m19:01:11.075743 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:11.164283 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:11.166056 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:11.166685 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*)
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:01:11.166991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:11.818050 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7eb5-0504-a336-0050-3987000b50a6
[0m19:01:11.819176 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m19:01:11.820576 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:01:11.076087 => 2023-07-08 19:01:11.820332
[0m19:01:11.821348 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:01:12.060142 [debug] [Thread-1 (]: Database Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:01:12.061699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109428220>]}
[0m19:01:12.062836 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model DBT_NDW.distinct_num_baths_per_iteration .. [[31mERROR[0m in 1.00s]
[0m19:01:12.070131 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:12.071033 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:12.071632 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:01:12.072737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:01:12.073268 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:12.111136 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:12.112656 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:01:12.073541 => 2023-07-08 19:01:12.112514
[0m19:01:12.113077 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:12.152759 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:12.154611 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:12.155158 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:01:12.155532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:12.751012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:12.770166 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:01:12.113556 => 2023-07-08 19:01:12.770070
[0m19:01:12.770780 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:01:12.952229 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.88s]
[0m19:01:12.953044 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:12.953595 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:12.954109 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:01:12.955281 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:01:12.955584 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:12.960834 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:12.961493 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:01:12.955734 => 2023-07-08 19:01:12.961406
[0m19:01:12.961720 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:12.965349 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:12.966359 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:12.966541 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:01:12.966696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:13.501720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:13.504956 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:01:12.961856 => 2023-07-08 19:01:13.504833
[0m19:01:13.505434 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:01:13.689004 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.73s]
[0m19:01:13.689839 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:13.697208 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:13.698237 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:01:13.698912 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:01:13.699120 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:13.704450 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:13.705631 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:01:13.699255 => 2023-07-08 19:01:13.705528
[0m19:01:13.706304 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:13.712371 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:13.714408 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:13.714922 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:01:13.715233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:14.424204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:14.448389 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:01:13.706615 => 2023-07-08 19:01:14.448335
[0m19:01:14.448688 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:01:14.628908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108475570>]}
[0m19:01:14.629414 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.93s]
[0m19:01:14.629756 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:14.630462 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:14.630838 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:01:14.631475 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:01:14.631813 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:14.639381 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:14.640029 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:01:14.632178 => 2023-07-08 19:01:14.639970
[0m19:01:14.640268 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:14.643052 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:14.643899 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:14.644080 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:01:14.644254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:16.633511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:01:16.636894 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:01:14.640419 => 2023-07-08 19:01:16.636783
[0m19:01:16.637345 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:01:16.807805 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 2.18s]
[0m19:01:16.808579 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:16.809074 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:16.809426 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:01:16.810358 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:01:16.810812 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:16.819198 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:16.820450 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:01:16.811068 => 2023-07-08 19:01:16.820338
[0m19:01:16.820703 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:16.824011 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:16.825254 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:16.825479 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:01:16.825646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:17.758943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:17.761987 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:01:16.820845 => 2023-07-08 19:01:17.761873
[0m19:01:17.762384 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:01:17.965059 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.15s]
[0m19:01:17.965866 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:17.966395 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:17.966864 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:01:17.967809 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:01:17.968205 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:17.979642 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:17.980272 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:01:17.968425 => 2023-07-08 19:01:17.980216
[0m19:01:17.980489 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:17.983919 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:17.985096 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:17.985317 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:01:17.985484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:18.749599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:18.752879 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:01:17.980622 => 2023-07-08 19:01:18.752747
[0m19:01:18.753379 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:01:18.955775 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 0.99s]
[0m19:01:18.956571 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:18.958471 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:18.959341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:18.959653 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:01:18.960038 [info ] [MainThread]: 
[0m19:01:18.960553 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 10.82 seconds (10.82s).
[0m19:01:18.961433 [debug] [MainThread]: Command end result
[0m19:01:18.971309 [info ] [MainThread]: 
[0m19:01:18.971754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:01:18.972265 [info ] [MainThread]: 
[0m19:01:18.973005 [error] [MainThread]: [33mDatabase Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)[0m
[0m19:01:18.973705 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m19:01:18.974004 [error] [MainThread]:   Missing column specification
[0m19:01:18.974215 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:01:18.974808 [info ] [MainThread]: 
[0m19:01:18.975225 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m19:01:18.975757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a6d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd68c0>]}
[0m19:01:18.976054 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:01:37.025495 | eccd8a98-f36e-4b26-abc2-82c0e48dc6cc ==============================
[0m19:01:37.025495 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:01:37.029249 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:01:37.029429 [debug] [MainThread]: Tracking: tracking
[0m19:01:37.029716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115527790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115525de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115524ee0>]}
[0m19:01:37.098580 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:01:37.144101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:37.144376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:37.144902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:01:37.153216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161300d0>]}
[0m19:01:37.167332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156de500>]}
[0m19:01:37.168332 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:01:37.168900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114531e70>]}
[0m19:01:37.172297 [info ] [MainThread]: 
[0m19:01:37.175634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:37.177227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:01:37.198825 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:01:37.199158 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:01:37.199351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:38.080825 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:01:38.083201 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:01:38.277138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:01:38.288818 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:01:38.289166 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:01:38.289353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:38.966951 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m19:01:38.968447 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:01:39.136635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116176b90>]}
[0m19:01:39.138883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:39.139273 [info ] [MainThread]: 
[0m19:01:39.142923 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:39.143273 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:01:39.143880 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:01:39.144120 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:39.146006 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:39.146922 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:01:39.144272 => 2023-07-08 19:01:39.146854
[0m19:01:39.147175 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:39.181247 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:39.182777 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:39.183005 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*)
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
  );
[0m19:01:39.183305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:39.699333 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7eb5-0504-a396-0050-3987000b601a
[0m19:01:39.699635 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m19:01:39.699916 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:01:39.147321 => 2023-07-08 19:01:39.699867
[0m19:01:39.700365 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:01:39.868241 [debug] [Thread-1 (]: Database Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:01:39.868683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a31030>]}
[0m19:01:39.869054 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model DBT_NDW.distinct_num_baths_per_iteration .. [[31mERROR[0m in 0.73s]
[0m19:01:39.870490 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:39.870776 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:39.871090 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:01:39.871943 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:01:39.872391 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:39.889839 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:39.890841 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:01:39.872666 => 2023-07-08 19:01:39.890755
[0m19:01:39.891098 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:39.907603 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:39.908583 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:39.908763 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:01:39.908923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:40.403085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m19:01:40.409231 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:01:39.891239 => 2023-07-08 19:01:40.409173
[0m19:01:40.409476 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:01:40.624675 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.75s]
[0m19:01:40.625486 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:40.626026 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:40.626529 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:01:40.627528 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:01:40.627937 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:40.634362 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:40.634989 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:01:40.628166 => 2023-07-08 19:01:40.634935
[0m19:01:40.635204 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:40.638222 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:40.639704 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:40.640080 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:01:40.640337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:41.342935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:41.345933 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:01:40.635336 => 2023-07-08 19:01:41.345824
[0m19:01:41.346560 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:01:41.536043 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.91s]
[0m19:01:41.536794 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:41.537751 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:41.538436 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:01:41.539425 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:01:41.539809 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:41.543218 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:41.544218 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:01:41.540069 => 2023-07-08 19:01:41.544107
[0m19:01:41.544630 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:41.547812 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:41.549439 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:41.549689 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:01:41.549849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:42.201263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:42.224791 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:01:41.544803 => 2023-07-08 19:01:42.224740
[0m19:01:42.225080 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:01:42.401228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ca9600>]}
[0m19:01:42.402103 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.86s]
[0m19:01:42.402678 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:42.403768 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:42.404171 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:01:42.405368 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:01:42.406252 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:42.411685 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:42.412250 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:01:42.406470 => 2023-07-08 19:01:42.412196
[0m19:01:42.412457 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:42.417781 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:42.418922 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:42.419127 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:01:42.419283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:43.292365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:43.294172 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:01:42.412590 => 2023-07-08 19:01:43.294121
[0m19:01:43.294383 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:01:43.500859 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.10s]
[0m19:01:43.501289 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:43.501660 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:43.501917 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:01:43.502508 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:01:43.502675 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:43.506268 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:43.506967 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:01:43.502788 => 2023-07-08 19:01:43.506917
[0m19:01:43.507151 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:43.509303 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:43.510111 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:43.510256 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:01:43.510389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:44.047651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:44.049382 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:01:43.507267 => 2023-07-08 19:01:44.049333
[0m19:01:44.049573 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:01:44.220477 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 0.72s]
[0m19:01:44.221257 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:44.221791 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:44.222260 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:01:44.223281 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:01:44.223716 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:44.232430 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:44.232982 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:01:44.224097 => 2023-07-08 19:01:44.232932
[0m19:01:44.233172 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:44.235471 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:44.237096 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:44.237309 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:01:44.237455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:45.829863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:01:45.832895 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:01:44.233290 => 2023-07-08 19:01:45.832776
[0m19:01:45.833360 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:01:45.993004 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.77s]
[0m19:01:45.993787 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:45.995513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:45.996364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:45.996692 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:01:45.997197 [info ] [MainThread]: 
[0m19:01:45.997528 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m19:01:45.998084 [debug] [MainThread]: Command end result
[0m19:01:46.006458 [info ] [MainThread]: 
[0m19:01:46.006819 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:01:46.007113 [info ] [MainThread]: 
[0m19:01:46.007476 [error] [MainThread]: [33mDatabase Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)[0m
[0m19:01:46.007715 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m19:01:46.007951 [error] [MainThread]:   Missing column specification
[0m19:01:46.008460 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:01:46.008888 [info ] [MainThread]: 
[0m19:01:46.009284 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m19:01:46.009818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ba2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b527a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116176b90>]}
[0m19:01:46.010250 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:03:07.825209 | 54100bf1-5270-46ca-b8fe-0ceda0509383 ==============================
[0m19:03:07.825209 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:03:07.832089 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:03:07.832369 [debug] [MainThread]: Tracking: tracking
[0m19:03:07.833200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37de40>]}
[0m19:03:07.964680 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:03:08.041074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:08.041537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:08.042333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:03:08.051736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf300d0>]}
[0m19:03:08.065189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a4d0>]}
[0m19:03:08.071956 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:03:08.074005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a5f0>]}
[0m19:03:08.076614 [info ] [MainThread]: 
[0m19:03:08.086608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:08.094127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:03:08.129246 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:03:08.129827 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:03:08.130397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:09.185952 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:03:09.189611 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:03:09.418268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:03:09.429295 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:03:09.429737 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:03:09.430400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:10.334176 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m19:03:10.336644 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:03:11.090332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf76a40>]}
[0m19:03:11.091908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:11.092375 [info ] [MainThread]: 
[0m19:03:11.096749 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:11.097217 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:03:11.098133 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:03:11.098579 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:11.101489 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:11.102552 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:03:11.098853 => 2023-07-08 19:03:11.102468
[0m19:03:11.102852 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:11.146084 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:11.147512 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:11.148087 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*)
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
  );
[0m19:03:11.148302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:11.933187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7eb7-0504-a396-0050-3987000b6032
[0m19:03:11.933504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m19:03:11.933792 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:03:11.103023 => 2023-07-08 19:03:11.933742
[0m19:03:11.933978 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:03:12.195871 [debug] [Thread-1 (]: Database Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:03:12.196585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c82cf40>]}
[0m19:03:12.197182 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model DBT_NDW.distinct_num_baths_per_iteration .. [[31mERROR[0m in 1.10s]
[0m19:03:12.199881 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:12.200581 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:12.201123 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:03:12.202046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:03:12.202520 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:12.217932 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:12.218939 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:03:12.203386 => 2023-07-08 19:03:12.218789
[0m19:03:12.219476 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:12.242154 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:12.243159 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:12.243338 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:03:12.243496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:13.075948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:13.086509 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:03:12.219772 => 2023-07-08 19:03:13.086435
[0m19:03:13.086807 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:03:13.327790 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.13s]
[0m19:03:13.328257 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:13.328531 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:13.328790 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:03:13.329342 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:03:13.329590 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:13.334998 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:13.335827 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:03:13.329736 => 2023-07-08 19:03:13.335728
[0m19:03:13.336063 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:13.338609 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:13.339863 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:13.340326 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:03:13.340509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:13.934112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:13.936969 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:03:13.336203 => 2023-07-08 19:03:13.936878
[0m19:03:13.937349 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:03:14.159944 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.83s]
[0m19:03:14.160740 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:14.161888 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:14.162304 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:03:14.162944 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:03:14.163154 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:14.165922 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:14.166884 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:03:14.163290 => 2023-07-08 19:03:14.166824
[0m19:03:14.168268 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:14.173611 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:14.174978 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:14.175205 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:03:14.175370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:16.335482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:03:16.366822 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:03:14.168499 => 2023-07-08 19:03:16.366732
[0m19:03:16.367375 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:03:16.611570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf77250>]}
[0m19:03:16.612398 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 2.45s]
[0m19:03:16.612978 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:16.613993 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:16.614612 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:03:16.615377 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:03:16.615631 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:16.619902 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:16.620866 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:03:16.615782 => 2023-07-08 19:03:16.620808
[0m19:03:16.621094 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:16.623445 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:16.624279 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:16.624481 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:03:16.624647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:17.770235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:17.773405 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:03:16.621228 => 2023-07-08 19:03:17.773291
[0m19:03:17.773840 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:03:17.964673 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.35s]
[0m19:03:17.965419 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:17.965881 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:17.966339 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:03:17.967305 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:03:17.967694 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:17.973009 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:17.973702 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:03:17.967927 => 2023-07-08 19:03:17.973642
[0m19:03:17.973948 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:17.976722 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:17.977795 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:17.978238 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:03:17.978653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:18.805407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:18.808723 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:03:17.974100 => 2023-07-08 19:03:18.808611
[0m19:03:18.809162 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:03:19.035435 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.07s]
[0m19:03:19.036234 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:19.036744 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:19.037205 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:03:19.038464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:03:19.038891 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:19.052091 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:19.053342 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:03:19.039125 => 2023-07-08 19:03:19.053166
[0m19:03:19.053932 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:19.057759 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:19.058849 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:19.059045 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:19.059202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:19.920224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:19.923031 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:03:19.054254 => 2023-07-08 19:03:19.922936
[0m19:03:19.923438 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:03:20.088108 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.05s]
[0m19:03:20.088889 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:20.090715 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:20.091519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:20.091763 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:03:20.091990 [info ] [MainThread]: 
[0m19:03:20.092287 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 12.01 seconds (12.01s).
[0m19:03:20.092810 [debug] [MainThread]: Command end result
[0m19:03:20.100762 [info ] [MainThread]: 
[0m19:03:20.101123 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:03:20.101332 [info ] [MainThread]: 
[0m19:03:20.101738 [error] [MainThread]: [33mDatabase Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)[0m
[0m19:03:20.102253 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m19:03:20.102488 [error] [MainThread]:   Missing column specification
[0m19:03:20.102871 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:03:20.103122 [info ] [MainThread]: 
[0m19:03:20.103361 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m19:03:20.103689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a140>]}
[0m19:03:20.104053 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:03:39.534450 | 06baad50-0326-4e18-891d-d1ec1215f278 ==============================
[0m19:03:39.534450 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:03:39.538648 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:03:39.538947 [debug] [MainThread]: Tracking: tracking
[0m19:03:39.539336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113827730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113825de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113826e90>]}
[0m19:03:39.623485 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:03:39.678954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:39.679265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:39.679808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:03:39.690063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06baad50-0326-4e18-891d-d1ec1215f278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11450c0d0>]}
[0m19:03:39.700019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06baad50-0326-4e18-891d-d1ec1215f278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144da4d0>]}
[0m19:03:39.700700 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:03:39.701170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06baad50-0326-4e18-891d-d1ec1215f278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11035e5f0>]}
[0m19:03:39.702414 [info ] [MainThread]: 
[0m19:03:39.705680 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:39.706766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:03:39.726445 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:03:39.726749 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:03:39.726943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:40.832345 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:03:40.833718 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:03:41.149954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:41.150268 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m19:03:41.150453 [info ] [MainThread]: 
[0m19:03:41.150703 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m19:03:41.151088 [debug] [MainThread]: Flushing usage events
[0m19:03:41.450167 [info ] [MainThread]: ctrl-c


============================== 2023-07-08 19:03:47.455314 | 62b566da-2bdd-41f7-9d62-c4441a241023 ==============================
[0m19:03:47.455314 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:03:47.460612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:03:47.461036 [debug] [MainThread]: Tracking: tracking
[0m19:03:47.461582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11231f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11231cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11231de40>]}
[0m19:03:47.535702 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:03:47.573605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:47.573910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:47.574461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:03:47.584701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137180d0>]}
[0m19:03:47.598756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e64d0>]}
[0m19:03:47.599141 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:03:47.599422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e65f0>]}
[0m19:03:47.600775 [info ] [MainThread]: 
[0m19:03:47.602559 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:47.603567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:03:47.620938 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:03:47.622006 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:03:47.622270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:48.575958 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:03:48.578531 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:03:48.903693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:03:48.914836 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:03:48.915140 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:03:48.915330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:49.580622 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m19:03:49.583022 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:03:49.872643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113763e50>]}
[0m19:03:49.873736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:49.874253 [info ] [MainThread]: 
[0m19:03:49.878260 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:49.878620 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:03:49.879321 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:03:49.879561 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:49.883153 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:49.883790 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:03:49.879718 => 2023-07-08 19:03:49.883722
[0m19:03:49.884021 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:49.917831 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:49.919351 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:49.919602 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as the_count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
  );
[0m19:03:49.919810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:50.793485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:50.813809 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:03:49.884159 => 2023-07-08 19:03:50.813755
[0m19:03:50.814126 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:03:50.992648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12000b5b0>]}
[0m19:03:50.993447 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.11s]
[0m19:03:50.995996 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:50.997070 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:50.997368 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:03:50.998432 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:03:50.998666 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:51.014595 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:51.015837 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:03:50.998902 => 2023-07-08 19:03:51.015712
[0m19:03:51.016286 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:51.035634 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:51.036730 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:51.036928 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:03:51.037090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:51.827387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:51.838043 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:03:51.016514 => 2023-07-08 19:03:51.837968
[0m19:03:51.838375 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:03:52.000335 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.00s]
[0m19:03:52.001150 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:52.001689 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:52.002186 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:03:52.003183 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:03:52.003569 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:52.010452 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:52.011110 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:03:52.003783 => 2023-07-08 19:03:52.011055
[0m19:03:52.011323 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:52.016003 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:52.017579 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:52.017839 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:03:52.018021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.911930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:52.915274 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:03:52.011459 => 2023-07-08 19:03:52.915154
[0m19:03:52.915748 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:03:53.166368 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.16s]
[0m19:03:53.167142 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:53.168032 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:53.168781 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:03:53.169808 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:03:53.170217 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:53.174144 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:53.175544 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:03:53.170491 => 2023-07-08 19:03:53.175464
[0m19:03:53.175859 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:53.179374 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:53.180525 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:53.180694 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:03:53.180847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:53.975063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:53.982596 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:03:53.176004 => 2023-07-08 19:03:53.982513
[0m19:03:53.983091 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:03:54.144122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113763e50>]}
[0m19:03:54.144915 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.97s]
[0m19:03:54.145468 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:54.146452 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:54.146916 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:03:54.147930 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:03:54.148329 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:54.152672 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:54.153381 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:03:54.148483 => 2023-07-08 19:03:54.153310
[0m19:03:54.153627 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:54.156104 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:54.156944 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:54.157123 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:03:54.157278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:54.805361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:54.808263 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:03:54.153796 => 2023-07-08 19:03:54.808190
[0m19:03:54.808563 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:03:54.973595 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 0.83s]
[0m19:03:54.974398 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:54.974936 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:54.975412 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:03:54.976410 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:03:54.977022 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:54.985141 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:54.985749 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:03:54.977330 => 2023-07-08 19:03:54.985696
[0m19:03:54.985964 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:54.988436 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:54.989236 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:54.989393 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:03:54.989535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:55.665184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:55.668080 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:03:54.986099 => 2023-07-08 19:03:55.667984
[0m19:03:55.668457 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:03:55.967887 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 0.99s]
[0m19:03:55.968642 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:55.969144 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:55.969659 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:03:55.970694 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:03:55.971089 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:55.979524 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:55.980136 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:03:55.971304 => 2023-07-08 19:03:55.980082
[0m19:03:55.980349 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:55.982828 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:55.983742 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:55.983917 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:55.984067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:56.748296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:56.752098 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:03:55.980478 => 2023-07-08 19:03:56.752026
[0m19:03:56.752382 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:03:57.103205 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.13s]
[0m19:03:57.103957 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:57.105710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:57.106729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:57.106988 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:03:57.107209 [info ] [MainThread]: 
[0m19:03:57.107454 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 9.51 seconds (9.51s).
[0m19:03:57.108056 [debug] [MainThread]: Command end result
[0m19:03:57.116239 [info ] [MainThread]: 
[0m19:03:57.116618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:57.117211 [info ] [MainThread]: 
[0m19:03:57.117647 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:03:57.118195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113763e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202055a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120206e60>]}
[0m19:03:57.118671 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:04:06.831152 | b0273d83-299e-43cd-8062-0533fbd19500 ==============================
[0m19:04:06.831152 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:04:06.850562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:04:06.850906 [debug] [MainThread]: Tracking: tracking
[0m19:04:06.851884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611f670>]}
[0m19:04:07.025410 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:04:07.118417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:07.118900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:07.119769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:04:07.140141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de00d0>]}
[0m19:04:07.154960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa470>]}
[0m19:04:07.163353 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:04:07.164803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa590>]}
[0m19:04:07.167041 [info ] [MainThread]: 
[0m19:04:07.168527 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:07.170849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:04:07.197234 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:04:07.197772 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:04:07.198248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:08.539048 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:04:08.542103 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:04:08.850815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:04:08.862748 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:04:08.863460 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:04:08.863888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:09.827607 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m19:04:09.829759 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:04:10.143756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e272e0>]}
[0m19:04:10.144744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:10.145119 [info ] [MainThread]: 
[0m19:04:10.149938 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:04:10.150441 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:04:10.151149 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:04:10.151425 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:04:10.153296 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:04:10.153926 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:04:10.151609 => 2023-07-08 19:04:10.153828
[0m19:04:10.157046 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:04:10.208109 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:04:10.216349 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:04:10.216997 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
  );
[0m19:04:10.217307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:11.125649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:11.149365 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:04:10.157300 => 2023-07-08 19:04:11.149306
[0m19:04:11.149727 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:04:11.322686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb6740>]}
[0m19:04:11.323530 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.17s]
[0m19:04:11.327065 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:04:11.327783 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:04:11.328339 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:04:11.329083 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:04:11.329327 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:04:11.348512 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:04:11.349660 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:04:11.329493 => 2023-07-08 19:04:11.349574
[0m19:04:11.349974 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:04:11.373035 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:04:11.375477 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:04:11.375759 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:04:11.375969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:12.119103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:12.126968 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:04:11.350140 => 2023-07-08 19:04:12.126895
[0m19:04:12.127268 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:04:12.384354 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.06s]
[0m19:04:12.384969 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:04:12.385542 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:04:12.385855 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:04:12.386392 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:04:12.386581 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:04:12.391496 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:04:12.392551 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:04:12.386713 => 2023-07-08 19:04:12.392402
[0m19:04:12.392904 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:04:12.395800 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:04:12.397024 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:04:12.397229 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:04:12.397403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:12.952124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:12.954005 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:04:12.393081 => 2023-07-08 19:04:12.953948
[0m19:04:12.954231 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:04:13.273262 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.89s]
[0m19:04:13.274125 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:04:13.276764 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:04:13.277138 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:04:13.277903 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:04:13.278098 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:04:13.280907 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:04:13.281678 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:04:13.278231 => 2023-07-08 19:04:13.281623
[0m19:04:13.281885 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:04:13.287347 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:04:13.288700 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:04:13.288905 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:04:13.289082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:14.132816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:14.136561 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:04:13.282014 => 2023-07-08 19:04:14.136475
[0m19:04:14.137476 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:04:14.353603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da94b0>]}
[0m19:04:14.354417 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.08s]
[0m19:04:14.355012 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:04:14.356109 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:04:14.356655 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:04:14.357525 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:04:14.357805 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:04:14.362799 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:04:14.363670 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:04:14.357957 => 2023-07-08 19:04:14.363609
[0m19:04:14.363895 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:04:14.366539 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:04:14.367442 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:04:14.367645 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:04:14.367804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:15.107290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:15.110272 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:04:14.364033 => 2023-07-08 19:04:15.110155
[0m19:04:15.110749 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:04:15.422592 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.07s]
[0m19:04:15.423361 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:04:15.423846 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:04:15.424332 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:04:15.425348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:04:15.425899 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:04:15.431898 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:04:15.432523 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:04:15.426132 => 2023-07-08 19:04:15.432465
[0m19:04:15.432745 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:04:15.436012 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:04:15.436903 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:04:15.437083 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:04:15.437240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:16.350472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:16.353498 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:04:15.432898 => 2023-07-08 19:04:16.353383
[0m19:04:16.353972 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:04:16.618517 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.19s]
[0m19:04:16.619248 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:04:16.619749 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:04:16.620150 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:04:16.621203 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:04:16.621634 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:04:16.632283 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:04:16.634159 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:04:16.621861 => 2023-07-08 19:04:16.634037
[0m19:04:16.634600 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:04:16.638350 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:04:16.639350 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:04:16.639528 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:04:16.639686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:17.478042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:17.480966 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:04:16.634831 => 2023-07-08 19:04:17.480854
[0m19:04:17.481405 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:04:17.738262 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.12s]
[0m19:04:17.739355 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:04:17.741014 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:17.741750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:17.743425 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:04:17.743714 [info ] [MainThread]: 
[0m19:04:17.744035 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m19:04:17.744971 [debug] [MainThread]: Command end result
[0m19:04:17.753885 [info ] [MainThread]: 
[0m19:04:17.754344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:17.754885 [info ] [MainThread]: 
[0m19:04:17.755214 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:04:17.755605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dd360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa5c0>]}
[0m19:04:17.755842 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:05:05.988891 | 2d50c059-67d6-43d5-9e79-310ac63f429d ==============================
[0m19:05:05.988891 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:05:05.996301 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:05:05.996751 [debug] [MainThread]: Tracking: tracking
[0m19:05:05.997401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbf790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbdde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbcee0>]}
[0m19:05:06.195501 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:05:06.259992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:06.260682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:06.261573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:05:06.271895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132340d0>]}
[0m19:05:06.293630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f76590>]}
[0m19:05:06.294155 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:05:06.295811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa26b0>]}
[0m19:05:06.298917 [info ] [MainThread]: 
[0m19:05:06.302577 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:06.308977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:05:06.340212 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:05:06.340899 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:05:06.341232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:07.690982 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:05:07.701475 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:05:07.889759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:05:07.904734 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:05:07.905354 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:05:07.905703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:08.863611 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m19:05:08.866689 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:05:09.208084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327b1f0>]}
[0m19:05:09.209116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:09.209451 [info ] [MainThread]: 
[0m19:05:09.216104 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:05:09.216627 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:05:09.217335 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:05:09.217909 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:05:09.220840 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:05:09.221714 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:05:09.218198 => 2023-07-08 19:05:09.221606
[0m19:05:09.222111 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:05:09.277329 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:05:09.278929 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:05:09.279198 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:05:09.279369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:10.262756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:10.285918 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:05:09.222348 => 2023-07-08 19:05:10.285855
[0m19:05:10.286255 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:05:10.558111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b9e800>]}
[0m19:05:10.558896 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.34s]
[0m19:05:10.561428 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:05:10.562105 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:05:10.562653 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:05:10.563742 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:05:10.564163 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:05:10.585118 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:05:10.586051 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:05:10.564393 => 2023-07-08 19:05:10.585987
[0m19:05:10.586514 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:05:10.609217 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:05:10.610344 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:05:10.610566 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:05:10.610758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:11.190443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:11.200326 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:05:10.586753 => 2023-07-08 19:05:11.200254
[0m19:05:11.200630 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:05:11.426557 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.86s]
[0m19:05:11.427370 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:05:11.427897 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:05:11.428396 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:05:11.429389 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:05:11.429798 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:05:11.436433 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:05:11.437847 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:05:11.430118 => 2023-07-08 19:05:11.437743
[0m19:05:11.438210 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:05:11.441548 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:05:11.442469 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:05:11.442671 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:05:11.442833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:12.150976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:12.154080 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:05:11.438577 => 2023-07-08 19:05:12.153977
[0m19:05:12.154498 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:05:12.454435 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.03s]
[0m19:05:12.455178 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:05:12.456122 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:05:12.456727 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:05:12.457806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:05:12.458232 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:05:12.461527 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:05:12.462640 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:05:12.458524 => 2023-07-08 19:05:12.462578
[0m19:05:12.462870 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:05:12.467310 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:05:12.468723 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:05:12.468899 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:05:12.469054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:13.314772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:13.317196 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:05:12.463007 => 2023-07-08 19:05:13.317149
[0m19:05:13.317465 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:05:13.628265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114224250>]}
[0m19:05:13.629095 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.17s]
[0m19:05:13.629688 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:05:13.630659 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:05:13.631108 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:05:13.632037 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:05:13.632404 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:05:13.639116 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:05:13.640292 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:05:13.632621 => 2023-07-08 19:05:13.640213
[0m19:05:13.640566 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:05:13.643829 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:05:13.645244 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:05:13.645508 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:05:13.645694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:14.279031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:14.282315 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:05:13.640725 => 2023-07-08 19:05:14.282192
[0m19:05:14.282823 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:05:14.544722 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 0.91s]
[0m19:05:14.545237 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:05:14.545531 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:05:14.545862 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:05:14.546751 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:05:14.547178 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:05:14.553191 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:05:14.554032 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:05:14.547409 => 2023-07-08 19:05:14.553970
[0m19:05:14.554391 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:05:14.557767 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:05:14.559209 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:05:14.559594 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:05:14.559873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:15.189885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:15.192808 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:05:14.554875 => 2023-07-08 19:05:15.192702
[0m19:05:15.193252 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:05:15.492325 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 0.95s]
[0m19:05:15.493103 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:05:15.493607 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:05:15.494085 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:05:15.495087 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:05:15.495521 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:05:15.505555 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:05:15.506184 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:05:15.495736 => 2023-07-08 19:05:15.506131
[0m19:05:15.506397 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:05:15.510569 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:05:15.512148 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:05:15.512402 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:05:15.512570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:16.549159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:16.552156 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:05:15.506534 => 2023-07-08 19:05:16.552038
[0m19:05:16.552623 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:05:16.738382 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.24s]
[0m19:05:16.739139 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:05:16.740803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:16.741629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:16.741944 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:05:16.742281 [info ] [MainThread]: 
[0m19:05:16.742766 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 10.44 seconds (10.44s).
[0m19:05:16.743592 [debug] [MainThread]: Command end result
[0m19:05:16.751624 [info ] [MainThread]: 
[0m19:05:16.752117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:16.752398 [info ] [MainThread]: 
[0m19:05:16.753177 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:05:16.753570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141fad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114163d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b9e2f0>]}
[0m19:05:16.753952 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:07:11.235517 | ac14bdd8-12a7-40b2-bf22-308478f22ef7 ==============================
[0m19:07:11.235517 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:07:11.240221 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:07:11.240516 [debug] [MainThread]: Tracking: tracking
[0m19:07:11.240959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104607f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721f6a0>]}
[0m19:07:11.339276 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:07:11.390864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:07:11.391173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:07:11.391792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:07:11.400910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107844340>]}
[0m19:07:11.415145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e2860>]}
[0m19:07:11.415773 [info ] [MainThread]: Found 3 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:07:11.416136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb9e70>]}
[0m19:07:11.418045 [info ] [MainThread]: 
[0m19:07:11.421068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:07:11.422288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:07:11.447481 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:07:11.447861 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:07:11.448080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:12.748255 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:07:12.749680 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:07:13.035975 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:07:13.049877 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:07:13.050460 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:07:13.050787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:13.652508 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m19:07:13.654013 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:07:13.887844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788b1f0>]}
[0m19:07:13.889097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:07:13.889458 [info ] [MainThread]: 
[0m19:07:13.894216 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:07:13.894879 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:07:13.895492 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:07:13.895683 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:07:13.897441 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:07:13.899029 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:07:13.895917 => 2023-07-08 19:07:13.898956
[0m19:07:13.899278 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:07:13.936908 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:07:13.938070 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:07:13.938272 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:07:13.938452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:15.023856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:15.047511 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:07:13.899416 => 2023-07-08 19:07:15.047413
[0m19:07:15.047997 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:07:15.388642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee60e0>]}
[0m19:07:15.389452 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.49s]
[0m19:07:15.392034 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:07:15.392682 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:07:15.393306 [info ] [Thread-1 (]: 2 of 8 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ........ [RUN]
[0m19:07:15.395265 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m19:07:15.395485 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:07:15.397217 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:07:15.397858 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-08 19:07:15.395624 => 2023-07-08 19:07:15.397730
[0m19:07:15.398317 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:07:15.403663 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:07:15.404757 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:07:15.404946 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m19:07:15.405115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:16.512674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:16.515845 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-08 19:07:15.398569 => 2023-07-08 19:07:16.515755
[0m19:07:16.516284 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m19:07:16.859759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f39150>]}
[0m19:07:16.860639 [info ] [Thread-1 (]: 2 of 8 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ... [[32mSUCCESS 1[0m in 1.46s]
[0m19:07:16.861188 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:07:16.861659 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:07:16.862156 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:07:16.863171 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:07:16.863591 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:07:16.877994 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:07:16.879397 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:07:16.863909 => 2023-07-08 19:07:16.879327
[0m19:07:16.879634 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:07:16.902425 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:07:16.903922 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:07:16.904540 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:07:16.904774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:17.537778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:17.547551 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:07:16.880076 => 2023-07-08 19:07:17.547470
[0m19:07:17.547865 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:07:17.760068 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.90s]
[0m19:07:17.760541 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:07:17.760812 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:07:17.761077 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:07:17.761884 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:07:17.762195 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:07:17.766593 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:07:17.767277 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:07:17.762339 => 2023-07-08 19:07:17.767104
[0m19:07:17.767750 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:07:17.772475 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:07:17.773655 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:07:17.774104 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:07:17.774489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:18.710449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:18.712313 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:07:17.767979 => 2023-07-08 19:07:18.712257
[0m19:07:18.712533 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:07:18.933412 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.17s]
[0m19:07:18.934376 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:07:18.935466 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:07:18.936101 [info ] [Thread-1 (]: 5 of 8 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:07:18.937044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:07:18.937428 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:07:18.941125 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:07:18.942558 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:07:18.937647 => 2023-07-08 19:07:18.942465
[0m19:07:18.943018 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:07:18.946176 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:07:18.948161 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:07:18.948921 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:07:18.949127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:19.666959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:19.670415 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:07:18.943170 => 2023-07-08 19:07:19.670335
[0m19:07:19.670841 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:07:19.833787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107faf9a0>]}
[0m19:07:19.834666 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.90s]
[0m19:07:19.835273 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:07:19.836279 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:07:19.836729 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:07:19.837863 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:07:19.838296 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:07:19.846772 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:07:19.848131 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:07:19.838538 => 2023-07-08 19:07:19.847984
[0m19:07:19.848529 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:07:19.854239 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:07:19.856420 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:07:19.856929 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:07:19.857264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:20.570714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:20.573704 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:07:19.849148 => 2023-07-08 19:07:20.573602
[0m19:07:20.574101 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:07:21.272458 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.43s]
[0m19:07:21.273485 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:07:21.274348 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:07:21.274682 [info ] [Thread-1 (]: 7 of 8 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:07:21.275551 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:07:21.275836 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:07:21.284445 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:07:21.287005 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:07:21.276046 => 2023-07-08 19:07:21.286924
[0m19:07:21.287285 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:07:21.289953 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:07:21.291186 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:07:21.291392 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:07:21.291558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:21.898849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:21.902422 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:07:21.287428 => 2023-07-08 19:07:21.902278
[0m19:07:21.902925 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:07:22.319855 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.04s]
[0m19:07:22.320650 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:07:22.321251 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:07:22.321660 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:07:22.322668 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:07:22.323293 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:07:22.332025 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:07:22.332841 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:07:22.323605 => 2023-07-08 19:07:22.332704
[0m19:07:22.333324 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:07:22.336637 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:07:22.337816 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:07:22.338036 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:07:22.338228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:23.438619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:23.441312 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:07:22.333593 => 2023-07-08 19:07:23.441200
[0m19:07:23.441752 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:07:23.618491 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.30s]
[0m19:07:23.618945 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:07:23.620906 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:07:23.621843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:23.622205 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:07:23.622559 [info ] [MainThread]: 
[0m19:07:23.623205 [info ] [MainThread]: Finished running 3 view models, 5 tests in 0 hours 0 minutes and 12.20 seconds (12.20s).
[0m19:07:23.624320 [debug] [MainThread]: Command end result
[0m19:07:23.637490 [info ] [MainThread]: 
[0m19:07:23.637978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:07:23.638458 [info ] [MainThread]: 
[0m19:07:23.638872 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:07:23.639521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8af20>]}
[0m19:07:23.639828 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:13:52.849296 | 6c814495-8db9-4291-af78-736d54878b25 ==============================
[0m19:13:52.849296 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:13:52.854275 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:13:52.854546 [debug] [MainThread]: Tracking: tracking
[0m19:13:52.854898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a323730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a321de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a320e50>]}
[0m19:13:52.925418 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:13:52.960651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:52.960949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:52.961527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:13:52.969366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afefe50>]}
[0m19:13:52.980045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abe2ce0>]}
[0m19:13:52.980430 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:13:52.980737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861ada0>]}
[0m19:13:52.982750 [info ] [MainThread]: 
[0m19:13:52.984903 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:13:52.986730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:13:53.001684 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:13:53.002031 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:13:53.002261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:54.392979 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:13:54.396671 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:13:54.677644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:13:54.704041 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:13:54.704615 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:13:54.704981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:55.637872 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1 seconds
[0m19:13:55.653400 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:13:55.869687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0331f0>]}
[0m19:13:55.871238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:55.871855 [info ] [MainThread]: 
[0m19:13:55.885511 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:13:55.886403 [info ] [Thread-1 (]: 1 of 9 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:13:55.887513 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:13:55.888033 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:13:55.897467 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:13:55.899433 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:13:55.888306 => 2023-07-08 19:13:55.899078
[0m19:13:55.900158 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:13:55.984741 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:13:55.990887 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:13:55.991483 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:13:55.991777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:56.747110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:13:56.774679 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:13:55.900468 => 2023-07-08 19:13:56.774627
[0m19:13:56.774990 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:13:56.947535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e7760>]}
[0m19:13:56.948326 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.06s]
[0m19:13:56.950882 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:13:56.951547 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:13:56.952012 [info ] [Thread-1 (]: 2 of 9 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ........ [RUN]
[0m19:13:56.953136 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m19:13:56.953390 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:13:56.955127 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:13:56.955654 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-08 19:13:56.953534 => 2023-07-08 19:13:56.955602
[0m19:13:56.955850 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:13:56.961156 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:13:56.962291 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:13:56.962532 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m19:13:56.962720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:57.930014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:13:57.933862 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-08 19:13:56.955976 => 2023-07-08 19:13:57.933776
[0m19:13:57.934371 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m19:13:58.195073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b341c90>]}
[0m19:13:58.195892 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ... [[32mSUCCESS 1[0m in 1.24s]
[0m19:13:58.196467 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:13:58.196932 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:13:58.197493 [info ] [Thread-1 (]: 3 of 9 START sql view model DBT_NDW.price_buckets_days_on_market ............... [RUN]
[0m19:13:58.198455 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m19:13:58.198832 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:13:58.202350 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:13:58.203333 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-08 19:13:58.199050 => 2023-07-08 19:13:58.203250
[0m19:13:58.203846 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:13:58.208598 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:13:58.210615 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:13:58.210968 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market)
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m19:13:58.211154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:58.921785 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7ec1-0504-a396-0050-3987000b609e
[0m19:13:58.922150 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m19:13:58.922469 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-08 19:13:58.204173 => 2023-07-08 19:13:58.922414
[0m19:13:58.922702 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m19:13:59.081137 [debug] [Thread-1 (]: Database Error in model price_buckets_days_on_market (models/marts/core/price_buckets_days_on_market.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/price_buckets_days_on_market.sql
[0m19:13:59.081908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b310490>]}
[0m19:13:59.082512 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model DBT_NDW.price_buckets_days_on_market ...... [[31mERROR[0m in 0.88s]
[0m19:13:59.083253 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:13:59.083697 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:13:59.084368 [info ] [Thread-1 (]: 4 of 9 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:13:59.085350 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:13:59.085719 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:13:59.102837 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:13:59.104183 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:13:59.085939 => 2023-07-08 19:13:59.104082
[0m19:13:59.104632 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:13:59.126631 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:13:59.127810 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:13:59.128057 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:13:59.128253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:59.987539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:13:59.999037 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:13:59.104806 => 2023-07-08 19:13:59.998963
[0m19:13:59.999361 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:14:00.239845 [info ] [Thread-1 (]: 4 of 9 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.15s]
[0m19:14:00.240287 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:14:00.240540 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:14:00.240715 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:14:00.241601 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:14:00.242033 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:14:00.248590 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:14:00.249226 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:14:00.242262 => 2023-07-08 19:14:00.249171
[0m19:14:00.249446 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:14:00.253035 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:14:00.254250 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:14:00.254457 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:14:00.254636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:00.847832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:14:00.849924 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:14:00.249581 => 2023-07-08 19:14:00.849862
[0m19:14:00.850200 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:14:01.057830 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.82s]
[0m19:14:01.058706 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:14:01.059882 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:14:01.060398 [info ] [Thread-1 (]: 6 of 9 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:14:01.061069 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:14:01.061390 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:14:01.064596 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:14:01.065508 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:14:01.061541 => 2023-07-08 19:14:01.065349
[0m19:14:01.066116 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:14:01.075133 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:14:01.079456 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:14:01.079907 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:14:01.080168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:01.827409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:14:01.831039 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:14:01.066621 => 2023-07-08 19:14:01.830951
[0m19:14:01.831510 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:14:02.091185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e7550>]}
[0m19:14:02.091995 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.03s]
[0m19:14:02.092586 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:14:02.093669 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:14:02.094116 [info ] [Thread-1 (]: 7 of 9 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:14:02.095125 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:14:02.095560 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:14:02.102040 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:14:02.104057 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:14:02.095827 => 2023-07-08 19:14:02.103139
[0m19:14:02.104341 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:14:02.107253 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:14:02.108449 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:14:02.108682 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:14:02.108869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:03.453120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:14:03.456025 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:14:02.104502 => 2023-07-08 19:14:03.455929
[0m19:14:03.456421 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:14:03.820093 [info ] [Thread-1 (]: 7 of 9 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.73s]
[0m19:14:03.820650 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:14:03.821000 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:14:03.821193 [info ] [Thread-1 (]: 8 of 9 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:14:03.821822 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:14:03.822039 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:14:03.825911 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:14:03.826466 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:14:03.822178 => 2023-07-08 19:14:03.826418
[0m19:14:03.826672 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:14:03.829091 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:14:03.829962 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:14:03.830131 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:14:03.830281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:04.973121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:14:05.009993 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:14:03.826803 => 2023-07-08 19:14:05.009576
[0m19:14:05.010719 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:14:05.415355 [info ] [Thread-1 (]: 8 of 9 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.59s]
[0m19:14:05.416413 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:14:05.417152 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:14:05.418505 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:14:05.419995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:14:05.420887 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:14:05.443664 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:14:05.449055 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:14:05.426131 => 2023-07-08 19:14:05.448953
[0m19:14:05.449602 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:14:05.460792 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:14:05.463951 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:14:05.464672 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:14:05.465273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:07.043155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:14:07.059987 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:14:05.449768 => 2023-07-08 19:14:07.058950
[0m19:14:07.061122 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:14:07.325028 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.90s]
[0m19:14:07.326281 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:14:07.335269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:07.335873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:07.336029 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:14:07.336730 [info ] [MainThread]: 
[0m19:14:07.346948 [info ] [MainThread]: Finished running 4 view models, 5 tests in 0 hours 0 minutes and 14.35 seconds (14.35s).
[0m19:14:07.348232 [debug] [MainThread]: Command end result
[0m19:14:07.378930 [info ] [MainThread]: 
[0m19:14:07.379903 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:14:07.386351 [info ] [MainThread]: 
[0m19:14:07.386594 [error] [MainThread]: [33mDatabase Error in model price_buckets_days_on_market (models/marts/core/price_buckets_days_on_market.sql)[0m
[0m19:14:07.387504 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m19:14:07.388314 [error] [MainThread]:   Missing column specification
[0m19:14:07.388770 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/price_buckets_days_on_market.sql
[0m19:14:07.389326 [info ] [MainThread]: 
[0m19:14:07.389806 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:14:07.400065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4edb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e7550>]}
[0m19:14:07.401141 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:15:15.308861 | db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d ==============================
[0m19:15:15.308861 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:15:15.312856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:15:15.313120 [debug] [MainThread]: Tracking: tracking
[0m19:15:15.313525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141b7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141b5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141b4310>]}
[0m19:15:15.387595 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:15:15.426944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:15.427245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:15.427860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:15:15.434690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11501be20>]}
[0m19:15:15.447268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11437acb0>]}
[0m19:15:15.447772 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:15:15.448097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e01e70>]}
[0m19:15:15.449739 [info ] [MainThread]: 
[0m19:15:15.453018 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:15.458779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:15:15.483817 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:15:15.484915 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:15:15.485255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:16.853086 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:15:16.854793 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:15:17.120310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:15:17.130720 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:15:17.131100 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:15:17.131322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:18.083057 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1 seconds
[0m19:15:18.085689 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:15:18.269568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11505c1c0>]}
[0m19:15:18.270208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:18.270471 [info ] [MainThread]: 
[0m19:15:18.275642 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:15:18.276045 [info ] [Thread-1 (]: 1 of 9 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:15:18.276963 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:15:18.277411 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:15:18.279558 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:15:18.280351 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:15:18.277668 => 2023-07-08 19:15:18.280280
[0m19:15:18.280606 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:15:18.312809 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:15:18.313998 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:15:18.314212 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:15:18.314560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:19.173332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:19.194684 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:15:18.280763 => 2023-07-08 19:15:19.194632
[0m19:15:19.194986 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:15:19.501266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a113c0>]}
[0m19:15:19.502069 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.22s]
[0m19:15:19.504670 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:15:19.505911 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:15:19.506300 [info ] [Thread-1 (]: 2 of 9 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ........ [RUN]
[0m19:15:19.506972 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m19:15:19.507560 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:15:19.510456 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:15:19.511569 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-08 19:15:19.507738 => 2023-07-08 19:15:19.511475
[0m19:15:19.511983 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:15:19.517591 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:15:19.518750 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:15:19.518963 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m19:15:19.519142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:20.435511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:20.439044 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-08 19:15:19.512269 => 2023-07-08 19:15:20.438964
[0m19:15:20.439474 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m19:15:20.741183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114379f60>]}
[0m19:15:20.741986 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ... [[32mSUCCESS 1[0m in 1.23s]
[0m19:15:20.742511 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:15:20.742937 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:15:20.743502 [info ] [Thread-1 (]: 3 of 9 START sql view model DBT_NDW.price_buckets_days_on_market ............... [RUN]
[0m19:15:20.744538 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m19:15:20.744979 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:15:20.748000 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:15:20.748678 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-08 19:15:20.745314 => 2023-07-08 19:15:20.748616
[0m19:15:20.748936 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:15:20.754710 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:15:20.756514 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:15:20.756716 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market) as avg_days_on_market
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m19:15:20.756894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:21.567769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:21.571052 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-08 19:15:20.749093 => 2023-07-08 19:15:21.570972
[0m19:15:21.571466 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m19:15:21.746454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a6d540>]}
[0m19:15:21.747059 [info ] [Thread-1 (]: 3 of 9 OK created sql view model DBT_NDW.price_buckets_days_on_market .......... [[32mSUCCESS 1[0m in 1.00s]
[0m19:15:21.747423 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:15:21.747990 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:15:21.748384 [info ] [Thread-1 (]: 4 of 9 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:15:21.749016 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:15:21.749662 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:15:21.768606 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:15:21.769372 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:15:21.749809 => 2023-07-08 19:15:21.769225
[0m19:15:21.770136 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:15:21.792597 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:15:21.793672 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:15:21.793886 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:15:21.794071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:22.388233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:22.395467 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:15:21.770331 => 2023-07-08 19:15:22.395397
[0m19:15:22.395767 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:15:22.566004 [info ] [Thread-1 (]: 4 of 9 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.82s]
[0m19:15:22.566748 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:15:22.567265 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:15:22.567700 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:15:22.568396 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:15:22.568679 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:15:22.577374 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:15:22.578164 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:15:22.568849 => 2023-07-08 19:15:22.578042
[0m19:15:22.578621 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:15:22.581410 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:15:22.582332 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:15:22.582525 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:15:22.582720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:23.311496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:23.313301 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:15:22.578855 => 2023-07-08 19:15:23.313249
[0m19:15:23.313516 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:15:23.476080 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.91s]
[0m19:15:23.476829 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:15:23.477822 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:15:23.478422 [info ] [Thread-1 (]: 6 of 9 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:15:23.479464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:15:23.479809 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:15:23.482900 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:15:23.484031 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:15:23.480140 => 2023-07-08 19:15:23.483883
[0m19:15:23.484764 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:15:23.488337 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:15:23.489481 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:15:23.489653 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:15:23.489805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:24.217053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:24.223569 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:15:23.485069 => 2023-07-08 19:15:24.223510
[0m19:15:24.223925 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:15:24.468732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a38340>]}
[0m19:15:24.469938 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.99s]
[0m19:15:24.471585 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:15:24.476369 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:15:24.476985 [info ] [Thread-1 (]: 7 of 9 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:15:24.477954 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:15:24.478400 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:15:24.487473 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:15:24.488126 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:15:24.478654 => 2023-07-08 19:15:24.488059
[0m19:15:24.488806 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:15:24.492181 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:15:24.494146 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:15:24.494688 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:15:24.495364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:25.383888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:25.388805 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:15:24.489041 => 2023-07-08 19:15:25.388656
[0m19:15:25.389434 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:15:25.722289 [info ] [Thread-1 (]: 7 of 9 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.24s]
[0m19:15:25.723084 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:15:25.723624 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:15:25.724308 [info ] [Thread-1 (]: 8 of 9 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:15:25.725452 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:15:25.725895 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:15:25.731499 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:15:25.732085 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:15:25.726138 => 2023-07-08 19:15:25.732034
[0m19:15:25.732290 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:15:25.734725 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:15:25.735544 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:15:25.735706 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:15:25.735854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:27.055950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:27.061037 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:15:25.732421 => 2023-07-08 19:15:27.060719
[0m19:15:27.061613 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:15:27.410609 [info ] [Thread-1 (]: 8 of 9 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.69s]
[0m19:15:27.411440 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:15:27.411997 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:15:27.413146 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:15:27.414006 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:15:27.414261 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:15:27.427995 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:15:27.429406 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:15:27.414423 => 2023-07-08 19:15:27.429349
[0m19:15:27.429947 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:15:27.437757 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:15:27.439447 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:15:27.439693 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:15:27.439938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:28.484268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:28.487939 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:15:27.430161 => 2023-07-08 19:15:28.487814
[0m19:15:28.488457 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:15:28.659914 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.25s]
[0m19:15:28.660467 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:15:28.662385 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:28.663211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:28.663503 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:15:28.663851 [info ] [MainThread]: 
[0m19:15:28.664578 [info ] [MainThread]: Finished running 4 view models, 5 tests in 0 hours 0 minutes and 13.21 seconds (13.21s).
[0m19:15:28.666189 [debug] [MainThread]: Command end result
[0m19:15:28.704056 [info ] [MainThread]: 
[0m19:15:28.706214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:28.706513 [info ] [MainThread]: 
[0m19:15:28.706752 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:15:28.707149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b19e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11505b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ab6da0>]}
[0m19:15:28.707456 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:21:49.939002 | 6e400805-903d-48d3-bc1e-efa408ea02af ==============================
[0m19:21:49.939002 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:21:49.946898 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:21:49.947176 [debug] [MainThread]: Tracking: tracking
[0m19:21:49.947537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1de10>]}
[0m19:21:50.041469 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:21:50.089203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:21:50.089532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:21:50.090229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:21:50.099101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd8b20>]}
[0m19:21:50.111288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba71f0>]}
[0m19:21:50.111706 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:21:50.112015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e16da0>]}
[0m19:21:50.114480 [info ] [MainThread]: 
[0m19:21:50.117312 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:21:50.119285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:21:50.137046 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:21:50.137407 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:21:50.137644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:51.599758 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:21:51.602020 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:21:51.858065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:21:51.867286 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:21:51.867570 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:21:51.867751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:52.697028 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1 seconds
[0m19:21:52.699584 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:21:52.980706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1eb00>]}
[0m19:21:52.982961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:21:52.983327 [info ] [MainThread]: 
[0m19:21:52.988350 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m19:21:52.989092 [info ] [Thread-1 (]: 1 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m19:21:52.989729 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m19:21:52.990078 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m19:21:52.993394 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m19:21:52.994143 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-08 19:21:52.990504 => 2023-07-08 19:21:52.994062
[0m19:21:52.994377 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m19:21:53.022765 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m19:21:53.023791 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m19:21:53.024020 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    -- for this number of beds/baths and iteration_date, show the median price
select distinct num_bedrooms, num_bathrooms, iteration_date, median(price) as median_price
from analytics.dbt_ndw.stg_property_sale_listings
group by num_bedrooms, num_bathrooms, iteration_date
order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
  );
[0m19:21:53.024181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:53.775975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:21:53.799169 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-08 19:21:52.994518 => 2023-07-08 19:21:53.799077
[0m19:21:53.799684 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m19:21:54.110090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108daaf20>]}
[0m19:21:54.110795 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 1.12s]
[0m19:21:54.113104 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m19:21:54.113672 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:21:54.114143 [info ] [Thread-1 (]: 2 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m19:21:54.114788 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:21:54.114999 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:21:54.116630 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:21:54.117961 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:21:54.115136 => 2023-07-08 19:21:54.117888
[0m19:21:54.118209 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:21:54.123311 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:21:54.124275 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:21:54.124446 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:21:54.124602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:55.049273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:21:55.056846 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:21:54.118352 => 2023-07-08 19:21:55.056759
[0m19:21:55.059158 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:21:55.375022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108daafb0>]}
[0m19:21:55.375892 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 1.26s]
[0m19:21:55.376484 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:21:55.376912 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:21:55.377317 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m19:21:55.378592 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m19:21:55.379097 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:21:55.382239 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:21:55.383610 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-08 19:21:55.379304 => 2023-07-08 19:21:55.383505
[0m19:21:55.383940 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:21:55.387794 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:21:55.389255 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:21:55.389584 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m19:21:55.389761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:56.207582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:21:56.211231 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-08 19:21:55.384092 => 2023-07-08 19:21:56.211147
[0m19:21:56.211684 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m19:21:56.442323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108daaf80>]}
[0m19:21:56.443100 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 1.06s]
[0m19:21:56.443643 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:21:56.444100 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:21:56.444642 [info ] [Thread-1 (]: 4 of 10 START sql view model DBT_NDW.price_buckets_days_on_market .............. [RUN]
[0m19:21:56.445567 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m19:21:56.445927 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:21:56.448568 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:21:56.449622 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-08 19:21:56.446140 => 2023-07-08 19:21:56.449546
[0m19:21:56.449891 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:21:56.452978 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:21:56.454581 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:21:56.454749 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market) as avg_days_on_market
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m19:21:56.454901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:57.177207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:21:57.180898 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-08 19:21:56.450038 => 2023-07-08 19:21:57.180810
[0m19:21:57.181371 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m19:21:57.481879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108daae60>]}
[0m19:21:57.482689 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ......... [[32mSUCCESS 1[0m in 1.04s]
[0m19:21:57.483298 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:21:57.483881 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:21:57.484274 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:21:57.485371 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:21:57.485677 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:21:57.499969 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:21:57.503221 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:21:57.485824 => 2023-07-08 19:21:57.503071
[0m19:21:57.503644 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:21:57.518497 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:21:57.519493 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:21:57.519664 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:21:57.519817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:58.306328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:21:58.317017 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:21:57.503798 => 2023-07-08 19:21:58.316941
[0m19:21:58.317350 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:21:58.494520 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.01s]
[0m19:21:58.495274 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:21:58.495779 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:21:58.496271 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:21:58.497304 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:21:58.497697 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:21:58.504178 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:21:58.505097 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:21:58.497929 => 2023-07-08 19:21:58.505032
[0m19:21:58.505330 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:21:58.507901 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:21:58.508778 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:21:58.508949 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:21:58.509101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:59.109203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:21:59.111057 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:21:58.505469 => 2023-07-08 19:21:59.111005
[0m19:21:59.111270 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:21:59.406942 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.91s]
[0m19:21:59.407749 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:21:59.408776 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:21:59.409303 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m19:21:59.410243 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:21:59.410624 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:21:59.415262 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:21:59.416645 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:21:59.410852 => 2023-07-08 19:21:59.416516
[0m19:21:59.416980 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:21:59.419966 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:21:59.421031 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:21:59.421193 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:21:59.421338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:00.113645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:22:00.117176 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:21:59.417129 => 2023-07-08 19:22:00.117094
[0m19:22:00.117624 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:22:00.452384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e400805-903d-48d3-bc1e-efa408ea02af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960b520>]}
[0m19:22:00.452873 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 1.04s]
[0m19:22:00.453206 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:22:00.454136 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:22:00.454595 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m19:22:00.457114 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:22:00.457381 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:22:00.461387 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:22:00.462418 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:22:00.457516 => 2023-07-08 19:22:00.462360
[0m19:22:00.462895 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:22:00.466884 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:22:00.468166 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:22:00.468342 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:22:00.468500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:01.697339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:22:01.700569 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:22:00.463153 => 2023-07-08 19:22:01.700451
[0m19:22:01.701033 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:22:01.924979 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.47s]
[0m19:22:01.925771 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:22:01.926309 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:22:01.926794 [info ] [Thread-1 (]: 9 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m19:22:01.927800 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:22:01.928211 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:22:01.936403 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:22:01.937289 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:22:01.928427 => 2023-07-08 19:22:01.937212
[0m19:22:01.937561 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:22:01.941874 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:22:01.943411 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:22:01.943802 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:22:01.944153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:03.192501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:22:03.195531 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:22:01.937712 => 2023-07-08 19:22:03.195418
[0m19:22:03.195980 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:22:03.366510 [info ] [Thread-1 (]: 9 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.44s]
[0m19:22:03.367285 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:22:03.367847 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:22:03.368314 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:22:03.369377 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:22:03.369804 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:22:03.376208 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:22:03.376780 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:22:03.369991 => 2023-07-08 19:22:03.376727
[0m19:22:03.376996 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:22:03.380267 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:22:03.381237 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:22:03.381400 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:22:03.381547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:04.421413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:22:04.424434 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:22:03.377129 => 2023-07-08 19:22:04.424317
[0m19:22:04.424892 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:22:04.759029 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.39s]
[0m19:22:04.759883 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:22:04.761701 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:04.762648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:04.763279 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:22:04.763581 [info ] [MainThread]: 
[0m19:22:04.763849 [info ] [MainThread]: Finished running 5 view models, 5 tests in 0 hours 0 minutes and 14.65 seconds (14.65s).
[0m19:22:04.764825 [debug] [MainThread]: Command end result
[0m19:22:04.779337 [info ] [MainThread]: 
[0m19:22:04.779782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:22:04.780029 [info ] [MainThread]: 
[0m19:22:04.780240 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:22:04.780539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b1cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b04f0>]}
[0m19:22:04.781174 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:28:12.316066 | c3a8e517-28b5-4900-b9c1-b0bef84bfdc7 ==============================
[0m19:28:12.316066 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:28:12.322624 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:28:12.323136 [debug] [MainThread]: Tracking: tracking
[0m19:28:12.323716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f1f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f1dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f1cee0>]}
[0m19:28:12.396434 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:28:12.445577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:12.446018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:12.446925 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:28:12.461004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c34b50>]}
[0m19:28:12.472233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c03370>]}
[0m19:28:12.472630 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:28:12.472900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f166b0>]}
[0m19:28:12.474181 [info ] [MainThread]: 
[0m19:28:12.476822 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:12.478476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:28:12.496208 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:28:12.496780 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:28:12.497108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:13.851979 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:28:13.853984 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:28:14.171977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:28:14.182188 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:28:14.182494 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:28:14.182679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:15.409908 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1 seconds
[0m19:28:15.413150 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:28:15.824882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f166b0>]}
[0m19:28:15.825675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:15.825961 [info ] [MainThread]: 
[0m19:28:15.830216 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m19:28:15.830579 [info ] [Thread-1 (]: 1 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m19:28:15.831427 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m19:28:15.832023 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m19:28:15.833759 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m19:28:15.834760 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-08 19:28:15.832234 => 2023-07-08 19:28:15.834694
[0m19:28:15.835197 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m19:28:15.889895 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m19:28:15.892087 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m19:28:15.892299 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    -- for this number of beds/baths and iteration_date, show the median price
select distinct num_bedrooms, num_bathrooms, iteration_date, median(price) as median_price
from analytics.dbt_ndw.stg_property_sale_listings
group by num_bedrooms, num_bathrooms, iteration_date
order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
  );
[0m19:28:15.892457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:16.930942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:16.954143 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-08 19:28:15.835582 => 2023-07-08 19:28:16.954093
[0m19:28:16.954417 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m19:28:17.156371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123411db0>]}
[0m19:28:17.157206 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 1.33s]
[0m19:28:17.159748 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m19:28:17.161350 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:28:17.162339 [info ] [Thread-1 (]: 2 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m19:28:17.163132 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:28:17.163376 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:28:17.166525 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:28:17.169215 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:28:17.163510 => 2023-07-08 19:28:17.168985
[0m19:28:17.169714 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:28:17.173924 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:28:17.174919 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:28:17.175116 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:28:17.175275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:18.332326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:18.338945 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:28:17.169905 => 2023-07-08 19:28:18.338889
[0m19:28:18.339264 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:28:18.560920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12346b910>]}
[0m19:28:18.561800 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 1.40s]
[0m19:28:18.562548 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:28:18.563125 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:28:18.564020 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m19:28:18.565165 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m19:28:18.565654 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:28:18.567390 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:28:18.568680 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-08 19:28:18.565916 => 2023-07-08 19:28:18.568029
[0m19:28:18.568898 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:28:18.571557 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:28:18.573122 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:28:18.573928 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m19:28:18.574372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:19.569235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:19.594582 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-08 19:28:18.569021 => 2023-07-08 19:28:19.594403
[0m19:28:19.595774 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m19:28:19.843746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e0b010>]}
[0m19:28:19.845646 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 1.28s]
[0m19:28:19.846875 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:28:19.848691 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:28:19.849436 [info ] [Thread-1 (]: 4 of 10 START sql view model DBT_NDW.price_buckets_days_on_market .............. [RUN]
[0m19:28:19.850499 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m19:28:19.851201 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:28:19.860946 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:28:19.865718 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-08 19:28:19.854849 => 2023-07-08 19:28:19.865556
[0m19:28:19.866192 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:28:19.874002 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:28:19.878338 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:28:19.878955 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market) as avg_days_on_market
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m19:28:19.879322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:21.029488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:21.042885 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-08 19:28:19.866415 => 2023-07-08 19:28:21.042701
[0m19:28:21.043675 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m19:28:21.344124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234e1270>]}
[0m19:28:21.346148 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ......... [[32mSUCCESS 1[0m in 1.49s]
[0m19:28:21.347124 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:28:21.347884 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:28:21.348347 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:28:21.359512 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:28:21.364009 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:28:21.421932 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:28:21.430739 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:28:21.364347 => 2023-07-08 19:28:21.430619
[0m19:28:21.431773 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:28:21.487552 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:28:21.488827 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:28:21.489038 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:28:21.489208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:22.392829 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:22.430780 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:28:21.435685 => 2023-07-08 19:28:22.429360
[0m19:28:22.440071 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:28:22.644322 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.29s]
[0m19:28:22.645383 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:28:22.645991 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:28:22.646335 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:28:22.650165 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:28:22.651897 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:28:22.682028 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:28:22.683134 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:28:22.654223 => 2023-07-08 19:28:22.683026
[0m19:28:22.683581 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:28:22.691561 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:28:22.696500 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:28:22.697095 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:28:22.697901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:23.517339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:23.533650 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:28:22.683821 => 2023-07-08 19:28:23.533301
[0m19:28:23.534491 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:28:23.838028 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.19s]
[0m19:28:23.839019 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:28:23.841040 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:28:23.842171 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m19:28:23.843658 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:28:23.844336 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:28:23.852080 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:28:23.855101 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:28:23.844721 => 2023-07-08 19:28:23.854930
[0m19:28:23.855721 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:28:23.867195 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:28:23.884932 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:28:23.885558 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- staging table for property_sale_listings, converting timestamps to dates
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:28:23.885915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:24.873750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:24.882240 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:28:23.856181 => 2023-07-08 19:28:24.881950
[0m19:28:24.882853 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:28:25.205872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3a8e517-28b5-4900-b9c1-b0bef84bfdc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123623fa0>]}
[0m19:28:25.207342 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 1.36s]
[0m19:28:25.208250 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:28:25.211613 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:28:25.212359 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m19:28:25.213914 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:28:25.214883 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:28:25.225286 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:28:25.227084 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:28:25.215301 => 2023-07-08 19:28:25.226886
[0m19:28:25.228416 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:28:25.237693 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:28:25.240066 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:28:25.240815 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:28:25.241896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:26.756506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:28:26.764716 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:28:25.229168 => 2023-07-08 19:28:26.764499
[0m19:28:26.765338 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:28:26.962240 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.75s]
[0m19:28:26.964429 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:28:26.965203 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:28:26.965600 [info ] [Thread-1 (]: 9 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m19:28:26.966573 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:28:26.966960 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:28:26.989553 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:28:26.990655 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:28:26.967199 => 2023-07-08 19:28:26.990542
[0m19:28:26.991088 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:28:26.997835 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:28:26.999297 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:28:26.999720 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:28:26.999892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:28.114443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:28.134952 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:28:26.991317 => 2023-07-08 19:28:28.134751
[0m19:28:28.135565 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:28:28.433075 [info ] [Thread-1 (]: 9 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.47s]
[0m19:28:28.434276 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:28:28.437828 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:28:28.438374 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:28:28.446743 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:28:28.447419 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:28:28.481356 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:28:28.482772 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:28:28.447748 => 2023-07-08 19:28:28.482613
[0m19:28:28.483239 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:28:28.490844 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:28:28.492870 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:28:28.493319 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:28:28.493725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:29.755723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:28:29.759057 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:28:28.483571 => 2023-07-08 19:28:29.758925
[0m19:28:29.759603 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:28:29.986142 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.54s]
[0m19:28:29.987079 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:28:29.990284 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:29.991289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:29.991748 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:28:29.992177 [info ] [MainThread]: 
[0m19:28:29.993689 [info ] [MainThread]: Finished running 5 view models, 5 tests in 0 hours 0 minutes and 17.52 seconds (17.52s).
[0m19:28:29.995123 [debug] [MainThread]: Command end result
[0m19:28:30.026304 [info ] [MainThread]: 
[0m19:28:30.029142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:30.030587 [info ] [MainThread]: 
[0m19:28:30.031430 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:28:30.032850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c780d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e0b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e0afe0>]}
[0m19:28:30.033271 [debug] [MainThread]: Flushing usage events


============================== 2023-07-24 22:25:57.775766 | 159ee842-4556-4426-b70c-b720e23c0720 ==============================
[0m22:25:57.775766 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:25:57.782100 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m22:25:57.782405 [debug] [MainThread]: Tracking: tracking
[0m22:25:57.814342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a3b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a3c70>]}
[0m22:25:57.854614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a3c40>]}
[0m22:25:57.854984 [debug] [MainThread]: Flushing usage events


============================== 2023-07-24 22:29:26.680061 | d111265a-85a0-4243-a18c-15cd401c27a6 ==============================
[0m22:29:26.680061 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:29:26.685222 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:29:26.685549 [debug] [MainThread]: Tracking: tracking
[0m22:29:26.685981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d280a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da6c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da4a90>]}
[0m22:29:26.686946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d280a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da6c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da4a90>]}
[0m22:29:26.687274 [debug] [MainThread]: Flushing usage events
[0m22:29:26.950993 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-07-24 22:29:37.568588 | 6c445d17-5b38-4e4e-b1e8-6dbb160932ba ==============================
[0m22:29:37.568588 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:29:37.570575 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m22:29:37.570787 [debug] [MainThread]: Tracking: tracking
[0m22:29:37.604180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3c10>]}
[0m22:29:37.607069 [debug] [MainThread]: Set downloads directory='/var/folders/bc/hzhmpw894rxgr_jl9kxy34km0000gn/T/dbt-downloads-bd2_sijs'
[0m22:29:37.607828 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:29:37.770162 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:29:37.770619 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:29:37.862607 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:29:37.871641 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:29:38.129070 [info ] [MainThread]:   Installed from version 1.1.1
[0m22:29:38.129489 [info ] [MainThread]:   Up to date!
[0m22:29:38.129870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6c445d17-5b38-4e4e-b1e8-6dbb160932ba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3df0>]}
[0m22:29:38.130543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3a00>]}
[0m22:29:38.130767 [debug] [MainThread]: Flushing usage events


============================== 2023-07-24 23:25:32.787105 | 0c4a8ffb-c051-4aee-a7cc-df16e355877a ==============================
[0m23:25:32.787105 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:25:32.792344 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m23:25:32.792904 [debug] [MainThread]: Tracking: tracking
[0m23:25:32.793417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110529a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11052a410>]}
[0m23:25:32.867233 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:25:32.867942 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:25:32.868300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ca6b0>]}
[0m23:25:33.841181 [debug] [MainThread]: 1699: static parser successfully parsed staging/property_sale_listings/stg_property_sale_listings.sql
[0m23:25:33.856768 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_baths_per_iteration.sql
[0m23:25:33.860257 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/price_buckets_days_on_market.sql
[0m23:25:33.863246 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_bedrooms_per_iteration.sql
[0m23:25:33.866201 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/beds_baths_median_price.sql
[0m23:25:33.965335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m23:25:33.971651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a616c0>]}
[0m23:25:33.981696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b1330>]}
[0m23:25:33.982097 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:25:33.982397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f9f00>]}
[0m23:25:33.983795 [info ] [MainThread]: 
[0m23:25:33.985616 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:25:33.986795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m23:25:34.003031 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m23:25:34.003471 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m23:25:34.003737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:36.486930 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m23:25:36.489347 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m23:25:36.630493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m23:25:36.639972 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m23:25:36.640318 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m23:25:36.640541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:37.117515 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0 seconds
[0m23:25:37.120222 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m23:25:37.387068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f9f00>]}
[0m23:25:37.387960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:25:37.388265 [info ] [MainThread]: 
[0m23:25:37.464834 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m23:25:37.465261 [info ] [Thread-1 (]: 1 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m23:25:37.465883 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m23:25:37.466112 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m23:25:37.467815 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m23:25:37.468663 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-24 23:25:37.466320 => 2023-07-24 23:25:37.468609
[0m23:25:37.468878 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m23:25:37.499532 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m23:25:37.500980 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m23:25:37.501190 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    -- for this number of beds/baths and iteration_date, show the median price
select distinct num_bedrooms, num_bathrooms, iteration_date, median(price) as median_price
from analytics.dbt_ndw.stg_property_sale_listings
group by num_bedrooms, num_bathrooms, iteration_date
order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
  );
[0m23:25:37.501362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:38.133877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:38.156525 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-24 23:25:37.469013 => 2023-07-24 23:25:38.156468
[0m23:25:38.156855 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m23:25:38.280760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cbda80>]}
[0m23:25:38.281562 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.82s]
[0m23:25:38.284498 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m23:25:38.285351 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m23:25:38.285872 [info ] [Thread-1 (]: 2 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m23:25:38.286873 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m23:25:38.287212 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m23:25:38.289649 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m23:25:38.290330 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-24 23:25:38.287415 => 2023-07-24 23:25:38.290263
[0m23:25:38.290616 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m23:25:38.294762 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m23:25:38.296066 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m23:25:38.296299 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m23:25:38.296515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:38.951610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:38.955276 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-24 23:25:38.290799 => 2023-07-24 23:25:38.955190
[0m23:25:38.955739 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m23:25:39.095857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d4490>]}
[0m23:25:39.097270 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.81s]
[0m23:25:39.104179 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m23:25:39.105019 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m23:25:39.105622 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m23:25:39.106407 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m23:25:39.106680 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m23:25:39.109346 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m23:25:39.110155 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-24 23:25:39.106860 => 2023-07-24 23:25:39.110072
[0m23:25:39.110492 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m23:25:39.117672 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m23:25:39.119564 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m23:25:39.121395 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m23:25:39.121839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:40.580973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:40.584826 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-24 23:25:39.110936 => 2023-07-24 23:25:40.584739
[0m23:25:40.585290 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m23:25:40.722728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d4c40>]}
[0m23:25:40.723589 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 1.62s]
[0m23:25:40.724206 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m23:25:40.724800 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m23:25:40.725372 [info ] [Thread-1 (]: 4 of 10 START sql view model DBT_NDW.price_buckets_days_on_market .............. [RUN]
[0m23:25:40.726463 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m23:25:40.726815 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m23:25:40.730958 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m23:25:40.731631 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-24 23:25:40.729000 => 2023-07-24 23:25:40.731569
[0m23:25:40.731883 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m23:25:40.735124 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m23:25:40.736751 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m23:25:40.736955 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market) as avg_days_on_market
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m23:25:40.737139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:41.281931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:41.285625 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-24 23:25:40.732038 => 2023-07-24 23:25:41.285538
[0m23:25:41.286076 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m23:25:41.424702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d5de0>]}
[0m23:25:41.425485 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ......... [[32mSUCCESS 1[0m in 0.70s]
[0m23:25:41.426041 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m23:25:41.426492 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m23:25:41.426893 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m23:25:41.427662 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m23:25:41.427953 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m23:25:41.442673 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m23:25:41.443530 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-24 23:25:41.428162 => 2023-07-24 23:25:41.443473
[0m23:25:41.443764 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m23:25:41.457877 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m23:25:41.459060 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m23:25:41.459238 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m23:25:41.459397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:42.498849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:42.512678 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-24 23:25:41.443910 => 2023-07-24 23:25:42.512605
[0m23:25:42.513013 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m23:25:42.643402 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.22s]
[0m23:25:42.644208 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m23:25:42.644716 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m23:25:42.645186 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m23:25:42.646318 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m23:25:42.646694 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m23:25:42.653115 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m23:25:42.653765 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-24 23:25:42.646908 => 2023-07-24 23:25:42.653712
[0m23:25:42.654001 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m23:25:42.656643 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m23:25:42.657520 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m23:25:42.657688 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m23:25:42.657844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:43.129687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m23:25:43.132697 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-24 23:25:42.654148 => 2023-07-24 23:25:43.132586
[0m23:25:43.133206 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m23:25:43.276742 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.63s]
[0m23:25:43.277650 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m23:25:43.278786 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m23:25:43.279838 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m23:25:43.280954 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m23:25:43.281341 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m23:25:43.285155 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m23:25:43.285839 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-24 23:25:43.281594 => 2023-07-24 23:25:43.285773
[0m23:25:43.286103 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m23:25:43.291117 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m23:25:43.292366 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m23:25:43.292567 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- staging table for property_sale_listings, converting timestamps to dates
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m23:25:43.292740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:43.886633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:43.890269 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-24 23:25:43.286259 => 2023-07-24 23:25:43.890188
[0m23:25:43.890693 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m23:25:44.025281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4a8ffb-c051-4aee-a7cc-df16e355877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110625c90>]}
[0m23:25:44.026104 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.74s]
[0m23:25:44.026697 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m23:25:44.027665 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m23:25:44.028206 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m23:25:44.029225 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m23:25:44.029469 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m23:25:44.033456 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m23:25:44.034076 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-24 23:25:44.029613 => 2023-07-24 23:25:44.034024
[0m23:25:44.034273 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m23:25:44.036674 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m23:25:44.037566 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m23:25:44.037742 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m23:25:44.037891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:45.445955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:45.448989 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-24 23:25:44.034399 => 2023-07-24 23:25:45.448889
[0m23:25:45.449375 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m23:25:45.598522 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.57s]
[0m23:25:45.599299 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m23:25:45.599851 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m23:25:45.600281 [info ] [Thread-1 (]: 9 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m23:25:45.601958 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m23:25:45.602447 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m23:25:45.606840 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m23:25:45.607475 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-24 23:25:45.602639 => 2023-07-24 23:25:45.607422
[0m23:25:45.607688 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m23:25:45.610135 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m23:25:45.610970 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m23:25:45.611144 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m23:25:45.611298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:46.119059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:46.122087 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-24 23:25:45.607823 => 2023-07-24 23:25:46.121986
[0m23:25:46.122475 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m23:25:46.298913 [info ] [Thread-1 (]: 9 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.70s]
[0m23:25:46.300179 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m23:25:46.300690 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m23:25:46.301061 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m23:25:46.301707 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m23:25:46.301910 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m23:25:46.307986 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m23:25:46.308584 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-24 23:25:46.302043 => 2023-07-24 23:25:46.308531
[0m23:25:46.308795 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m23:25:46.311306 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m23:25:46.312240 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m23:25:46.312412 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:25:46.312570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:46.950474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m23:25:46.953699 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-24 23:25:46.308925 => 2023-07-24 23:25:46.953583
[0m23:25:46.954172 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m23:25:47.117533 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 0.82s]
[0m23:25:47.118366 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m23:25:47.120403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:25:47.121297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:47.121618 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m23:25:47.121989 [info ] [MainThread]: 
[0m23:25:47.122414 [info ] [MainThread]: Finished running 5 view models, 5 tests in 0 hours 0 minutes and 13.14 seconds (13.14s).
[0m23:25:47.123380 [debug] [MainThread]: Command end result
[0m23:25:47.131986 [info ] [MainThread]: 
[0m23:25:47.132384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:25:47.132663 [info ] [MainThread]: 
[0m23:25:47.132904 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:25:47.133261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111caf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a648e0>]}
[0m23:25:47.133628 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:07:04.717843 | 1a464e71-af69-4c3e-bb61-8237444421d9 ==============================
[0m00:07:04.717843 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:07:04.722559 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:07:04.722834 [debug] [MainThread]: Tracking: tracking
[0m00:07:04.723299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109687730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109684670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109685e70>]}
[0m00:07:04.794801 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:07:04.848459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:07:04.848755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:07:04.849379 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:07:04.856981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af8af0>]}
[0m00:07:04.868242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983b1c0>]}
[0m00:07:04.868709 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:07:04.869075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106312b60>]}
[0m00:07:04.870754 [info ] [MainThread]: 
[0m00:07:04.873039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:04.874522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:07:04.891205 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:07:04.891622 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:07:04.891879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:05.996013 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:07:05.998194 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:07:07.012262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:07:07.021879 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:07:07.022196 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:07:07.022383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:07.702648 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:07:07.705758 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:07:08.316089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b400d0>]}
[0m00:07:08.317437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:08.318018 [info ] [MainThread]: 
[0m00:07:08.323270 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:07:08.323877 [info ] [Thread-1 (]: 1 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m00:07:08.324906 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:07:08.325272 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:07:08.327707 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:07:08.328672 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:07:08.325515 => 2023-07-25 00:07:08.328594
[0m00:07:08.328995 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:07:08.381668 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:07:08.383771 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:07:08.384194 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    -- for this number of beds/baths and iteration_date, show the median price
select distinct num_bedrooms, num_bathrooms, iteration_date, median(price) as median_price
from analytics.dbt_ndw.stg_property_sale_listings
group by num_bedrooms, num_bathrooms, iteration_date
order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
  );
[0m00:07:08.384479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:09.376653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:09.404762 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:07:08.329216 => 2023-07-25 00:07:09.404693
[0m00:07:09.405142 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:07:09.688205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa13ee0>]}
[0m00:07:09.689089 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 1.36s]
[0m00:07:09.691912 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:07:09.692583 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:07:09.693278 [info ] [Thread-1 (]: 2 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:07:09.694267 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:07:09.694584 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:07:09.698313 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:07:09.700415 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:07:09.694781 => 2023-07-25 00:07:09.700305
[0m00:07:09.700783 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:07:09.704876 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:07:09.706258 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:07:09.706523 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m00:07:09.706992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:10.712654 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:10.716489 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:07:09.700971 => 2023-07-25 00:07:10.716404
[0m00:07:10.716942 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:07:10.858998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa4ada0>]}
[0m00:07:10.859771 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 1.17s]
[0m00:07:10.860428 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:07:10.860924 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:07:10.861466 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:07:10.862763 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:07:10.863165 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:07:10.866377 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:07:10.867342 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:07:10.864382 => 2023-07-25 00:07:10.867253
[0m00:07:10.867670 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:07:10.871518 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:07:10.872695 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:07:10.872931 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m00:07:10.873133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:11.527203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:11.530822 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:07:10.867862 => 2023-07-25 00:07:11.530735
[0m00:07:11.531289 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:07:11.684668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4ad450>]}
[0m00:07:11.685441 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.82s]
[0m00:07:11.686175 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:07:11.687165 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:07:11.687984 [info ] [Thread-1 (]: 4 of 10 START sql view model DBT_NDW.price_buckets_days_on_market .............. [RUN]
[0m00:07:11.691469 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:07:11.691836 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:07:11.694001 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:07:11.694626 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:07:11.692037 => 2023-07-25 00:07:11.694566
[0m00:07:11.694883 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:07:11.698605 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:07:11.700500 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:07:11.700719 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market) as avg_days_on_market
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m00:07:11.700915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:12.432308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:12.436179 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:07:11.695055 => 2023-07-25 00:07:12.436089
[0m00:07:12.436984 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:07:12.568740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aae58d0>]}
[0m00:07:12.569546 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ......... [[32mSUCCESS 1[0m in 0.88s]
[0m00:07:12.570286 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:07:12.570906 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:07:12.571282 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:07:12.572374 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:07:12.572907 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:07:12.588159 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:07:12.589012 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:07:12.573168 => 2023-07-25 00:07:12.588938
[0m00:07:12.589361 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:07:12.610344 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:07:12.611626 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:07:12.611886 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:07:12.612105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:13.564646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:13.575001 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:07:12.589610 => 2023-07-25 00:07:13.574909
[0m00:07:13.575387 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:07:13.717887 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.15s]
[0m00:07:13.718662 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:07:13.719205 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:07:13.719700 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:07:13.721273 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:07:13.721826 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:07:13.728289 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:07:13.729128 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:07:13.722485 => 2023-07-25 00:07:13.729052
[0m00:07:13.729424 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:07:13.732811 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:07:13.734059 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:07:13.734295 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:07:13.734494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:14.281999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:14.285006 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:07:13.729607 => 2023-07-25 00:07:14.284887
[0m00:07:14.285521 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:07:14.417272 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.70s]
[0m00:07:14.418076 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:07:14.419476 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:07:14.420219 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:07:14.421314 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:07:14.421611 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:07:14.424332 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:07:14.425128 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:07:14.421766 => 2023-07-25 00:07:14.424965
[0m00:07:14.425459 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:07:14.428965 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:07:14.430495 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:07:14.430993 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- staging table for property_sale_listings, converting timestamps to dates
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:07:14.431442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:14.994631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:14.998011 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:07:14.425609 => 2023-07-25 00:07:14.997935
[0m00:07:14.998380 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:07:15.138516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a464e71-af69-4c3e-bb61-8237444421d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0df60>]}
[0m00:07:15.139321 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.72s]
[0m00:07:15.139814 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:07:15.140710 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:07:15.141000 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:07:15.141737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:07:15.142021 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:07:15.146561 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:07:15.147161 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:07:15.142222 => 2023-07-25 00:07:15.147109
[0m00:07:15.147375 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:07:15.149785 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:07:15.150825 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:07:15.151025 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:07:15.151184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:16.505302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:16.508162 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:07:15.147507 => 2023-07-25 00:07:16.508069
[0m00:07:16.508549 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:07:16.648322 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.51s]
[0m00:07:16.649019 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:07:16.649541 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:07:16.649949 [info ] [Thread-1 (]: 9 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:07:16.651434 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:07:16.652802 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:07:16.656651 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:07:16.657217 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:07:16.653056 => 2023-07-25 00:07:16.657168
[0m00:07:16.657398 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:07:16.660751 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:07:16.661607 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:07:16.661768 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:07:16.661915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:17.733993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:17.737041 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:07:16.657512 => 2023-07-25 00:07:17.736942
[0m00:07:17.737455 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:07:17.868502 [info ] [Thread-1 (]: 9 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.22s]
[0m00:07:17.869338 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:07:17.870087 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:07:17.870487 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m00:07:17.872099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:07:17.872463 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:07:17.879090 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:07:17.879731 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:07:17.872738 => 2023-07-25 00:07:17.879675
[0m00:07:17.879955 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:07:17.882495 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:07:17.883468 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:07:17.883639 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:07:17.883794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:18.806541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:18.809685 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:07:17.880161 => 2023-07-25 00:07:18.809575
[0m00:07:18.810142 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:07:18.946176 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.07s]
[0m00:07:18.946883 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:07:18.948782 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:18.949496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:18.949733 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m00:07:18.950045 [info ] [MainThread]: 
[0m00:07:18.950409 [info ] [MainThread]: Finished running 5 view models, 5 tests in 0 hours 0 minutes and 14.08 seconds (14.08s).
[0m00:07:18.951472 [debug] [MainThread]: Command end result
[0m00:07:18.958632 [info ] [MainThread]: 
[0m00:07:18.958928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:18.959177 [info ] [MainThread]: 
[0m00:07:18.959385 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:07:18.959666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabd570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabf9a0>]}
[0m00:07:18.959891 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:07:34.988609 | 7c9e13c5-da12-4470-ac82-bb7ef6487956 ==============================
[0m00:07:34.988609 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:07:34.992932 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m00:07:34.993245 [debug] [MainThread]: Tracking: tracking
[0m00:07:34.993614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c69cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d397e0>]}
[0m00:07:35.066937 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:07:35.114355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:07:35.114683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:07:35.115334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:07:35.123072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a0b80>]}
[0m00:07:35.132873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee7250>]}
[0m00:07:35.133272 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:07:35.133563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105634a60>]}
[0m00:07:35.134939 [info ] [MainThread]: 
[0m00:07:35.136753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:35.138007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:07:35.153129 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:07:35.153519 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:07:35.153771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:35.903702 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:07:35.906055 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:07:36.031204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:07:36.040401 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:07:36.040696 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:07:36.040881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:36.584629 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:07:36.587472 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:07:36.727739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e6b30>]}
[0m00:07:36.728765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:36.729168 [info ] [MainThread]: 
[0m00:07:36.733485 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:07:36.733853 [info ] [Thread-1 (]: 1 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m00:07:36.734433 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:07:36.734624 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:07:36.736023 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:07:36.736504 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:07:36.734756 => 2023-07-25 00:07:36.736455
[0m00:07:36.736700 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:07:36.763235 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:07:36.764333 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:07:36.764518 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    -- for this number of beds/baths and iteration_date, show the median price
select distinct num_bedrooms, num_bathrooms, iteration_date, median(price) as median_price
from analytics.dbt_ndw.stg_property_sale_listings
group by num_bedrooms, num_bathrooms, iteration_date
order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
  );
[0m00:07:36.764679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:37.426526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:37.446712 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:07:36.736829 => 2023-07-25 00:07:37.446655
[0m00:07:37.447049 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:07:37.570863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdbdf0>]}
[0m00:07:37.571624 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.84s]
[0m00:07:37.574122 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:07:37.574693 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:07:37.575098 [info ] [Thread-1 (]: 2 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:07:37.575759 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:07:37.575970 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:07:37.578541 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:07:37.579394 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:07:37.576110 => 2023-07-25 00:07:37.579335
[0m00:07:37.579612 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:07:37.582540 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:07:37.583677 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:07:37.583854 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m00:07:37.584013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:38.219247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:38.222909 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:07:37.579745 => 2023-07-25 00:07:38.222826
[0m00:07:38.223375 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:07:38.360663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c13ac0>]}
[0m00:07:38.361479 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.79s]
[0m00:07:38.362105 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:07:38.362563 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:07:38.363069 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:07:38.364189 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:07:38.364614 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:07:38.368165 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:07:38.368894 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:07:38.364848 => 2023-07-25 00:07:38.368834
[0m00:07:38.369136 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:07:38.372475 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:07:38.373496 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:07:38.373687 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m00:07:38.373860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:39.267681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:39.271152 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:07:38.369287 => 2023-07-25 00:07:39.271072
[0m00:07:39.271571 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:07:39.400613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf6620>]}
[0m00:07:39.401360 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 1.04s]
[0m00:07:39.402314 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:07:39.404053 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:07:39.405163 [info ] [Thread-1 (]: 4 of 10 START sql view model DBT_NDW.price_buckets_days_on_market .............. [RUN]
[0m00:07:39.406087 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:07:39.406334 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:07:39.408041 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:07:39.408534 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:07:39.406481 => 2023-07-25 00:07:39.408477
[0m00:07:39.408740 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:07:39.411676 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:07:39.413073 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:07:39.413234 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market) as avg_days_on_market
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m00:07:39.413378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:40.024840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:40.029710 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:07:39.408870 => 2023-07-25 00:07:40.029636
[0m00:07:40.030047 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:07:40.160283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cae350>]}
[0m00:07:40.161073 [info ] [Thread-1 (]: 4 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ......... [[32mSUCCESS 1[0m in 0.75s]
[0m00:07:40.161641 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:07:40.162158 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:07:40.162633 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:07:40.163726 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:07:40.164120 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:07:40.176038 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:07:40.176638 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:07:40.164335 => 2023-07-25 00:07:40.176581
[0m00:07:40.176853 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:07:40.190800 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:07:40.191855 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:07:40.192052 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:07:40.192211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:40.644589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:07:40.654813 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:07:40.176987 => 2023-07-25 00:07:40.654740
[0m00:07:40.655121 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:07:40.786778 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.62s]
[0m00:07:40.787553 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:07:40.788005 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:07:40.788418 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:07:40.789347 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:07:40.789719 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:07:40.796031 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:07:40.796626 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:07:40.789947 => 2023-07-25 00:07:40.796570
[0m00:07:40.796844 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:07:40.799263 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:07:40.800094 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:07:40.800254 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:07:40.800402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:41.234462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:07:41.237572 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:07:40.796977 => 2023-07-25 00:07:41.237481
[0m00:07:41.237946 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:07:41.369951 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.58s]
[0m00:07:41.370829 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:07:41.371937 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:07:41.372721 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:07:41.373708 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:07:41.374060 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:07:41.376827 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:07:41.377308 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:07:41.374275 => 2023-07-25 00:07:41.377262
[0m00:07:41.377492 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:07:41.379982 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:07:41.381006 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:07:41.381146 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- staging table for property_sale_listings, converting timestamps to dates
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:07:41.381281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:42.060825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:42.064274 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:07:41.377607 => 2023-07-25 00:07:42.064191
[0m00:07:42.064696 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:07:42.187160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c9e13c5-da12-4470-ac82-bb7ef6487956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10907fd30>]}
[0m00:07:42.187959 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.81s]
[0m00:07:42.188536 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:07:42.189553 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:07:42.189960 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:07:42.191301 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:07:42.191775 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:07:42.196701 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:07:42.197355 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:07:42.192043 => 2023-07-25 00:07:42.197292
[0m00:07:42.197606 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:07:42.200455 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:07:42.201439 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:07:42.201626 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:07:42.201798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:43.220515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:43.222966 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:07:42.197760 => 2023-07-25 00:07:43.222835
[0m00:07:43.223346 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:07:43.361255 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.17s]
[0m00:07:43.362035 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:07:43.362689 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:07:43.363130 [info ] [Thread-1 (]: 9 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:07:43.364412 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:07:43.364881 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:07:43.370938 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:07:43.373630 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:07:43.365155 => 2023-07-25 00:07:43.373544
[0m00:07:43.373957 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:07:43.378941 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:07:43.380129 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:07:43.380370 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:07:43.380586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:44.052387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:44.055461 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:07:43.374144 => 2023-07-25 00:07:44.055288
[0m00:07:44.056075 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:07:44.186335 [info ] [Thread-1 (]: 9 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.82s]
[0m00:07:44.187237 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:07:44.187963 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:07:44.188445 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m00:07:44.189534 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:07:44.189915 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:07:44.196262 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:07:44.196826 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:07:44.190160 => 2023-07-25 00:07:44.196775
[0m00:07:44.197024 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:07:44.199269 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:07:44.200099 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:07:44.200247 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:07:44.200379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:44.816070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:07:44.819131 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:07:44.197142 => 2023-07-25 00:07:44.819028
[0m00:07:44.819541 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:07:44.973622 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 0.78s]
[0m00:07:44.974429 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:07:44.975896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:44.976569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:44.976805 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m00:07:44.977124 [info ] [MainThread]: 
[0m00:07:44.977561 [info ] [MainThread]: Finished running 5 view models, 5 tests in 0 hours 0 minutes and 9.84 seconds (9.84s).
[0m00:07:44.979976 [debug] [MainThread]: Command end result
[0m00:07:44.988304 [info ] [MainThread]: 
[0m00:07:44.988687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:44.988937 [info ] [MainThread]: 
[0m00:07:44.989149 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:07:44.989450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c84d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c87670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c862f0>]}
[0m00:07:44.989684 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:15:08.018679 | 28e9b2f2-ba0f-4a15-8da2-00195afe77fe ==============================
[0m00:15:08.018679 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:15:08.023969 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m00:15:08.024255 [debug] [MainThread]: Tracking: tracking
[0m00:15:08.024729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a14070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141bb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142293c0>]}
[0m00:15:08.099965 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:15:08.162246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:15:08.162835 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/beds_baths_median_price.sql
[0m00:15:08.180828 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/beds_baths_median_price.sql
[0m00:15:08.210916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:15:08.218265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114eef370>]}
[0m00:15:08.228903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e6a530>]}
[0m00:15:08.229899 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:15:08.230575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa2e30>]}
[0m00:15:08.232453 [info ] [MainThread]: 
[0m00:15:08.234975 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:15:08.238849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:15:08.258693 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:15:08.259348 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:15:08.259817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:09.147243 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:15:09.149416 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:15:09.284495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:15:09.292669 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:15:09.292958 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:15:09.293138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:09.898167 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:15:09.901031 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:15:10.045905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141bb760>]}
[0m00:15:10.047153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:15:10.047808 [info ] [MainThread]: 
[0m00:15:10.056568 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:15:10.057127 [info ] [Thread-1 (]: 1 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:15:10.057959 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:15:10.058251 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:15:10.060395 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:15:10.061691 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:15:10.058440 => 2023-07-25 00:15:10.061573
[0m00:15:10.062122 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:15:10.108309 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:15:10.110611 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:15:10.110979 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m00:15:10.111254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:11.074722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:11.094796 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:15:10.062369 => 2023-07-25 00:15:11.094745
[0m00:15:11.095084 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:15:12.373291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a47430>]}
[0m00:15:12.374127 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 2.32s]
[0m00:15:12.377146 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:15:12.377865 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:15:12.378534 [info ] [Thread-1 (]: 2 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:15:12.379687 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:15:12.380007 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:15:12.381844 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:15:12.382787 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:15:12.380161 => 2023-07-25 00:15:12.382713
[0m00:15:12.383046 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:15:12.386132 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:15:12.387056 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:15:12.387236 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m00:15:12.387396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:13.031894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:13.035513 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:15:12.383197 => 2023-07-25 00:15:13.035434
[0m00:15:13.035952 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:15:13.168484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ad5c30>]}
[0m00:15:13.169431 [info ] [Thread-1 (]: 2 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.79s]
[0m00:15:13.170062 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:15:13.170526 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:15:13.171069 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.price_buckets_days_on_market .............. [RUN]
[0m00:15:13.172016 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:15:13.172335 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:15:13.175669 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:15:13.176729 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:15:13.172554 => 2023-07-25 00:15:13.176650
[0m00:15:13.177019 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:15:13.180457 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:15:13.182171 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:15:13.182379 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market) as avg_days_on_market
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m00:15:13.182559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:13.829563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:13.833246 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:15:13.177190 => 2023-07-25 00:15:13.833174
[0m00:15:13.833619 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:15:13.965778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ad64a0>]}
[0m00:15:13.966573 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ......... [[32mSUCCESS 1[0m in 0.79s]
[0m00:15:13.967171 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:15:13.967694 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:15:13.968212 [info ] [Thread-1 (]: 4 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:15:13.969581 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:15:13.969921 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:15:13.981258 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:15:13.981816 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:15:13.970141 => 2023-07-25 00:15:13.981766
[0m00:15:13.982009 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:15:13.995840 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:15:13.996857 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:15:13.997044 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:15:13.997202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:14.727590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:14.737384 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:15:13.982144 => 2023-07-25 00:15:14.737311
[0m00:15:14.737668 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:15:15.736361 [info ] [Thread-1 (]: 4 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.77s]
[0m00:15:15.737278 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:15:15.737797 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:15:15.738118 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:15:15.739295 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:15:15.739785 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:15:15.745378 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:15:15.745926 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:15:15.740019 => 2023-07-25 00:15:15.745878
[0m00:15:15.746112 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:15:15.748245 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:15:15.749000 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:15:15.749149 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:15:15.749279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:16.345802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:16.348629 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:15:15.746227 => 2023-07-25 00:15:16.348537
[0m00:15:16.348996 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:15:16.493755 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.75s]
[0m00:15:16.494453 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:15:16.495271 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:15:16.495904 [info ] [Thread-1 (]: 6 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:15:16.496705 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:15:16.496995 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:15:16.501029 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:15:16.501599 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:15:16.497196 => 2023-07-25 00:15:16.501547
[0m00:15:16.501808 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:15:16.504713 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:15:16.505708 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:15:16.505867 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- staging table for property_sale_listings, converting timestamps to dates
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:15:16.506013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:17.055465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:17.059119 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:15:16.501939 => 2023-07-25 00:15:17.059030
[0m00:15:17.059571 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:15:17.193891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a47040>]}
[0m00:15:17.194652 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.70s]
[0m00:15:17.195173 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:15:17.196173 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:15:17.196604 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:15:17.197732 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:15:17.198076 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:15:17.203536 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:15:17.204156 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:15:17.198374 => 2023-07-25 00:15:17.204102
[0m00:15:17.204367 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:15:17.208122 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:15:17.209250 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:15:17.209412 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:15:17.209556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:18.355916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:18.359066 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:15:17.204501 => 2023-07-25 00:15:18.358946
[0m00:15:18.359545 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:15:18.497475 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.30s]
[0m00:15:18.498349 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:15:18.499026 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:15:18.500351 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:15:18.501366 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:15:18.502035 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:15:18.507426 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:15:18.508319 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:15:18.502289 => 2023-07-25 00:15:18.508214
[0m00:15:18.508632 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:15:18.512046 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:15:18.513185 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:15:18.513419 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:15:18.513619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:19.353985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:19.357138 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:15:18.508819 => 2023-07-25 00:15:19.357018
[0m00:15:19.357630 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:15:19.493392 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.99s]
[0m00:15:19.494318 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:15:19.494843 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:15:19.495318 [info ] [Thread-1 (]: 9 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m00:15:19.496412 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:15:19.497127 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:15:19.506000 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:15:19.506764 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:15:19.497435 => 2023-07-25 00:15:19.506694
[0m00:15:19.507051 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:15:19.510390 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:15:19.511620 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:15:19.511849 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:15:19.512054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:20.507915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:20.511773 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:15:19.507232 => 2023-07-25 00:15:20.511661
[0m00:15:20.512256 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:15:20.718038 [info ] [Thread-1 (]: 9 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 1.22s]
[0m00:15:20.718664 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:15:20.719588 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:15:20.719988 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.beds_baths_median_price .................. [RUN]
[0m00:15:20.720695 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:15:20.720936 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:15:20.724533 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:15:20.725696 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:15:20.721106 => 2023-07-25 00:15:20.725620
[0m00:15:20.725986 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:15:20.730061 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:15:20.731559 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:15:20.731788 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this number of beds/baths and iteration_date, show the median price
    select distinct num_bedrooms, num_bathrooms, iteration_date, median(price) as median_price
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m00:15:20.731990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:21.462785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:15:21.466283 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:15:20.726163 => 2023-07-25 00:15:21.466210
[0m00:15:21.466652 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:15:21.591448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28e9b2f2-ba0f-4a15-8da2-00195afe77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11601ab90>]}
[0m00:15:21.592192 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.beds_baths_median_price ............. [[32mSUCCESS 1[0m in 0.87s]
[0m00:15:21.592712 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:15:21.594548 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:15:21.595405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:21.595651 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.beds_baths_median_price' was properly closed.
[0m00:15:21.595969 [info ] [MainThread]: 
[0m00:15:21.596369 [info ] [MainThread]: Finished running 5 view models, 5 tests in 0 hours 0 minutes and 13.36 seconds (13.36s).
[0m00:15:21.597447 [debug] [MainThread]: Command end result
[0m00:15:21.604599 [info ] [MainThread]: 
[0m00:15:21.604975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:15:21.605310 [info ] [MainThread]: 
[0m00:15:21.605577 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:15:21.605884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11586efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e7fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e6a4d0>]}
[0m00:15:21.606115 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:18:44.371665 | 4cd65f28-936d-4e5d-a392-0596dde4fa17 ==============================
[0m00:18:44.371665 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:18:44.378581 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m00:18:44.379055 [debug] [MainThread]: Tracking: tracking
[0m00:18:44.379725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ab190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109375420>]}
[0m00:18:44.467550 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:18:44.531994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:18:44.532596 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:18:44.532945 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_baths_per_iteration.sql
[0m00:18:44.533252 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/price_buckets_days_on_market.sql
[0m00:18:44.550132 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:18:44.565468 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_baths_per_iteration.sql
[0m00:18:44.568955 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/price_buckets_days_on_market.sql
[0m00:18:44.579344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:18:44.586153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fcc10>]}
[0m00:18:44.598159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f2440>]}
[0m00:18:44.598925 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:18:44.599339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c20a60>]}
[0m00:18:44.601495 [info ] [MainThread]: 
[0m00:18:44.603759 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:18:44.605123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:18:44.623788 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:18:44.624294 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:18:44.624614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:45.697664 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:18:45.699900 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:18:45.837142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:18:45.847961 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:18:45.848260 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:18:45.848448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:46.354837 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:18:46.357548 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:18:46.490946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858b8e0>]}
[0m00:18:46.492017 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:46.492465 [info ] [MainThread]: 
[0m00:18:46.496627 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:18:46.496940 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:18:46.497520 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:18:46.497714 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:18:46.509900 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:18:46.510946 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:18:46.497848 => 2023-07-25 00:18:46.510869
[0m00:18:46.511249 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:18:46.532364 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:18:46.533494 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:18:46.533711 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:18:46.533905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:47.001956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:18:47.011254 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:18:46.511425 => 2023-07-25 00:18:47.011180
[0m00:18:47.011561 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:18:47.141738 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.64s]
[0m00:18:47.144660 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:18:47.145519 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:18:47.145986 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:18:47.146632 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:18:47.146863 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:18:47.151443 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:18:47.152029 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:18:47.146999 => 2023-07-25 00:18:47.151973
[0m00:18:47.152235 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:18:47.154534 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:18:47.155442 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:18:47.155611 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:18:47.155769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:47.587454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:18:47.590341 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:18:47.152368 => 2023-07-25 00:18:47.590247
[0m00:18:47.590723 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:18:47.719038 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.57s]
[0m00:18:47.719915 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:18:47.720998 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:18:47.721780 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:18:47.722782 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:18:47.723146 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:18:47.726937 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:18:47.727528 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:18:47.723362 => 2023-07-25 00:18:47.727474
[0m00:18:47.727748 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:18:47.749663 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:18:47.750804 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:18:47.750979 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- staging table for property_sale_listings, converting timestamps to dates
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:18:47.751143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:48.392583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:18:48.416135 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:18:47.727885 => 2023-07-25 00:18:48.416080
[0m00:18:48.416448 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:18:48.560983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f37f0>]}
[0m00:18:48.561815 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.84s]
[0m00:18:48.562400 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:18:48.563576 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:18:48.564203 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:18:48.565445 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:18:48.565820 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:18:48.570646 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:18:48.571263 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:18:48.566003 => 2023-07-25 00:18:48.571200
[0m00:18:48.571503 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:18:48.574109 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:18:48.575044 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:18:48.575250 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:18:48.575425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:49.797020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:18:49.800351 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:18:48.571659 => 2023-07-25 00:18:49.800234
[0m00:18:49.800835 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:18:49.942056 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.38s]
[0m00:18:49.942849 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:18:49.943339 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:18:49.943751 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:18:49.944820 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:18:49.945185 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:18:49.950274 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:18:49.950956 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:18:49.945394 => 2023-07-25 00:18:49.950897
[0m00:18:49.951199 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:18:49.953956 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:18:49.954861 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:18:49.955050 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:18:49.955221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:50.831964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:18:50.835289 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:18:49.951355 => 2023-07-25 00:18:50.835167
[0m00:18:50.835797 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:18:51.031028 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.09s]
[0m00:18:51.031795 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:18:51.032801 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:18:51.033317 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m00:18:51.034978 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:18:51.035571 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:18:51.044316 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:18:51.045121 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:18:51.035825 => 2023-07-25 00:18:51.045046
[0m00:18:51.045418 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:18:51.048883 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:18:51.050220 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:18:51.050447 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:18:51.050656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:52.103185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:18:52.106421 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:18:51.045609 => 2023-07-25 00:18:52.106301
[0m00:18:52.106936 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:18:52.240883 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 1.21s]
[0m00:18:52.241677 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:18:52.242863 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:18:52.243563 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m00:18:52.244453 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:18:52.244797 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:18:52.248143 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:18:52.248697 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:18:52.245019 => 2023-07-25 00:18:52.248647
[0m00:18:52.248889 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:18:52.252645 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:18:52.253595 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:18:52.253746 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this number of beds/baths and iteration_date, show the median price
    select distinct num_bedrooms, num_bathrooms, iteration_date, median(price) as median_price
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m00:18:52.253883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:52.914503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:18:52.918087 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:18:52.249007 => 2023-07-25 00:18:52.918000
[0m00:18:52.918510 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:18:53.053395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e4d30>]}
[0m00:18:53.054186 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.81s]
[0m00:18:53.054751 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:18:53.055297 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:18:53.055861 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:18:53.057096 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:18:53.057510 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:18:53.061075 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:18:53.062144 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:18:53.057893 => 2023-07-25 00:18:53.062073
[0m00:18:53.062411 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:18:53.066005 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:18:53.067254 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:18:53.067446 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
    select distinct iteration_date, num_bathrooms, count(*) as count
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m00:18:53.067624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:53.741547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:18:53.745218 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:18:53.062566 => 2023-07-25 00:18:53.745127
[0m00:18:53.745679 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:18:53.909209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e4e80>]}
[0m00:18:53.909992 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.85s]
[0m00:18:53.910497 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:18:53.911188 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:18:53.911752 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:18:53.913017 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:18:53.913500 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:18:53.917083 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:18:53.917670 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:18:53.913745 => 2023-07-25 00:18:53.917616
[0m00:18:53.917887 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:18:53.920830 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:18:53.921887 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:18:53.922063 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
    select distinct iteration_date, num_bedrooms, count(*) as count
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
),

select * from final
  );
[0m00:18:53.922222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:54.420783 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01add9f2-0604-ae05-0050-3987000d8082
[0m00:18:54.421089 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 0 unexpected 'select'.
[0m00:18:54.421369 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:18:53.918024 => 2023-07-25 00:18:54.421319
[0m00:18:54.421550 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:18:54.564344 [debug] [Thread-1 (]: Database Error in model distinct_num_bedrooms_per_iteration (models/marts/core/distinct_num_bedrooms_per_iteration.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'select'.
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:18:54.565057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1cbf10>]}
[0m00:18:54.565644 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model DBT_NDW.distinct_num_bedrooms_per_iteration  [[31mERROR[0m in 0.65s]
[0m00:18:54.566211 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:18:54.566669 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:18:54.567235 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m00:18:54.568343 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:18:54.568938 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:18:54.572233 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:18:54.572882 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:18:54.569204 => 2023-07-25 00:18:54.572821
[0m00:18:54.573127 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:18:54.576470 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:18:54.578337 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:18:54.578547 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
    select distinct iteration_date, 
    case
        when price < 200000 then 'price_below_200000'
        when price between 200000 and 230000 then '01_price_in_low_200s'
        when price between 230001 and 250000 then '02_price_between_230001_250000'
        when price between 250001 and 260000 then '03_price_in_250s'
        when price between 260001 and 270000 then '04_price_in_260s'
        when price between 270001 and 280000 then '05_price_in_270s'
        when price between 280001 and 290000 then '06_price_in_280s'
        when price between 290001 and 300000 then '07_price_in_280s'
        when price between 300001 and 310000 then '08_price_in_300-310s'
        when price between 310001 and 310000 then '09_price_in_310s'
        ELSE 'price_above_310'
    end as price_bucket,
    avg(days_on_market) as avg_days_on_market
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m00:18:54.578731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:55.278160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:18:55.281721 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:18:54.573281 => 2023-07-25 00:18:55.281636
[0m00:18:55.282162 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:18:55.424704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd65f28-936d-4e5d-a392-0596dde4fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c9cf0>]}
[0m00:18:55.425509 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.86s]
[0m00:18:55.426229 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:18:55.428339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:18:55.429158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:55.429503 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m00:18:55.429900 [info ] [MainThread]: 
[0m00:18:55.430377 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m00:18:55.431260 [debug] [MainThread]: Command end result
[0m00:18:55.439706 [info ] [MainThread]: 
[0m00:18:55.440128 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:18:55.440405 [info ] [MainThread]: 
[0m00:18:55.440668 [error] [MainThread]: [33mDatabase Error in model distinct_num_bedrooms_per_iteration (models/marts/core/distinct_num_bedrooms_per_iteration.sql)[0m
[0m00:18:55.440919 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m00:18:55.441150 [error] [MainThread]:   syntax error line 16 at position 0 unexpected 'select'.
[0m00:18:55.441384 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:18:55.441617 [info ] [MainThread]: 
[0m00:18:55.441855 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m00:18:55.442189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986ffa0>]}
[0m00:18:55.442450 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:19:10.775963 | b70e6a0a-b915-46e1-8389-82726c27e028 ==============================
[0m00:19:10.775963 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:19:10.780530 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m00:19:10.781083 [debug] [MainThread]: Tracking: tracking
[0m00:19:10.781681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105849cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590ed40>]}
[0m00:19:10.853733 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:19:10.905036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:19:10.905629 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:19:10.921852 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:19:10.942781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:19:10.949346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da2740>]}
[0m00:19:10.959465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584a3e0>]}
[0m00:19:10.959948 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:19:10.960291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9a770>]}
[0m00:19:10.961925 [info ] [MainThread]: 
[0m00:19:10.963950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:10.965357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:19:10.982229 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:19:10.982616 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:19:10.984679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:11.715605 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:19:11.717935 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:19:11.851243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:19:11.861955 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:19:11.862260 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:19:11.862445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:12.384865 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:19:12.387566 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:19:12.541395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584b5e0>]}
[0m00:19:12.542562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:12.543200 [info ] [MainThread]: 
[0m00:19:12.549505 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:19:12.549927 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:19:12.550689 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:19:12.550959 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:19:12.564629 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:19:12.565923 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:19:12.551149 => 2023-07-25 00:19:12.565812
[0m00:19:12.566313 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:19:12.590506 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:19:12.591779 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:19:12.592018 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:19:12.592218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:13.037490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:19:13.047660 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:19:12.566509 => 2023-07-25 00:19:13.047566
[0m00:19:13.048110 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:19:13.173865 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.62s]
[0m00:19:13.176666 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:19:13.177293 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:19:13.177747 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:19:13.178674 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:19:13.179019 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:19:13.184360 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:19:13.184998 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:19:13.179232 => 2023-07-25 00:19:13.184935
[0m00:19:13.185236 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:19:13.187816 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:19:13.188732 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:19:13.188907 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:19:13.189071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:13.722383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:13.725474 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:19:13.185386 => 2023-07-25 00:19:13.725382
[0m00:19:13.725837 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:19:13.855743 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.68s]
[0m00:19:13.856453 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:19:13.857341 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:19:13.858067 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:19:13.859074 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:19:13.859401 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:19:13.862859 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:19:13.863530 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:19:13.859611 => 2023-07-25 00:19:13.863472
[0m00:19:13.863774 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:19:13.889575 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:19:13.890978 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:19:13.891200 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- staging table for property_sale_listings, converting timestamps to dates
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:19:13.891383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:14.531737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:14.551992 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:19:13.863924 => 2023-07-25 00:19:14.551935
[0m00:19:14.552284 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:19:14.692512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068506d0>]}
[0m00:19:14.693289 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.83s]
[0m00:19:14.693852 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:19:14.694850 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:19:14.695300 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:19:14.696284 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:19:14.696660 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:19:14.701424 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:19:14.701980 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:19:14.696892 => 2023-07-25 00:19:14.701927
[0m00:19:14.702185 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:19:14.704386 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:19:14.705134 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:19:14.705296 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:19:14.705439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:15.609358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:15.612275 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:19:14.702312 => 2023-07-25 00:19:15.612183
[0m00:19:15.612652 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:19:15.762800 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.07s]
[0m00:19:15.763600 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:19:15.764196 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:19:15.764637 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:19:15.765815 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:19:15.766203 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:19:15.772379 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:19:15.773007 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:19:15.766440 => 2023-07-25 00:19:15.772951
[0m00:19:15.773216 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:19:15.775659 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:19:15.776500 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:19:15.776659 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:19:15.776807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:16.301013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:16.304469 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:19:15.773344 => 2023-07-25 00:19:16.304355
[0m00:19:16.304924 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:19:16.434744 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.67s]
[0m00:19:16.435618 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:19:16.436122 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:19:16.436574 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m00:19:16.437660 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:19:16.438038 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:19:16.448105 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:19:16.448997 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:19:16.438254 => 2023-07-25 00:19:16.448915
[0m00:19:16.449307 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:19:16.453397 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:19:16.455660 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:19:16.455979 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:19:16.456214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:17.118076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:17.120910 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:19:16.449484 => 2023-07-25 00:19:17.120815
[0m00:19:17.121270 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:19:17.263179 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 0.83s]
[0m00:19:17.263930 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:19:17.264847 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:19:17.265901 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m00:19:17.267554 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:19:17.267809 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:19:17.270250 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:19:17.270721 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:19:17.267942 => 2023-07-25 00:19:17.270675
[0m00:19:17.270902 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:19:17.274901 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:19:17.275995 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:19:17.276176 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this number of beds/baths and iteration_date, show the median price
    select distinct num_bedrooms, num_bathrooms, iteration_date, median(price) as median_price
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m00:19:17.276328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:17.908229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:17.911800 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:19:17.271016 => 2023-07-25 00:19:17.911716
[0m00:19:17.912227 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:19:18.052495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e27a60>]}
[0m00:19:18.053408 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.79s]
[0m00:19:18.053955 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:19:18.054481 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:19:18.054980 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:19:18.055917 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:19:18.056217 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:19:18.058841 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:19:18.059383 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:19:18.056367 => 2023-07-25 00:19:18.059335
[0m00:19:18.059574 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:19:18.062307 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:19:18.063265 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:19:18.063432 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
    select distinct iteration_date, num_bathrooms, count(*) as count
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m00:19:18.063585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:18.623203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:18.626862 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:19:18.059699 => 2023-07-25 00:19:18.626771
[0m00:19:18.627333 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:19:18.769205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e277c0>]}
[0m00:19:18.770026 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.71s]
[0m00:19:18.770632 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:19:18.771154 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:19:18.771709 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:19:18.772631 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:19:18.772987 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:19:18.776898 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:19:18.777719 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:19:18.773208 => 2023-07-25 00:19:18.777649
[0m00:19:18.778013 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:19:18.781975 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:19:18.783305 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:19:18.783527 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
    select distinct iteration_date, num_bedrooms, count(*) as count
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m00:19:18.783730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:19.490930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:19.494494 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:19:18.778194 => 2023-07-25 00:19:19.494408
[0m00:19:19.495017 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:19:19.630866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e224a0>]}
[0m00:19:19.631656 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.86s]
[0m00:19:19.632218 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:19:19.632789 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:19:19.633378 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m00:19:19.634587 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:19:19.634971 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:19:19.638463 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:19:19.639139 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:19:19.635190 => 2023-07-25 00:19:19.639075
[0m00:19:19.639391 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:19:19.642857 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:19:19.644760 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:19:19.644962 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
    select distinct iteration_date, 
    case
        when price < 200000 then 'price_below_200000'
        when price between 200000 and 230000 then '01_price_in_low_200s'
        when price between 230001 and 250000 then '02_price_between_230001_250000'
        when price between 250001 and 260000 then '03_price_in_250s'
        when price between 260001 and 270000 then '04_price_in_260s'
        when price between 270001 and 280000 then '05_price_in_270s'
        when price between 280001 and 290000 then '06_price_in_280s'
        when price between 290001 and 300000 then '07_price_in_280s'
        when price between 300001 and 310000 then '08_price_in_300-310s'
        when price between 310001 and 310000 then '09_price_in_310s'
        ELSE 'price_above_310'
    end as price_bucket,
    avg(days_on_market) as avg_days_on_market
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m00:19:19.645139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:20.210039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:19:20.213815 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:19:19.639548 => 2023-07-25 00:19:20.213684
[0m00:19:20.214314 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:19:20.338655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70e6a0a-b915-46e1-8389-82726c27e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106712770>]}
[0m00:19:20.339485 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.70s]
[0m00:19:20.340081 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:19:20.342126 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:20.343516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:20.343785 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m00:19:20.344030 [info ] [MainThread]: 
[0m00:19:20.344284 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 9.38 seconds (9.38s).
[0m00:19:20.344898 [debug] [MainThread]: Command end result
[0m00:19:20.352433 [info ] [MainThread]: 
[0m00:19:20.352783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:20.353019 [info ] [MainThread]: 
[0m00:19:20.353226 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:19:20.353504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058499c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f7790>]}
[0m00:19:20.353723 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:35:30.530051 | 83cd8718-4be8-42b5-90ac-a79fb4072813 ==============================
[0m00:35:30.530051 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:35:30.535275 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:35:30.535565 [debug] [MainThread]: Tracking: tracking
[0m00:35:30.536249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1a770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c45c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c45480>]}
[0m00:35:30.606409 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:35:30.663759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m00:35:30.664384 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m00:35:30.664730 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/beds_baths_median_price.sql
[0m00:35:30.665027 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_baths_per_iteration.sql
[0m00:35:30.665314 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:35:30.665601 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/price_buckets_days_on_market.sql
[0m00:35:30.681647 [debug] [MainThread]: 1699: static parser successfully parsed staging/property_sale_listings/stg_property_sale_listings.sql
[0m00:35:30.697585 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/beds_baths_median_price.sql
[0m00:35:30.701019 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_baths_per_iteration.sql
[0m00:35:30.704067 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:35:30.708181 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/price_buckets_days_on_market.sql
[0m00:35:30.745990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:35:30.753796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088af430>]}
[0m00:35:30.764529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbe3b0>]}
[0m00:35:30.765022 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:35:30.765377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6e800>]}
[0m00:35:30.767135 [info ] [MainThread]: 
[0m00:35:30.769281 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:35:30.770688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:35:30.787927 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:35:30.788335 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:35:30.788591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:31.537708 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:35:31.539912 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:35:31.681991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:35:31.690933 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:35:31.691282 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:35:31.691500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:35:32.277039 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:35:32.280117 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:35:32.418185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ad000>]}
[0m00:35:32.419368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:35:32.419814 [info ] [MainThread]: 
[0m00:35:32.424265 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:35:32.424644 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:35:32.425419 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:35:32.425678 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:35:32.441307 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:35:32.442684 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:35:32.425855 => 2023-07-25 00:35:32.442605
[0m00:35:32.443015 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:35:32.468407 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:35:32.469881 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:35:32.470175 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:35:32.470429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:33.034292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:33.044360 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:35:32.443235 => 2023-07-25 00:35:33.044275
[0m00:35:33.044725 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:35:33.185270 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.76s]
[0m00:35:33.188364 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:35:33.189039 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:35:33.189522 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:35:33.190585 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:35:33.190968 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:35:33.197386 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:35:33.198169 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:35:33.191176 => 2023-07-25 00:35:33.198092
[0m00:35:33.198496 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:35:33.201744 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:35:33.203115 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:35:33.203411 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:35:33.203979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:33.665147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:35:33.668515 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:35:33.198675 => 2023-07-25 00:35:33.668393
[0m00:35:33.671538 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:35:33.799530 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.61s]
[0m00:35:33.800258 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:35:33.801030 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:35:33.801754 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:35:33.802781 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:35:33.803090 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:35:33.806659 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:35:33.807568 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:35:33.803426 => 2023-07-25 00:35:33.807492
[0m00:35:33.807854 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:35:33.834693 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:35:33.836259 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:35:33.836471 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (
    select * from raw.realty_mole_property_api.property_sale_listings
),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    -- address of the home in id form
    id,
    -- convert timestamp to date
    date(listeddate) as listed_date,
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:35:33.836655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:34.447294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:34.469276 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:35:33.808014 => 2023-07-25 00:35:34.469214
[0m00:35:34.469605 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:35:34.615091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921d000>]}
[0m00:35:34.615898 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.81s]
[0m00:35:34.616394 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:35:34.617417 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:35:34.617822 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:35:34.618840 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:35:34.619157 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:35:34.626116 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:35:34.626777 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:35:34.619367 => 2023-07-25 00:35:34.626719
[0m00:35:34.627024 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:35:34.629676 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:35:34.631778 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:35:34.631964 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:35:34.632135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:35.731392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:35.734646 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:35:34.627178 => 2023-07-25 00:35:35.734530
[0m00:35:35.735114 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:35:35.879385 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.26s]
[0m00:35:35.880520 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:35:35.881082 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:35:35.881589 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:35:35.882658 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:35:35.882943 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:35:35.886961 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:35:35.887517 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:35:35.883087 => 2023-07-25 00:35:35.887466
[0m00:35:35.887720 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:35:35.890123 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:35:35.890928 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:35:35.891088 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:35:35.891235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:36.355394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:35:36.358423 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:35:35.887846 => 2023-07-25 00:35:36.358318
[0m00:35:36.358842 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:35:36.490824 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.61s]
[0m00:35:36.491513 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:35:36.491912 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:35:36.492308 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m00:35:36.493130 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:35:36.493471 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:35:36.502441 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:35:36.502990 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:35:36.493675 => 2023-07-25 00:35:36.502936
[0m00:35:36.503205 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:35:36.505735 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:35:36.506761 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:35:36.506974 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:35:36.507148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:37.373726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:37.376686 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:35:36.503338 => 2023-07-25 00:35:37.376574
[0m00:35:37.377126 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:35:37.508817 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 1.02s]
[0m00:35:37.509724 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:35:37.511646 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:35:37.512310 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m00:35:37.513289 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:35:37.513661 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:35:37.517021 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:35:37.517637 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:35:37.513877 => 2023-07-25 00:35:37.517583
[0m00:35:37.517851 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:35:37.520787 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:35:37.521965 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:35:37.522152 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct num_bedrooms, num_bathrooms, iteration_date, 
    median(price) as median_price
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m00:35:37.522330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:38.171019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:38.175714 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:35:37.517985 => 2023-07-25 00:35:38.175628
[0m00:35:38.176157 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:35:38.306985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108affe50>]}
[0m00:35:38.307752 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.79s]
[0m00:35:38.308261 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:35:38.308711 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:35:38.309218 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:35:38.310197 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:35:38.310544 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:35:38.315301 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:35:38.315991 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:35:38.310753 => 2023-07-25 00:35:38.315929
[0m00:35:38.316243 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:35:38.321033 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:35:38.322245 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:35:38.322437 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct iteration_date, num_bathrooms, count(*) as count
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m00:35:38.322612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:39.010038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:39.014014 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:35:38.316400 => 2023-07-25 00:35:39.013921
[0m00:35:39.014470 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:35:39.155490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb86a0>]}
[0m00:35:39.156495 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.85s]
[0m00:35:39.157499 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:35:39.158327 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:35:39.159358 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:35:39.160335 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:35:39.160730 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:35:39.163917 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:35:39.164565 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:35:39.160949 => 2023-07-25 00:35:39.164505
[0m00:35:39.164802 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:35:39.168188 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:35:39.169386 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:35:39.169573 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct iteration_date, num_bedrooms, count(*) as count
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m00:35:39.169742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:39.929896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:39.933878 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:35:39.164948 => 2023-07-25 00:35:39.933786
[0m00:35:39.934374 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:35:40.076216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb9300>]}
[0m00:35:40.077019 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.92s]
[0m00:35:40.077642 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:35:40.078098 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:35:40.078719 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m00:35:40.079741 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:35:40.080123 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:35:40.083376 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:35:40.084362 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:35:40.080710 => 2023-07-25 00:35:40.084293
[0m00:35:40.084607 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:35:40.087605 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:35:40.089484 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:35:40.089657 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct iteration_date, 
    case
        when price < 200000 then 'price_below_200000'
        when price between 200000 and 230000 then '01_price_in_low_200s'
        when price between 230001 and 250000 then '02_price_between_230001_250000'
        when price between 250001 and 260000 then '03_price_in_250s'
        when price between 260001 and 270000 then '04_price_in_260s'
        when price between 270001 and 280000 then '05_price_in_270s'
        when price between 280001 and 290000 then '06_price_in_280s'
        when price between 290001 and 300000 then '07_price_in_280s'
        when price between 300001 and 310000 then '08_price_in_300-310s'
        when price between 310001 and 310000 then '09_price_in_310s'
        ELSE 'price_above_310'
    end as price_bucket,
    avg(days_on_market) as avg_days_on_market
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m00:35:40.089811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:40.682369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:40.685801 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:35:40.084744 => 2023-07-25 00:35:40.685705
[0m00:35:40.686290 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:35:40.818053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cd8718-4be8-42b5-90ac-a79fb4072813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928b8e0>]}
[0m00:35:40.818828 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.74s]
[0m00:35:40.819448 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:35:40.821437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:35:40.822255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:35:40.822534 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m00:35:40.822867 [info ] [MainThread]: 
[0m00:35:40.823286 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 10.06 seconds (10.06s).
[0m00:35:40.824253 [debug] [MainThread]: Command end result
[0m00:35:40.831833 [info ] [MainThread]: 
[0m00:35:40.832218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:35:40.832467 [info ] [MainThread]: 
[0m00:35:40.832681 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:35:40.832982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10900b430>]}
[0m00:35:40.833211 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:35:47.432653 | 0f77ea03-af76-4518-a974-d9427e2f3288 ==============================
[0m00:35:47.432653 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:35:47.438632 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m00:35:47.439000 [debug] [MainThread]: Tracking: tracking
[0m00:35:47.439457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986a770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109931c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109930ac0>]}
[0m00:35:47.520499 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:35:47.577374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:35:47.577720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:35:47.578444 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:35:47.588657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da8c10>]}
[0m00:35:47.599538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aef2e0>]}
[0m00:35:47.600016 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:35:47.600375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbaef0>]}
[0m00:35:47.602032 [info ] [MainThread]: 
[0m00:35:47.604101 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:35:47.605482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:35:47.625547 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:35:47.625970 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:35:47.626232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:48.388405 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:35:48.390723 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:35:48.553290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:35:48.563849 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:35:48.564192 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:35:48.564411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:35:49.303039 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:35:49.305939 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:35:49.470359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109deeb30>]}
[0m00:35:49.471534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:35:49.471928 [info ] [MainThread]: 
[0m00:35:49.476768 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:35:49.477390 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:35:49.478342 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:35:49.478662 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:35:49.494287 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:35:49.495168 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:35:49.478870 => 2023-07-25 00:35:49.495096
[0m00:35:49.495469 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:35:49.520795 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:35:49.522102 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:35:49.522356 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:35:49.522576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:49.985441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:35:49.995758 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:35:49.495658 => 2023-07-25 00:35:49.995682
[0m00:35:49.996060 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:35:50.130579 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.65s]
[0m00:35:50.133441 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:35:50.134090 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:35:50.134497 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:35:50.135408 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:35:50.135779 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:35:50.141610 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:35:50.142172 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:35:50.135990 => 2023-07-25 00:35:50.142122
[0m00:35:50.142363 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:35:50.144414 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:35:50.145170 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:35:50.145316 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:35:50.145449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:50.651586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:50.654579 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:35:50.142483 => 2023-07-25 00:35:50.654470
[0m00:35:50.655044 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:35:50.786440 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.65s]
[0m00:35:50.787340 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:35:50.788219 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:35:50.788769 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:35:50.789703 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:35:50.790022 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:35:50.792989 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:35:50.793490 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:35:50.790165 => 2023-07-25 00:35:50.793445
[0m00:35:50.793686 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:35:50.815338 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:35:50.817523 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:35:50.817708 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (
    select * from raw.realty_mole_property_api.property_sale_listings
),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    -- address of the home in id form
    id,
    -- convert timestamp to date
    date(listeddate) as listed_date,
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:35:50.817866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:51.530061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:51.549872 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:35:50.793813 => 2023-07-25 00:35:51.549817
[0m00:35:51.550167 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:35:51.691770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a870130>]}
[0m00:35:51.692577 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.90s]
[0m00:35:51.693124 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:35:51.694145 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:35:51.694597 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:35:51.695724 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:35:51.696090 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:35:51.701673 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:35:51.702236 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:35:51.697663 => 2023-07-25 00:35:51.702183
[0m00:35:51.702449 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:35:51.705938 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:35:51.706794 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:35:51.706962 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:35:51.707113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:52.325772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:52.328711 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:35:51.702586 => 2023-07-25 00:35:52.328608
[0m00:35:52.329153 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:35:52.454432 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 0.76s]
[0m00:35:52.455159 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:35:52.455577 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:35:52.455993 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:35:52.456902 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:35:52.457324 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:35:52.462829 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:35:52.463455 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:35:52.457567 => 2023-07-25 00:35:52.463398
[0m00:35:52.463689 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:35:52.466342 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:35:52.467187 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:35:52.467372 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:35:52.467542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:52.956023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m00:35:52.958972 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:35:52.463838 => 2023-07-25 00:35:52.958880
[0m00:35:52.959342 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:35:53.114124 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.66s]
[0m00:35:53.114911 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:35:53.115401 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:35:53.115879 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m00:35:53.117050 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:35:53.117467 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:35:53.124295 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:35:53.124858 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:35:53.117698 => 2023-07-25 00:35:53.124807
[0m00:35:53.125061 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:35:53.127524 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:35:53.128478 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:35:53.128649 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:35:53.128810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:56.108599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3 seconds
[0m00:35:56.112904 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:35:53.125191 => 2023-07-25 00:35:56.112802
[0m00:35:56.113325 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:35:56.237543 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 3.12s]
[0m00:35:56.238338 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:35:56.239539 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:35:56.240326 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m00:35:56.241307 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:35:56.241713 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:35:56.244636 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:35:56.245216 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:35:56.242230 => 2023-07-25 00:35:56.245166
[0m00:35:56.245409 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:35:56.248045 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:35:56.249010 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:35:56.249154 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct num_bedrooms, num_bathrooms, iteration_date, 
    median(price) as median_price
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m00:35:56.249286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:56.827554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:56.831199 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:35:56.245530 => 2023-07-25 00:35:56.831118
[0m00:35:56.831648 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:35:56.964045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7560b0>]}
[0m00:35:56.964784 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.72s]
[0m00:35:56.965305 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:35:56.965703 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:35:56.966153 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:35:56.967013 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:35:56.967320 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:35:56.970957 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:35:56.971612 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:35:56.967539 => 2023-07-25 00:35:56.971553
[0m00:35:56.971858 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:35:56.975217 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:35:56.976451 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:35:56.976642 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct iteration_date, num_bathrooms, count(*) as count
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m00:35:56.976823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:57.574880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:57.578473 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:35:56.972020 => 2023-07-25 00:35:57.578396
[0m00:35:57.578838 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:35:57.703702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac93af0>]}
[0m00:35:57.704490 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.74s]
[0m00:35:57.705154 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:35:57.705711 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:35:57.706812 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:35:57.707750 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:35:57.708009 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:35:57.710672 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:35:57.711200 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:35:57.708171 => 2023-07-25 00:35:57.711147
[0m00:35:57.711398 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:35:57.715598 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:35:57.716690 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:35:57.716865 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct iteration_date, num_bedrooms, count(*) as count
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m00:35:57.717021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:58.283944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:58.288321 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:35:57.711526 => 2023-07-25 00:35:58.288205
[0m00:35:58.288852 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:35:58.421615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8aa710>]}
[0m00:35:58.422437 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.71s]
[0m00:35:58.422994 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:35:58.423510 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:35:58.424044 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m00:35:58.425101 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:35:58.425499 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:35:58.428576 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:35:58.429194 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:35:58.425745 => 2023-07-25 00:35:58.429142
[0m00:35:58.429403 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:35:58.432247 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:35:58.433714 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:35:58.433881 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct iteration_date, 
    case
        when price < 200000 then 'price_below_200000'
        when price between 200000 and 230000 then '01_price_in_low_200s'
        when price between 230001 and 250000 then '02_price_between_230001_250000'
        when price between 250001 and 260000 then '03_price_in_250s'
        when price between 260001 and 270000 then '04_price_in_260s'
        when price between 270001 and 280000 then '05_price_in_270s'
        when price between 280001 and 290000 then '06_price_in_280s'
        when price between 290001 and 300000 then '07_price_in_280s'
        when price between 300001 and 310000 then '08_price_in_300-310s'
        when price between 310001 and 310000 then '09_price_in_310s'
        ELSE 'price_above_310'
    end as price_bucket,
    avg(days_on_market) as avg_days_on_market
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m00:35:58.434022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:35:59.044117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:35:59.047826 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:35:58.429535 => 2023-07-25 00:35:59.047740
[0m00:35:59.048300 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:35:59.173234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f77ea03-af76-4518-a974-d9427e2f3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a8430>]}
[0m00:35:59.174114 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.75s]
[0m00:35:59.174757 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:35:59.176531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:35:59.177343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:35:59.177576 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m00:35:59.177863 [info ] [MainThread]: 
[0m00:35:59.178193 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 11.58 seconds (11.58s).
[0m00:35:59.179172 [debug] [MainThread]: Command end result
[0m00:35:59.189905 [info ] [MainThread]: 
[0m00:35:59.190381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:35:59.190702 [info ] [MainThread]: 
[0m00:35:59.190979 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:35:59.191354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8770a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a874790>]}
[0m00:35:59.191646 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:53:35.912059 | 9d4a69c9-a105-47f8-af9e-efea3a162165 ==============================
[0m00:53:35.912059 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:53:35.917532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:53:35.917852 [debug] [MainThread]: Tracking: tracking
[0m00:53:35.918570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e86f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f55c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f55bd0>]}
[0m00:53:35.991211 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:53:36.051306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m00:53:36.051906 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_baths_per_iteration.sql
[0m00:53:36.052265 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:53:36.052606 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m00:53:36.052905 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/price_buckets_days_on_market.sql
[0m00:53:36.053199 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/beds_baths_median_price.sql
[0m00:53:36.069700 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_baths_per_iteration.sql
[0m00:53:36.085012 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_bedrooms_per_iteration.sql
[0m00:53:36.088278 [debug] [MainThread]: 1699: static parser successfully parsed staging/property_sale_listings/stg_property_sale_listings.sql
[0m00:53:36.091578 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/price_buckets_days_on_market.sql
[0m00:53:36.095676 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/beds_baths_median_price.sql
[0m00:53:36.143309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:53:36.152414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073de1a0>]}
[0m00:53:36.165052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d2560>]}
[0m00:53:36.165650 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:53:36.166082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061da7d0>]}
[0m00:53:36.168269 [info ] [MainThread]: 
[0m00:53:36.170947 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:53:36.172627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:53:36.194121 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:53:36.194625 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:53:36.194940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:37.082955 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:53:37.085199 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:53:37.253956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:53:37.261946 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:53:37.262252 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:53:37.262439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:53:37.998742 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:53:38.001461 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:53:38.176411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061669e0>]}
[0m00:53:38.177510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:53:38.177903 [info ] [MainThread]: 
[0m00:53:38.184515 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:53:38.184827 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:53:38.185399 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:53:38.185587 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:53:38.197238 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:53:38.198248 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:53:38.185723 => 2023-07-25 00:53:38.198169
[0m00:53:38.198529 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:53:38.217429 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:53:38.218524 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:53:38.218729 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:53:38.218908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:39.145916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:39.156223 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:53:38.198682 => 2023-07-25 00:53:39.156134
[0m00:53:39.156579 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:53:39.385419 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.20s]
[0m00:53:39.388677 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:53:39.389544 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:53:39.390019 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:53:39.390904 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:53:39.391151 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:53:39.396388 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:53:39.397002 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:53:39.391309 => 2023-07-25 00:53:39.396944
[0m00:53:39.397236 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:53:39.399891 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:53:39.402216 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:53:39.402442 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:53:39.402629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:40.002820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:40.005837 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:53:39.397386 => 2023-07-25 00:53:40.005732
[0m00:53:40.006279 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:53:40.260859 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.87s]
[0m00:53:40.261593 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:53:40.262505 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:53:40.263398 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:53:40.264878 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:53:40.265424 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:53:40.269156 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:53:40.269761 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:53:40.266171 => 2023-07-25 00:53:40.269706
[0m00:53:40.269976 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:53:40.292709 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:53:40.294092 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:53:40.294282 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:53:40.294448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:41.048080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:41.068178 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:53:40.270121 => 2023-07-25 00:53:41.068127
[0m00:53:41.068464 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:53:41.338686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e78e80>]}
[0m00:53:41.339493 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 1.07s]
[0m00:53:41.340159 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:53:41.341201 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:53:41.341762 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:53:41.342689 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:53:41.343011 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:53:41.347954 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:53:41.348539 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:53:41.343220 => 2023-07-25 00:53:41.348486
[0m00:53:41.348750 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:53:41.351030 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:53:41.351849 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:53:41.352014 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:53:41.352166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:42.641474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:42.644760 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:53:41.348882 => 2023-07-25 00:53:42.644639
[0m00:53:42.645268 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:53:42.827954 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.49s]
[0m00:53:42.828638 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:53:42.829136 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:53:42.829542 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:53:42.830729 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:53:42.831814 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:53:42.835898 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:53:42.836433 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:53:42.832000 => 2023-07-25 00:53:42.836382
[0m00:53:42.836631 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:53:42.838962 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:53:42.839690 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:53:42.839841 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:53:42.839985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:43.704111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:43.707122 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:53:42.836755 => 2023-07-25 00:53:43.707010
[0m00:53:43.707570 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:53:43.886351 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.06s]
[0m00:53:43.887212 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:53:43.887845 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:53:43.889146 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m00:53:43.890127 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:53:43.890467 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:53:43.897931 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:53:43.898503 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:53:43.890683 => 2023-07-25 00:53:43.898453
[0m00:53:43.898697 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:53:43.901144 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:53:43.902110 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:53:43.902282 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:53:43.902437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:44.520875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:44.524066 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:53:43.898821 => 2023-07-25 00:53:44.523951
[0m00:53:44.524545 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:53:44.663347 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 0.77s]
[0m00:53:44.664067 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:53:44.665055 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:53:44.665697 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m00:53:44.666617 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:53:44.666935 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:53:44.671231 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:53:44.672298 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:53:44.667139 => 2023-07-25 00:53:44.672203
[0m00:53:44.672635 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:53:44.676677 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:53:44.678131 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:53:44.678368 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m00:53:44.678586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:45.348550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:45.352094 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:53:44.672834 => 2023-07-25 00:53:45.352010
[0m00:53:45.352507 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:53:45.529749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070eae30>]}
[0m00:53:45.530548 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.86s]
[0m00:53:45.531100 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:53:45.531601 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:53:45.532114 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:53:45.533219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:53:45.533598 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:53:45.537563 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:53:45.538295 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:53:45.534065 => 2023-07-25 00:53:45.538225
[0m00:53:45.538582 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:53:45.543972 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:53:45.545418 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:53:45.545656 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m00:53:45.545858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:46.316262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:46.320367 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:53:45.538760 => 2023-07-25 00:53:46.320277
[0m00:53:46.321058 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:53:46.526268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831f340>]}
[0m00:53:46.527150 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.99s]
[0m00:53:46.527849 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:53:46.528400 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:53:46.529073 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:53:46.530709 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:53:46.531086 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:53:46.535553 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:53:46.536662 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:53:46.531244 => 2023-07-25 00:53:46.536503
[0m00:53:46.537219 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:53:46.541903 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:53:46.543183 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:53:46.543387 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m00:53:46.543547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:47.485664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:47.489098 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:53:46.537506 => 2023-07-25 00:53:47.489015
[0m00:53:47.489489 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:53:47.715628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831c160>]}
[0m00:53:47.716549 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 1.19s]
[0m00:53:47.717081 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:53:47.717663 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:53:47.718093 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m00:53:47.719078 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:53:47.719544 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:53:47.723289 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:53:47.723957 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:53:47.719758 => 2023-07-25 00:53:47.723894
[0m00:53:47.724273 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:53:47.727874 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:53:47.730242 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:53:47.730508 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

final as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct 
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        avg(days_on_market) as avg_days_on_market
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m00:53:47.730696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:48.556088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:53:48.559636 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:53:47.724486 => 2023-07-25 00:53:48.559555
[0m00:53:48.560059 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:53:48.737649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4a69c9-a105-47f8-af9e-efea3a162165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083179d0>]}
[0m00:53:48.738382 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 1.02s]
[0m00:53:48.738871 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:53:48.740676 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:53:48.741407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:48.741645 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m00:53:48.745281 [info ] [MainThread]: 
[0m00:53:48.745661 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 12.57 seconds (12.57s).
[0m00:53:48.746275 [debug] [MainThread]: Command end result
[0m00:53:48.753862 [info ] [MainThread]: 
[0m00:53:48.754264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:53:48.754511 [info ] [MainThread]: 
[0m00:53:48.754724 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:53:48.755015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061da7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d2260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106167b80>]}
[0m00:53:48.755243 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 00:53:59.105065 | f41c7363-8170-4b21-b1c4-f75fb6ccee1b ==============================
[0m00:53:59.105065 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:53:59.109312 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m00:53:59.110135 [debug] [MainThread]: Tracking: tracking
[0m00:53:59.110631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102bb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032ad40>]}
[0m00:53:59.182692 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:53:59.232058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:59.232368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:59.233028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:53:59.240654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110948b80>]}
[0m00:53:59.251028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104eb250>]}
[0m00:53:59.251510 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:53:59.251870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103490a60>]}
[0m00:53:59.253565 [info ] [MainThread]: 
[0m00:53:59.255731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:53:59.257119 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m00:53:59.274893 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m00:53:59.275272 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m00:53:59.275503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:00.133397 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m00:54:00.135706 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m00:54:00.398717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:54:00.408817 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:54:00.409152 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:54:00.409364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:01.077523 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m00:54:01.080135 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:54:01.342516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11098aad0>]}
[0m00:54:01.343900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:54:01.344628 [info ] [MainThread]: 
[0m00:54:01.348247 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:54:01.348540 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m00:54:01.349081 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:54:01.349258 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:54:01.360551 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:54:01.361348 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 00:54:01.349383 => 2023-07-25 00:54:01.361289
[0m00:54:01.361579 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:54:01.379228 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:54:01.381281 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:54:01.381487 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m00:54:01.381652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:01.911406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:01.920752 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 00:54:01.361718 => 2023-07-25 00:54:01.920672
[0m00:54:01.921100 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m00:54:02.172807 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.82s]
[0m00:54:02.175400 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:54:02.176034 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:54:02.176512 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m00:54:02.178010 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:54:02.178286 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:54:02.184052 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:54:02.184720 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 00:54:02.178433 => 2023-07-25 00:54:02.184650
[0m00:54:02.184985 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:54:02.187686 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:54:02.188687 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:54:02.188876 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m00:54:02.189053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:02.736789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:02.739680 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 00:54:02.185141 => 2023-07-25 00:54:02.739584
[0m00:54:02.740058 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m00:54:02.908093 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.73s]
[0m00:54:02.908821 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:54:02.909811 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:54:02.910594 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m00:54:02.911663 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:54:02.912101 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:54:02.915735 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:54:02.916309 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 00:54:02.912371 => 2023-07-25 00:54:02.916255
[0m00:54:02.916529 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:54:02.939395 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:54:02.940742 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:54:02.940937 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m00:54:02.941103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:03.622807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:03.643086 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 00:54:02.916667 => 2023-07-25 00:54:03.643032
[0m00:54:03.643396 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m00:54:03.816707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c23e0>]}
[0m00:54:03.817535 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.91s]
[0m00:54:03.818221 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:54:03.819431 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:54:03.819955 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m00:54:03.820800 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:54:03.821040 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:54:03.825239 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:54:03.825772 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 00:54:03.821186 => 2023-07-25 00:54:03.825721
[0m00:54:03.825978 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:54:03.829525 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:54:03.830384 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:54:03.830548 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m00:54:03.830699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:04.850810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:04.853914 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 00:54:03.826108 => 2023-07-25 00:54:04.853796
[0m00:54:04.854388 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m00:54:05.118550 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.30s]
[0m00:54:05.119302 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:54:05.119852 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:54:05.120275 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m00:54:05.121547 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:54:05.121938 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:54:05.125942 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:54:05.126475 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 00:54:05.122089 => 2023-07-25 00:54:05.126422
[0m00:54:05.126674 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:54:05.129037 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:54:05.129808 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:54:05.129965 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m00:54:05.130113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:05.750761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:05.753882 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 00:54:05.126801 => 2023-07-25 00:54:05.753763
[0m00:54:05.754345 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m00:54:05.926567 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.81s]
[0m00:54:05.927321 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:54:05.927922 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:54:05.928413 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m00:54:05.929636 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:54:05.930044 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:54:05.938490 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:54:05.939264 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 00:54:05.930269 => 2023-07-25 00:54:05.939195
[0m00:54:05.939783 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:54:05.943994 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:54:05.945419 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:54:05.946044 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:05.946266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:07.105049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:07.109064 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 00:54:05.940046 => 2023-07-25 00:54:07.108980
[0m00:54:07.109416 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m00:54:07.231343 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 1.30s]
[0m00:54:07.232208 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:54:07.233297 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:54:07.233969 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m00:54:07.235120 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:54:07.235596 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:54:07.238291 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:54:07.239014 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 00:54:07.235937 => 2023-07-25 00:54:07.238964
[0m00:54:07.239208 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:54:07.242129 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:54:07.243232 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:54:07.243405 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m00:54:07.243557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:07.991648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:07.995153 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 00:54:07.239331 => 2023-07-25 00:54:07.995072
[0m00:54:07.995580 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m00:54:08.118822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193ace0>]}
[0m00:54:08.119753 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.88s]
[0m00:54:08.120357 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:54:08.120911 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:54:08.121378 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m00:54:08.122439 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:54:08.122852 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:54:08.125524 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:54:08.126051 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 00:54:08.123084 => 2023-07-25 00:54:08.126003
[0m00:54:08.126252 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:54:08.129180 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:54:08.130188 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:54:08.130351 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m00:54:08.130500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:08.861864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:08.866215 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 00:54:08.126381 => 2023-07-25 00:54:08.866127
[0m00:54:08.866698 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m00:54:09.092544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193be80>]}
[0m00:54:09.093345 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.97s]
[0m00:54:09.093877 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:54:09.094395 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:54:09.094968 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m00:54:09.096241 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:54:09.096672 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:54:09.100316 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:54:09.100994 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 00:54:09.096895 => 2023-07-25 00:54:09.100929
[0m00:54:09.101245 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:54:09.106921 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:54:09.108385 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:54:09.108611 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m00:54:09.108811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:09.897723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:09.901409 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 00:54:09.101411 => 2023-07-25 00:54:09.901324
[0m00:54:09.901931 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m00:54:10.081769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111956bf0>]}
[0m00:54:10.082748 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.99s]
[0m00:54:10.083313 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:54:10.083906 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:54:10.084425 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m00:54:10.085538 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:54:10.085898 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:54:10.089812 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:54:10.090488 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 00:54:10.086113 => 2023-07-25 00:54:10.090427
[0m00:54:10.090732 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:54:10.094094 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:54:10.096048 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:54:10.096260 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

final as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct 
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        avg(days_on_market) as avg_days_on_market
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m00:54:10.096437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:10.815295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m00:54:10.818704 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 00:54:10.090882 => 2023-07-25 00:54:10.818627
[0m00:54:10.819084 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m00:54:10.996543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f41c7363-8170-4b21-b1c4-f75fb6ccee1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111957dc0>]}
[0m00:54:10.997303 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.91s]
[0m00:54:10.997815 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:54:10.999638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:54:11.000367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:11.001373 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m00:54:11.001735 [info ] [MainThread]: 
[0m00:54:11.002011 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m00:54:11.002625 [debug] [MainThread]: Command end result
[0m00:54:11.010610 [info ] [MainThread]: 
[0m00:54:11.010960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:11.011199 [info ] [MainThread]: 
[0m00:54:11.011406 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:54:11.011698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11098c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118da800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118da320>]}
[0m00:54:11.011924 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:02:52.625391 | 581d57eb-3114-401a-a788-f8d3ce02c005 ==============================
[0m01:02:52.625391 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:02:52.636080 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:02:52.636582 [debug] [MainThread]: Tracking: tracking
[0m01:02:52.637450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ba770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2d480>]}
[0m01:02:52.757408 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:02:52.818554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:02:52.819160 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/price_buckets_days_on_market.sql
[0m01:02:52.836379 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/price_buckets_days_on_market.sql
[0m01:02:52.860395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:02:52.868863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf66b0>]}
[0m01:02:52.882334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b9bd0>]}
[0m01:02:52.883017 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:02:52.883691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104642ef0>]}
[0m01:02:52.886557 [info ] [MainThread]: 
[0m01:02:52.889551 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:02:52.891551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:02:52.916872 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:02:52.917357 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:02:52.917693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:53.667677 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:02:53.670146 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:02:53.891545 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:02:53.902553 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:02:53.903026 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:02:53.903317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:54.461255 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:02:54.464666 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:02:54.596910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b9b70>]}
[0m01:02:54.598640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:54.599178 [info ] [MainThread]: 
[0m01:02:54.608123 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:02:54.612149 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:02:54.613277 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:02:54.613725 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:02:54.632249 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:02:54.634064 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:02:54.613991 => 2023-07-25 01:02:54.633968
[0m01:02:54.634425 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:02:54.658556 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:02:54.659974 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:02:54.660245 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:02:54.660470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:55.225790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:02:55.236688 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:02:54.634647 => 2023-07-25 01:02:55.236564
[0m01:02:55.237181 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:02:55.377171 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.76s]
[0m01:02:55.380648 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:02:55.381383 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:02:55.381930 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:02:55.382967 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:02:55.383439 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:02:55.392607 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:02:55.393510 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:02:55.383693 => 2023-07-25 01:02:55.393394
[0m01:02:55.393948 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:02:55.398886 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:02:55.399950 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:02:55.400169 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:02:55.400330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:55.886849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:02:55.890216 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:02:55.394194 => 2023-07-25 01:02:55.890077
[0m01:02:55.890735 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:02:56.025728 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.64s]
[0m01:02:56.026529 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:02:56.027468 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:02:56.028110 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:02:56.029043 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:02:56.029472 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:02:56.034662 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:02:56.035641 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:02:56.029695 => 2023-07-25 01:02:56.035537
[0m01:02:56.036029 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:02:56.072754 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:02:56.074524 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:02:56.074783 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:02:56.075001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:56.712183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:02:56.741288 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:02:56.036254 => 2023-07-25 01:02:56.741224
[0m01:02:56.741636 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:02:56.884772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107074040>]}
[0m01:02:56.885567 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.86s]
[0m01:02:56.886200 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:02:56.887164 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:02:56.887656 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:02:56.888703 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:02:56.889089 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:02:56.896169 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:02:56.897085 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:02:56.889317 => 2023-07-25 01:02:56.896997
[0m01:02:56.897424 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:02:56.902081 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:02:56.903882 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:02:56.904258 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:02:56.904549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:57.513260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:02:57.516249 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:02:56.897636 => 2023-07-25 01:02:57.516158
[0m01:02:57.516601 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:02:57.653378 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 0.76s]
[0m01:02:57.654117 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:02:57.654663 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:02:57.655067 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:02:57.656675 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:02:57.657127 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:02:57.665408 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:02:57.666315 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:02:57.657363 => 2023-07-25 01:02:57.666215
[0m01:02:57.666690 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:02:57.671570 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:02:57.673405 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:02:57.673684 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:02:57.673858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:58.162802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:02:58.165910 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:02:57.666917 => 2023-07-25 01:02:58.165825
[0m01:02:58.166248 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:02:58.621055 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.96s]
[0m01:02:58.622202 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:02:58.622961 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:02:58.623518 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:02:58.625348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:02:58.625939 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:02:58.637481 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:02:58.638885 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:02:58.626170 => 2023-07-25 01:02:58.638693
[0m01:02:58.639319 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:02:58.644391 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:02:58.645804 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:02:58.646053 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:02:58.646241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:59.772264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:02:59.775985 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:02:58.639553 => 2023-07-25 01:02:59.775761
[0m01:02:59.776665 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:02:59.920623 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 1.30s]
[0m01:02:59.922115 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:02:59.923329 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:02:59.924463 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:02:59.925670 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:02:59.926182 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:02:59.931011 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:02:59.932166 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:02:59.926438 => 2023-07-25 01:02:59.932028
[0m01:02:59.932652 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:02:59.941411 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:02:59.943821 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:02:59.944408 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:02:59.944840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:00.611045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:03:00.616171 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:02:59.933001 => 2023-07-25 01:03:00.616076
[0m01:03:00.616611 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:03:00.752047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070eb6d0>]}
[0m01:03:00.753020 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.83s]
[0m01:03:00.754010 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:03:00.754540 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:03:00.755201 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:03:00.756251 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:03:00.756694 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:03:00.761629 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:03:00.762732 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:03:00.756921 => 2023-07-25 01:03:00.762595
[0m01:03:00.763208 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:03:00.768770 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:03:00.770900 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:03:00.771423 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:03:00.771770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:01.399150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:03:01.402585 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:03:00.763457 => 2023-07-25 01:03:01.402504
[0m01:03:01.402968 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:03:01.540058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070eb790>]}
[0m01:03:01.540841 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.78s]
[0m01:03:01.541444 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:03:01.542021 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:03:01.542584 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:03:01.543676 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:03:01.544070 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:03:01.548550 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:03:01.549433 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:03:01.544283 => 2023-07-25 01:03:01.549335
[0m01:03:01.549870 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:03:01.555965 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:03:01.559135 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:03:01.559797 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:03:01.560114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:02.153273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:03:02.156726 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:03:01.550118 => 2023-07-25 01:03:02.156642
[0m01:03:02.157174 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:03:02.292771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e6620>]}
[0m01:03:02.293565 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.75s]
[0m01:03:02.294140 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:03:02.294653 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:03:02.295155 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:03:02.296193 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:03:02.296571 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:03:02.301260 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:03:02.302296 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:03:02.296781 => 2023-07-25 01:03:02.302174
[0m01:03:02.302965 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:03:02.312359 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:03:02.315300 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:03:02.315622 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

final as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct 
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m01:03:02.315819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:02.893381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:03:02.897763 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:03:02.303225 => 2023-07-25 01:03:02.897681
[0m01:03:02.898213 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:03:03.032511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581d57eb-3114-401a-a788-f8d3ce02c005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e6bc0>]}
[0m01:03:03.033306 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.74s]
[0m01:03:03.033858 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:03:03.036790 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:03:03.037690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:03.037963 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m01:03:03.038299 [info ] [MainThread]: 
[0m01:03:03.038718 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m01:03:03.040155 [debug] [MainThread]: Command end result
[0m01:03:03.060950 [info ] [MainThread]: 
[0m01:03:03.061455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:03:03.061763 [info ] [MainThread]: 
[0m01:03:03.061998 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:03:03.062341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068aa440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059baad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b9b70>]}
[0m01:03:03.062603 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:09:45.476022 | ef9d77de-4c74-4409-ada7-b3ef41343858 ==============================
[0m01:09:45.476022 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:09:45.486229 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:09:45.486541 [debug] [MainThread]: Tracking: tracking
[0m01:09:45.487067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115bae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111626410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111624280>]}
[0m01:09:45.558571 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:09:45.615090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:09:45.615678 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/beds_baths_median_price.sql
[0m01:09:45.632181 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/beds_baths_median_price.sql
[0m01:09:45.653505 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:09:45.659969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11282a710>]}
[0m01:09:45.669902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115bbdc0>]}
[0m01:09:45.670335 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:09:45.670666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a2e90>]}
[0m01:09:45.672309 [info ] [MainThread]: 
[0m01:09:45.674406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:09:45.675873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:09:45.692735 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:09:45.693169 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:09:45.693442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:46.504421 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:09:46.506699 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:09:46.740243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:09:46.749345 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:09:46.749731 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:09:46.749976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:47.315921 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:09:47.318698 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:09:47.454920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ba230>]}
[0m01:09:47.456106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:09:47.456592 [info ] [MainThread]: 
[0m01:09:47.461425 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:09:47.461744 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:09:47.462399 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:09:47.462600 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:09:47.473754 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:09:47.474569 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:09:47.462736 => 2023-07-25 01:09:47.474506
[0m01:09:47.474812 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:09:47.492255 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:09:47.493606 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:09:47.493831 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:09:47.494019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:48.009030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:48.018665 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:09:47.474978 => 2023-07-25 01:09:48.018596
[0m01:09:48.018954 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:09:48.161197 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.70s]
[0m01:09:48.163987 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:09:48.164637 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:09:48.165071 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:09:48.165989 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:09:48.166271 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:09:48.170717 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:09:48.171276 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:09:48.166431 => 2023-07-25 01:09:48.171225
[0m01:09:48.171492 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:09:48.173922 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:09:48.174948 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:09:48.175196 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:09:48.175392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:48.631118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:09:48.634223 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:09:48.171626 => 2023-07-25 01:09:48.634098
[0m01:09:48.634717 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:09:48.777073 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.61s]
[0m01:09:48.777885 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:09:48.778737 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:09:48.779641 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:09:48.780716 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:09:48.781167 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:09:48.785353 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:09:48.786007 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:09:48.781403 => 2023-07-25 01:09:48.785946
[0m01:09:48.786244 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:09:48.812895 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:09:48.814418 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:09:48.814631 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:09:48.814814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:49.417706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:49.442784 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:09:48.786392 => 2023-07-25 01:09:49.442609
[0m01:09:49.443409 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:09:49.573308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112badbd0>]}
[0m01:09:49.574097 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.79s]
[0m01:09:49.574697 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:09:49.575768 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:09:49.576426 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:09:49.579729 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:09:49.580007 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:09:49.584846 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:09:49.585487 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:09:49.580175 => 2023-07-25 01:09:49.585428
[0m01:09:49.585728 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:09:49.588350 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:09:49.589429 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:09:49.589612 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:09:49.589781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:50.680915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:50.683929 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:09:49.585881 => 2023-07-25 01:09:50.683843
[0m01:09:50.684279 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:09:50.819177 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.24s]
[0m01:09:50.820041 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:09:50.820592 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:09:50.821065 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:09:50.822148 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:09:50.822521 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:09:50.828322 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:09:50.829266 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:09:50.822743 => 2023-07-25 01:09:50.829209
[0m01:09:50.829490 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:09:50.831919 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:09:50.832714 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:09:50.832901 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:09:50.833057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:51.714372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:51.717667 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:09:50.829627 => 2023-07-25 01:09:51.717553
[0m01:09:51.718135 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:09:51.844921 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.02s]
[0m01:09:51.845805 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:09:51.846429 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:09:51.846886 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:09:51.848038 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:09:51.848438 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:09:51.857623 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:09:51.858456 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:09:51.848664 => 2023-07-25 01:09:51.858386
[0m01:09:51.858745 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:09:51.862163 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:09:51.863708 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:09:51.864046 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:09:51.864284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:52.540030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:52.543129 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:09:51.858929 => 2023-07-25 01:09:52.543011
[0m01:09:52.543594 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:09:52.674849 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 0.83s]
[0m01:09:52.675585 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:09:52.676528 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:09:52.677201 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:09:52.678124 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:09:52.678431 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:09:52.681950 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:09:52.682570 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:09:52.678646 => 2023-07-25 01:09:52.682512
[0m01:09:52.682797 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:09:52.687056 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:09:52.688302 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:09:52.688473 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:09:52.688626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:53.243707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:53.249010 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:09:52.682930 => 2023-07-25 01:09:53.248926
[0m01:09:53.249446 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:09:53.384020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c23610>]}
[0m01:09:53.384817 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.71s]
[0m01:09:53.385411 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:09:53.385888 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:09:53.386425 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:09:53.387341 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:09:53.387710 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:09:53.391428 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:09:53.392279 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:09:53.387922 => 2023-07-25 01:09:53.392218
[0m01:09:53.392526 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:09:53.395810 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:09:53.396978 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:09:53.397158 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:09:53.397323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:53.998917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:54.002438 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:09:53.392678 => 2023-07-25 01:09:54.002357
[0m01:09:54.002853 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:09:54.143167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c23760>]}
[0m01:09:54.143927 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.76s]
[0m01:09:54.144463 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:09:54.144892 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:09:54.145378 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:09:54.146465 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:09:54.146858 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:09:54.149649 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:09:54.150171 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:09:54.147071 => 2023-07-25 01:09:54.150124
[0m01:09:54.150356 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:09:54.152959 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:09:54.153928 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:09:54.154077 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:09:54.154214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:54.753660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:54.757414 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:09:54.150473 => 2023-07-25 01:09:54.757330
[0m01:09:54.757867 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:09:54.893232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11288a590>]}
[0m01:09:54.894037 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.75s]
[0m01:09:54.894569 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:09:54.895442 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:09:54.896333 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:09:54.897442 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:09:54.897849 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:09:54.900763 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:09:54.901364 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:09:54.898023 => 2023-07-25 01:09:54.901307
[0m01:09:54.901581 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:09:54.904544 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:09:54.906259 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:09:54.906429 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

final as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct 
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m01:09:54.906582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:55.502551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:09:55.506000 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:09:54.901715 => 2023-07-25 01:09:55.505918
[0m01:09:55.506404 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:09:55.632818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef9d77de-4c74-4409-ada7-b3ef41343858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ab7eb0>]}
[0m01:09:55.633559 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.74s]
[0m01:09:55.634080 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:09:55.635898 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:09:55.636694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:55.636943 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m01:09:55.637262 [info ] [MainThread]: 
[0m01:09:55.637645 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 9.96 seconds (9.96s).
[0m01:09:55.642052 [debug] [MainThread]: Command end result
[0m01:09:55.650916 [info ] [MainThread]: 
[0m01:09:55.651362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:09:55.651651 [info ] [MainThread]: 
[0m01:09:55.651899 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:09:55.652240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b42e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b42b60>]}
[0m01:09:55.652515 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:11:35.467993 | d485b858-0af5-408c-9cca-f047d2c10be7 ==============================
[0m01:11:35.467993 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:11:35.473534 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:11:35.473803 [debug] [MainThread]: Tracking: tracking
[0m01:11:35.474242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e29450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e293f0>]}
[0m01:11:35.551821 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:11:35.608219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:11:35.608819 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/beds_baths_median_price.sql
[0m01:11:35.609169 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_baths_per_iteration.sql
[0m01:11:35.625084 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/beds_baths_median_price.sql
[0m01:11:35.640370 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_baths_per_iteration.sql
[0m01:11:35.650343 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:11:35.656432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a23fd0>]}
[0m01:11:35.666149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111faa260>]}
[0m01:11:35.666669 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:11:35.667041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea2e90>]}
[0m01:11:35.668742 [info ] [MainThread]: 
[0m01:11:35.670825 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:11:35.672204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:11:35.689440 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:11:35.689804 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:11:35.690032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:36.478629 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:11:36.480897 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:11:36.619372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:11:36.628012 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:11:36.628315 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:11:36.628565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:37.149295 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:11:37.152409 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:11:37.300998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea2e90>]}
[0m01:11:37.302155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:37.302653 [info ] [MainThread]: 
[0m01:11:37.306413 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:11:37.306706 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:11:37.307290 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:11:37.307476 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:11:37.318781 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:11:37.319546 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:11:37.307611 => 2023-07-25 01:11:37.319491
[0m01:11:37.319773 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:11:37.338539 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:11:37.339642 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:11:37.339838 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:11:37.340000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:37.810250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:11:37.820992 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:11:37.319915 => 2023-07-25 01:11:37.820882
[0m01:11:37.821450 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:11:37.965207 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.66s]
[0m01:11:37.967991 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:11:37.968651 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:11:37.969159 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:11:37.970158 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:11:37.970602 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:11:37.976934 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:11:37.977670 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:11:37.971108 => 2023-07-25 01:11:37.977601
[0m01:11:37.977956 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:11:37.981076 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:11:37.982298 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:11:37.982530 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:11:37.982740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:38.546299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:38.549314 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:11:37.978131 => 2023-07-25 01:11:38.549197
[0m01:11:38.549799 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:11:38.688683 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.72s]
[0m01:11:38.689401 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:11:38.690378 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:11:38.691048 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:11:38.692191 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:11:38.692526 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:11:38.696340 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:11:38.696986 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:11:38.692737 => 2023-07-25 01:11:38.696928
[0m01:11:38.697225 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:11:38.725566 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:11:38.727347 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:11:38.727609 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:11:38.727843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:39.315954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:39.336098 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:11:38.697374 => 2023-07-25 01:11:39.336045
[0m01:11:39.336403 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:11:39.469996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113143760>]}
[0m01:11:39.470764 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.78s]
[0m01:11:39.471272 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:11:39.472207 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:11:39.472704 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:11:39.473608 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:11:39.473923 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:11:39.478370 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:11:39.478953 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:11:39.474208 => 2023-07-25 01:11:39.478899
[0m01:11:39.479165 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:11:39.481450 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:11:39.482467 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:11:39.482677 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:11:39.482845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:40.051957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:40.055255 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:11:39.479308 => 2023-07-25 01:11:40.055133
[0m01:11:40.055770 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:11:40.188108 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 0.71s]
[0m01:11:40.188883 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:11:40.189341 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:11:40.189781 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:11:40.190790 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:11:40.191183 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:11:40.196821 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:11:40.197560 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:11:40.191423 => 2023-07-25 01:11:40.197492
[0m01:11:40.197840 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:11:40.201058 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:11:40.202093 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:11:40.202314 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:11:40.202510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:40.837944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:40.840888 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:11:40.198021 => 2023-07-25 01:11:40.840782
[0m01:11:40.841316 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:11:40.963678 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.77s]
[0m01:11:40.964506 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:11:40.965015 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:11:40.965497 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:11:40.966665 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:11:40.967039 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:11:40.974147 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:11:40.974763 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:11:40.967271 => 2023-07-25 01:11:40.974707
[0m01:11:40.974989 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:11:40.977537 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:11:40.978504 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:11:40.978671 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:11:40.978818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:41.574019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:41.576978 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:11:40.975131 => 2023-07-25 01:11:41.576865
[0m01:11:41.577435 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:11:41.712766 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 0.75s]
[0m01:11:41.713745 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:11:41.715063 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:11:41.715833 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:11:41.716964 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:11:41.717473 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:11:41.720808 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:11:41.721486 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:11:41.717741 => 2023-07-25 01:11:41.721422
[0m01:11:41.721728 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:11:41.726784 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:11:41.728366 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:11:41.728571 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:11:41.728746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:42.296968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:42.301327 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:11:41.721884 => 2023-07-25 01:11:42.301232
[0m01:11:42.301836 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:11:42.433758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113435150>]}
[0m01:11:42.434751 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.72s]
[0m01:11:42.435422 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:11:42.436009 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:11:42.436523 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:11:42.437635 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:11:42.438080 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:11:42.441183 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:11:42.441798 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:11:42.438279 => 2023-07-25 01:11:42.441736
[0m01:11:42.442030 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:11:42.445398 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:11:42.446789 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:11:42.446990 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
         -- create a primary key for this model
        md5(
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bathrooms, 0)
        ) as id,

        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:11:42.447161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:43.067586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:43.071148 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:11:42.442184 => 2023-07-25 01:11:43.071067
[0m01:11:43.071576 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:11:43.196824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134342b0>]}
[0m01:11:43.197625 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.76s]
[0m01:11:43.198174 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:11:43.198690 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:11:43.199310 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:11:43.200447 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:11:43.200832 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:11:43.204472 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:11:43.205324 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:11:43.201052 => 2023-07-25 01:11:43.205228
[0m01:11:43.205659 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:11:43.209696 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:11:43.211155 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:11:43.211374 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:11:43.211579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:43.800837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:43.804440 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:11:43.205856 => 2023-07-25 01:11:43.804355
[0m01:11:43.804837 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:11:43.973058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130ea530>]}
[0m01:11:43.973846 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.77s]
[0m01:11:43.974393 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:11:43.974968 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:11:43.975492 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:11:43.976549 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:11:43.976938 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:11:43.980633 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:11:43.981274 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:11:43.977169 => 2023-07-25 01:11:43.981220
[0m01:11:43.981482 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:11:43.984495 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:11:43.986284 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:11:43.986490 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

final as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct 
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m01:11:43.986653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:44.576525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:11:44.580170 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:11:43.981616 => 2023-07-25 01:11:44.580081
[0m01:11:44.580617 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:11:44.715931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd485b858-0af5-408c-9cca-f047d2c10be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e99c0>]}
[0m01:11:44.716699 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.74s]
[0m01:11:44.717214 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:11:44.719194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:11:44.719980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:44.720254 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m01:11:44.720571 [info ] [MainThread]: 
[0m01:11:44.721015 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m01:11:44.721841 [debug] [MainThread]: Command end result
[0m01:11:44.730000 [info ] [MainThread]: 
[0m01:11:44.730409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:44.730688 [info ] [MainThread]: 
[0m01:11:44.730929 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:11:44.731265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105391960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1d060>]}
[0m01:11:44.731527 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:12:54.610424 | 639bfe5c-2c32-4217-867f-a8354a346cde ==============================
[0m01:12:54.610424 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:12:54.615532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:12:54.616148 [debug] [MainThread]: Tracking: tracking
[0m01:12:54.616804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186bb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187293c0>]}
[0m01:12:54.688286 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:12:54.743443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:12:54.744002 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_bedrooms_per_iteration.sql
[0m01:12:54.760071 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_bedrooms_per_iteration.sql
[0m01:12:54.781462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:12:54.788318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11934b370>]}
[0m01:12:54.798606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107833b20>]}
[0m01:12:54.799082 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:12:54.799439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105090b20>]}
[0m01:12:54.801172 [info ] [MainThread]: 
[0m01:12:54.803340 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:12:54.804843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:12:54.821690 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:12:54.822100 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:12:54.822363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:56.103960 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:12:56.106297 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:12:56.240336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:12:56.250679 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:12:56.250983 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:12:56.251169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:56.789351 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:12:56.792054 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:12:56.929697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188aa3e0>]}
[0m01:12:56.930864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:12:56.931347 [info ] [MainThread]: 
[0m01:12:56.937270 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:12:56.937647 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:12:56.938330 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:12:56.938577 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:12:56.951491 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:12:56.952594 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:12:56.938739 => 2023-07-25 01:12:56.952515
[0m01:12:56.952888 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:12:56.972988 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:12:56.974101 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:12:56.974310 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:12:56.974491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:57.536827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:12:57.546283 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:12:56.953061 => 2023-07-25 01:12:57.546205
[0m01:12:57.546611 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:12:57.695439 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.76s]
[0m01:12:57.697996 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:12:57.698456 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:12:57.698877 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:12:57.699676 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:12:57.699970 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:12:57.707618 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:12:57.708178 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:12:57.700173 => 2023-07-25 01:12:57.708125
[0m01:12:57.708392 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:12:57.710699 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:12:57.711495 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:12:57.711749 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:12:57.711930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:58.223679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:12:58.226691 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:12:57.708531 => 2023-07-25 01:12:58.226579
[0m01:12:58.227140 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:12:58.350135 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.65s]
[0m01:12:58.351062 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:12:58.352098 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:12:58.352856 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:12:58.354066 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:12:58.354488 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:12:58.357719 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:12:58.358318 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:12:58.354678 => 2023-07-25 01:12:58.358258
[0m01:12:58.358557 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:12:58.383839 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:12:58.385385 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:12:58.385603 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:12:58.385790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:59.018917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:12:59.038612 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:12:58.358706 => 2023-07-25 01:12:59.038558
[0m01:12:59.038918 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:12:59.181383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c6e740>]}
[0m01:12:59.182134 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.83s]
[0m01:12:59.183021 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:12:59.184083 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:12:59.186070 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:12:59.186806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:12:59.187065 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:12:59.191220 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:12:59.191802 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:12:59.187220 => 2023-07-25 01:12:59.191750
[0m01:12:59.192009 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:12:59.194329 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:12:59.195395 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:12:59.195565 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:12:59.195719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:59.799608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:12:59.802608 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:12:59.192141 => 2023-07-25 01:12:59.802504
[0m01:12:59.803046 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:12:59.952172 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 0.77s]
[0m01:12:59.953048 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:12:59.953533 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:12:59.953970 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:12:59.955015 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:12:59.955363 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:12:59.961244 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:12:59.961930 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:12:59.955578 => 2023-07-25 01:12:59.961868
[0m01:12:59.962178 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:12:59.964990 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:12:59.965935 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:12:59.966142 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:12:59.966426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:00.436835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:13:00.440140 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:12:59.962335 => 2023-07-25 01:13:00.440040
[0m01:13:00.440539 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:13:00.566928 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.61s]
[0m01:13:00.567666 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:13:00.568118 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:13:00.568558 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:13:00.569455 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:13:00.569849 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:13:00.578071 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:13:00.578776 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:13:00.570106 => 2023-07-25 01:13:00.578712
[0m01:13:00.579028 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:13:00.582150 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:13:00.583320 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:13:00.583530 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:13:00.583841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:01.247218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:13:01.250279 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:13:00.579181 => 2023-07-25 01:13:01.250162
[0m01:13:01.250842 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:13:01.376992 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 0.81s]
[0m01:13:01.377818 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:13:01.378909 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:13:01.379685 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:13:01.380850 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:13:01.381417 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:13:01.385147 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:13:01.385882 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:13:01.381703 => 2023-07-25 01:13:01.385810
[0m01:13:01.386179 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:13:01.391896 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:13:01.393607 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:13:01.393837 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:13:01.394040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:02.021467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:13:02.026065 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:13:01.386357 => 2023-07-25 01:13:02.025976
[0m01:13:02.026562 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:13:02.149153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ceb490>]}
[0m01:13:02.149881 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.77s]
[0m01:13:02.150434 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:13:02.150896 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:13:02.151474 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:13:02.152596 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:13:02.152992 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:13:02.156214 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:13:02.156827 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:13:02.153242 => 2023-07-25 01:13:02.156771
[0m01:13:02.157058 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:13:02.160030 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:13:02.161259 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:13:02.161433 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
         -- create a primary key for this model
        md5(
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bathrooms, 0)
        ) as id,

        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:13:02.161590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:02.727507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:13:02.731129 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:13:02.157203 => 2023-07-25 01:13:02.731046
[0m01:13:02.731559 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:13:02.871734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ceb790>]}
[0m01:13:02.872637 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.72s]
[0m01:13:02.873172 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:13:02.873567 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:13:02.874077 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:13:02.874867 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:13:02.875619 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:13:02.878290 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:13:02.878821 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:13:02.875846 => 2023-07-25 01:13:02.878768
[0m01:13:02.879028 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:13:02.881848 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:13:02.883047 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:13:02.883218 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        -- create a primary key for this model
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bedrooms, 0)
        ) as id,

        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:13:02.883371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:03.661736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:13:03.665207 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:13:02.879161 => 2023-07-25 01:13:03.665124
[0m01:13:03.665650 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:13:03.791833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ce6560>]}
[0m01:13:03.792606 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.92s]
[0m01:13:03.793132 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:13:03.793634 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:13:03.794195 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:13:03.795256 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:13:03.795651 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:13:03.799070 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:13:03.800669 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:13:03.795887 => 2023-07-25 01:13:03.800598
[0m01:13:03.800923 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:13:03.803930 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:13:03.805653 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:13:03.805845 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

final as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct 
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from analytics.dbt_ndw.stg_property_sale_listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m01:13:03.806001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:04.644762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:13:04.648291 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:13:03.801068 => 2023-07-25 01:13:04.648205
[0m01:13:04.648717 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:13:04.777266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639bfe5c-2c32-4217-867f-a8354a346cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ce6ad0>]}
[0m01:13:04.778016 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.98s]
[0m01:13:04.778642 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:13:04.780527 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:13:04.781581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:04.781920 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m01:13:04.782252 [info ] [MainThread]: 
[0m01:13:04.782681 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 9.98 seconds (9.98s).
[0m01:13:04.783285 [debug] [MainThread]: Command end result
[0m01:13:04.790319 [info ] [MainThread]: 
[0m01:13:04.790676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:13:04.790908 [info ] [MainThread]: 
[0m01:13:04.791114 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:13:04.791411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188e6a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105090b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a2e30>]}
[0m01:13:04.791643 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:17:28.271342 | 8866ebad-8e83-476f-8bd1-6cbd3bd35078 ==============================
[0m01:17:28.271342 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:17:28.276425 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:17:28.276769 [debug] [MainThread]: Tracking: tracking
[0m01:17:28.277213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e14070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143bb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11442c2b0>]}
[0m01:17:28.355993 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:17:28.414874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:17:28.415444 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_bedrooms_per_iteration.sql
[0m01:17:28.415782 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/price_buckets_days_on_market.sql
[0m01:17:28.416089 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/distinct_num_baths_per_iteration.sql
[0m01:17:28.432339 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_bedrooms_per_iteration.sql
[0m01:17:28.447698 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/price_buckets_days_on_market.sql
[0m01:17:28.453398 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/distinct_num_baths_per_iteration.sql
[0m01:17:28.463951 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:17:28.470668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151306d0>]}
[0m01:17:28.481084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145aa200>]}
[0m01:17:28.481540 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:17:28.481881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b50b20>]}
[0m01:17:28.483577 [info ] [MainThread]: 
[0m01:17:28.485681 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:28.487037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:17:28.503688 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:17:28.504088 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:17:28.504342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:29.293175 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:17:29.296437 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:17:29.435454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:17:29.444039 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:17:29.444364 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:17:29.444569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:30.029404 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:17:30.032110 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:17:30.167414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2ba60>]}
[0m01:17:30.168586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:30.168944 [info ] [MainThread]: 
[0m01:17:30.172600 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:17:30.172919 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:17:30.173510 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:17:30.173709 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:17:30.186054 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:17:30.186791 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:17:30.173851 => 2023-07-25 01:17:30.186731
[0m01:17:30.187027 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:17:30.205150 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:17:30.206156 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:17:30.206340 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:17:30.206511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:30.744851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:17:30.755317 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:17:30.187170 => 2023-07-25 01:17:30.755237
[0m01:17:30.755716 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:17:30.894163 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.72s]
[0m01:17:30.897770 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:17:30.898540 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:17:30.899296 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:17:30.900172 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:17:30.900449 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:17:30.906319 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:17:30.907231 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:17:30.900632 => 2023-07-25 01:17:30.907159
[0m01:17:30.907516 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:17:30.910538 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:17:30.911641 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:17:30.911876 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:17:30.912073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:31.511626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:17:31.514647 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:17:30.907690 => 2023-07-25 01:17:31.514542
[0m01:17:31.515075 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:17:31.647412 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.75s]
[0m01:17:31.648202 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:17:31.649210 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:17:31.649876 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:17:31.651007 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:17:31.651517 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:17:31.654673 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:17:31.655238 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:17:31.651753 => 2023-07-25 01:17:31.655181
[0m01:17:31.655453 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:17:31.680734 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:17:31.682301 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:17:31.682522 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:17:31.682708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:32.250178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:17:32.270676 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:17:31.655587 => 2023-07-25 01:17:32.270627
[0m01:17:32.270960 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:17:32.393214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ae76a0>]}
[0m01:17:32.394020 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.74s]
[0m01:17:32.394767 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:17:32.396345 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:17:32.396924 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:17:32.398113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:17:32.398767 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:17:32.403155 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:17:32.403733 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:17:32.399000 => 2023-07-25 01:17:32.403681
[0m01:17:32.403935 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:17:32.406216 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:17:32.407231 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:17:32.407412 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:17:32.407563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:33.548390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:17:33.551421 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:17:32.404067 => 2023-07-25 01:17:33.551312
[0m01:17:33.551864 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:17:33.680066 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.28s]
[0m01:17:33.680828 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:17:33.681320 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:17:33.681749 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:17:33.682814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:17:33.683184 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:17:33.689529 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:17:33.690216 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:17:33.683396 => 2023-07-25 01:17:33.690155
[0m01:17:33.690455 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:17:33.693309 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:17:33.694249 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:17:33.694440 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:17:33.694612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:34.156293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:17:34.159238 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:17:33.690609 => 2023-07-25 01:17:34.159131
[0m01:17:34.159715 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:17:34.292530 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.61s]
[0m01:17:34.293348 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:17:34.293861 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:17:34.294335 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:17:34.295533 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:17:34.296607 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:17:34.303770 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:17:34.304463 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:17:34.296863 => 2023-07-25 01:17:34.304400
[0m01:17:34.304709 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:17:34.307866 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:17:34.308985 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:17:34.309264 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:17:34.309479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:34.850134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:17:34.853185 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:17:34.304863 => 2023-07-25 01:17:34.853075
[0m01:17:34.853631 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:17:34.979650 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 0.68s]
[0m01:17:34.980398 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:17:34.981386 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:17:34.981945 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:17:34.982869 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:17:34.983228 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:17:34.986653 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:17:34.987244 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:17:34.983441 => 2023-07-25 01:17:34.987190
[0m01:17:34.987453 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:17:34.991785 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:17:34.993153 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:17:34.993342 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:17:34.993493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:35.562628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:17:35.566172 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:17:34.987585 => 2023-07-25 01:17:35.566094
[0m01:17:35.566591 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:17:35.691258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b30df0>]}
[0m01:17:35.692042 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.71s]
[0m01:17:35.692584 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:17:35.693199 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:17:35.693703 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:17:35.694934 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:17:35.695292 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:17:35.699233 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:17:35.700302 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:17:35.695531 => 2023-07-25 01:17:35.700225
[0m01:17:35.700577 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:17:35.703989 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:17:35.705347 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:17:35.705548 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
         -- create a primary key for this model
        md5(
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bathrooms, 0)
        ) as id,

        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:17:35.705735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:36.358351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:17:36.362193 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:17:35.700740 => 2023-07-25 01:17:36.362113
[0m01:17:36.362630 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:17:36.518270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b32e90>]}
[0m01:17:36.519093 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.82s]
[0m01:17:36.519630 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:17:36.520060 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:17:36.520701 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:17:36.521837 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:17:36.522233 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:17:36.526019 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:17:36.526747 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:17:36.522573 => 2023-07-25 01:17:36.526675
[0m01:17:36.527136 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:17:36.531248 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:17:36.532904 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:17:36.533146 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        -- create a primary key for this model
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bedrooms, 0)
        ) as id,

        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:17:36.533357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:37.216499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:17:37.219994 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:17:36.527351 => 2023-07-25 01:17:37.219917
[0m01:17:37.220402 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:17:37.344586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a87130>]}
[0m01:17:37.345455 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.82s]
[0m01:17:37.346158 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:17:37.346862 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:17:37.347379 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:17:37.348678 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:17:37.348992 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:17:37.351888 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:17:37.352417 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:17:37.349146 => 2023-07-25 01:17:37.352363
[0m01:17:37.352615 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:17:37.355829 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:17:37.357802 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:17:37.357999 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

price_buckets as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from listings
    group by iteration_date, price_bucket
    order by iteration_date asc, price_bucket asc
),

final as (
    -- create a primary key for this model
    select 
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(price_bucket::varchar, '')
        ) as id,

        iteration_date,
        price_bucket,
        avg_days_on_market
)

select * from final
  );
[0m01:17:37.358161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:37.843136 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01adda2d-0604-ae64-0050-3987000dc0de
[0m01:17:37.843631 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 21
invalid identifier 'ITERATION_DATE'
[0m01:17:37.843991 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:17:37.352743 => 2023-07-25 01:17:37.843929
[0m01:17:37.844210 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:17:37.975873 [debug] [Thread-1 (]: Database Error in model price_buckets_days_on_market (models/marts/core/price_buckets_days_on_market.sql)
  000904 (42000): SQL compilation error: error line 40 at position 21
  invalid identifier 'ITERATION_DATE'
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/price_buckets_days_on_market.sql
[0m01:17:37.976667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8866ebad-8e83-476f-8bd1-6cbd3bd35078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a85a50>]}
[0m01:17:37.977335 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model DBT_NDW.price_buckets_days_on_market .... [[31mERROR[0m in 0.63s]
[0m01:17:37.977990 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:17:37.979537 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:37.980025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:37.980189 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m01:17:37.980390 [info ] [MainThread]: 
[0m01:17:37.980631 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 9.50 seconds (9.50s).
[0m01:17:37.981186 [debug] [MainThread]: Command end result
[0m01:17:37.988341 [info ] [MainThread]: 
[0m01:17:37.988680 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:17:37.988902 [info ] [MainThread]: 
[0m01:17:37.989113 [error] [MainThread]: [33mDatabase Error in model price_buckets_days_on_market (models/marts/core/price_buckets_days_on_market.sql)[0m
[0m01:17:37.989319 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 40 at position 21
[0m01:17:37.989514 [error] [MainThread]:   invalid identifier 'ITERATION_DATE'
[0m01:17:37.989704 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/price_buckets_days_on_market.sql
[0m01:17:37.989910 [info ] [MainThread]: 
[0m01:17:37.990111 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:17:37.990387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11519bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11592f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143b9cf0>]}
[0m01:17:37.990602 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:18:15.798591 | c7d1c449-baa0-4234-9dee-adef91868cf3 ==============================
[0m01:18:15.798591 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:18:15.806030 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:18:15.806502 [debug] [MainThread]: Tracking: tracking
[0m01:18:15.807090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183bb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183b9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118525420>]}
[0m01:18:15.892983 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:18:15.950179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:18:15.950765 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/marts/core/price_buckets_days_on_market.sql
[0m01:18:15.966809 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/price_buckets_days_on_market.sql
[0m01:18:15.989008 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:18:15.995613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c5e740>]}
[0m01:18:16.005761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118bd6320>]}
[0m01:18:16.006235 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:18:16.006591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105872a70>]}
[0m01:18:16.008355 [info ] [MainThread]: 
[0m01:18:16.010532 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:18:16.011879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:18:16.030451 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:18:16.030879 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:18:16.031175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:16.816225 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:18:16.818750 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:18:16.949736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:18:16.958105 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:18:16.958404 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:18:16.958587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:17.491438 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:18:17.494315 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:18:17.626114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105872a70>]}
[0m01:18:17.627107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:17.627542 [info ] [MainThread]: 
[0m01:18:17.632511 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:18:17.632825 [info ] [Thread-1 (]: 1 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:18:17.633392 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:18:17.633589 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:18:17.644570 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:18:17.645867 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:18:17.633720 => 2023-07-25 01:18:17.645781
[0m01:18:17.646157 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:18:17.664083 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:18:17.665484 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:18:17.665694 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:18:17.665865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:18.116828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:18:18.126479 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:18:17.646311 => 2023-07-25 01:18:18.126406
[0m01:18:18.126806 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:18:18.262954 [info ] [Thread-1 (]: 1 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.63s]
[0m01:18:18.266072 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:18:18.266749 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:18:18.267201 [info ] [Thread-1 (]: 2 of 10 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:18:18.268113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:18:18.268402 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:18:18.272769 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:18:18.273896 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:18:18.268548 => 2023-07-25 01:18:18.273836
[0m01:18:18.274130 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:18:18.276389 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:18:18.278649 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:18:18.278890 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:18:18.279063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:18.765343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:18:18.768179 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:18:18.274280 => 2023-07-25 01:18:18.768089
[0m01:18:18.768564 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:18:18.890457 [info ] [Thread-1 (]: 2 of 10 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.62s]
[0m01:18:18.891151 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:18:18.892040 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:18:18.892632 [info ] [Thread-1 (]: 3 of 10 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:18:18.893656 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:18:18.893966 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:18:18.898093 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:18:18.898679 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:18:18.894176 => 2023-07-25 01:18:18.898622
[0m01:18:18.898910 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:18:18.923995 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:18:18.925479 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:18:18.925717 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:18:18.925909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:19.511673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:18:19.533117 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:18:18.899058 => 2023-07-25 01:18:19.533063
[0m01:18:19.533430 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:18:19.667526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119382da0>]}
[0m01:18:19.668740 [info ] [Thread-1 (]: 3 of 10 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.77s]
[0m01:18:19.669480 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:18:19.670592 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:18:19.671036 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:18:19.671916 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:18:19.672281 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:18:19.677323 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:18:19.678182 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:18:19.672613 => 2023-07-25 01:18:19.678118
[0m01:18:19.678455 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:18:19.681109 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:18:19.682294 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:18:19.682493 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:18:19.682672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:20.514303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:18:20.517867 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:18:19.678615 => 2023-07-25 01:18:20.517730
[0m01:18:20.518455 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:18:20.814947 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.14s]
[0m01:18:20.815837 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:18:20.816410 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:18:20.816927 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:18:20.818052 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:18:20.818456 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:18:20.825013 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:18:20.825649 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:18:20.818687 => 2023-07-25 01:18:20.825591
[0m01:18:20.825868 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:18:20.828390 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:18:20.829586 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:18:20.829799 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:18:20.829963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:21.617880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:18:21.621003 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:18:20.826001 => 2023-07-25 01:18:21.620918
[0m01:18:21.621361 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:18:21.759326 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.94s]
[0m01:18:21.760111 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:18:21.760655 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:18:21.761127 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:18:21.762065 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:18:21.762454 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:18:21.771596 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:18:21.772628 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:18:21.762669 => 2023-07-25 01:18:21.772555
[0m01:18:21.772890 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:18:21.775461 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:18:21.776939 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:18:21.777178 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:18:21.777347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:22.530310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:18:22.533313 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:18:21.773034 => 2023-07-25 01:18:22.533210
[0m01:18:22.533750 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:18:22.668778 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 0.91s]
[0m01:18:22.669491 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:18:22.670990 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:18:22.671796 [info ] [Thread-1 (]: 7 of 10 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:18:22.672879 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:18:22.673297 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:18:22.677418 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:18:22.677983 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:18:22.674776 => 2023-07-25 01:18:22.677928
[0m01:18:22.678196 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:18:22.682337 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:18:22.683669 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:18:22.683854 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:18:22.684010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:23.267224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:18:23.270764 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:18:22.678329 => 2023-07-25 01:18:23.270679
[0m01:18:23.271225 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:18:23.415511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193fb4c0>]}
[0m01:18:23.416322 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.74s]
[0m01:18:23.416892 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:18:23.417439 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:18:23.417975 [info ] [Thread-1 (]: 8 of 10 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:18:23.419147 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:18:23.419643 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:18:23.422486 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:18:23.423015 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:18:23.419872 => 2023-07-25 01:18:23.422963
[0m01:18:23.423218 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:18:23.425989 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:18:23.427036 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:18:23.427195 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
         -- create a primary key for this model
        md5(
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bathrooms, 0)
        ) as id,

        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:18:23.427342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:24.061877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:18:24.065749 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:18:23.423345 => 2023-07-25 01:18:24.065662
[0m01:18:24.066196 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:18:24.192336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193fb7c0>]}
[0m01:18:24.193079 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.77s]
[0m01:18:24.193582 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:18:24.194121 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:18:24.194681 [info ] [Thread-1 (]: 9 of 10 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:18:24.195768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:18:24.196143 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:18:24.199834 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:18:24.200429 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:18:24.196369 => 2023-07-25 01:18:24.200374
[0m01:18:24.200639 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:18:24.203643 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:18:24.204835 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:18:24.205008 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        -- create a primary key for this model
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bedrooms, 0)
        ) as id,

        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:18:24.205161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:24.775173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:18:24.778697 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:18:24.200772 => 2023-07-25 01:18:24.778613
[0m01:18:24.779159 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:18:24.905915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193f64a0>]}
[0m01:18:24.906665 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.71s]
[0m01:18:24.907164 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:18:24.907554 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:18:24.908022 [info ] [Thread-1 (]: 10 of 10 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:18:24.908942 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:18:24.909308 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:18:24.913202 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:18:24.913829 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:18:24.909525 => 2023-07-25 01:18:24.913772
[0m01:18:24.914050 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:18:24.916963 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:18:24.918884 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:18:24.919070 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

price_buckets as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from listings
    group by iteration_date, price_bucket
),

final as (
    -- create a primary key for this model
    select 
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(price_bucket::varchar, '')
        ) as id,

        iteration_date,
        price_bucket,
        avg_days_on_market
    from price_buckets
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m01:18:24.919224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:25.456546 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:18:25.460188 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:18:24.914191 => 2023-07-25 01:18:25.460104
[0m01:18:25.460651 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:18:25.591798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d1c449-baa0-4234-9dee-adef91868cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193f6b30>]}
[0m01:18:25.592601 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.68s]
[0m01:18:25.593150 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:18:25.594779 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:18:25.595565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:25.595838 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.price_buckets_days_on_market' was properly closed.
[0m01:18:25.596225 [info ] [MainThread]: 
[0m01:18:25.596613 [info ] [MainThread]: Finished running 5 tests, 5 view models in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m01:18:25.597634 [debug] [MainThread]: Command end result
[0m01:18:25.610939 [info ] [MainThread]: 
[0m01:18:25.611633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:25.612168 [info ] [MainThread]: 
[0m01:18:25.612549 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:18:25.613030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118bd6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b648b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11922e440>]}
[0m01:18:25.613411 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:28:23.608250 | 3437a672-5414-469a-a220-23830a27cce6 ==============================
[0m01:28:23.608250 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:28:23.613815 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:28:23.614108 [debug] [MainThread]: Tracking: tracking
[0m01:28:23.614874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124b52f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d25c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d25bd0>]}
[0m01:28:23.686706 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:28:23.745221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:28:23.745807 [debug] [MainThread]: Partial parsing: added file: real_estate_dbt_project://models/schema.yml
[0m01:28:23.791537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:28:23.798334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a2fdf0>]}
[0m01:28:23.810933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125977790>]}
[0m01:28:23.811425 [info ] [MainThread]: Found 5 models, 8 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:28:23.811779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ea27d0>]}
[0m01:28:23.813624 [info ] [MainThread]: 
[0m01:28:23.815560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:28:23.817382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:28:23.842286 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:28:23.842812 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:28:23.843366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:24.671364 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:28:24.673680 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:28:24.847767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:28:24.855422 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:28:24.855709 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:28:24.855878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:25.422047 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:28:25.424799 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:28:25.554894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a6eb90>]}
[0m01:28:25.556066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:28:25.556645 [info ] [MainThread]: 
[0m01:28:25.561636 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:28:25.561990 [info ] [Thread-1 (]: 1 of 13 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:28:25.562654 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:28:25.562879 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:28:25.576933 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:28:25.577906 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:28:25.563038 => 2023-07-25 01:28:25.577835
[0m01:28:25.578171 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:28:25.602185 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:28:25.603353 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:28:25.603590 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:28:25.603776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:26.097729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:28:26.107624 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:28:25.578336 => 2023-07-25 01:28:26.107553
[0m01:28:26.107954 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:28:26.252363 [info ] [Thread-1 (]: 1 of 13 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.69s]
[0m01:28:26.255373 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:28:26.256012 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:28:26.256418 [info ] [Thread-1 (]: 2 of 13 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:28:26.257300 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:28:26.257589 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:28:26.262901 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:28:26.263520 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:28:26.257742 => 2023-07-25 01:28:26.263467
[0m01:28:26.263735 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:28:26.265982 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:28:26.266812 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:28:26.266971 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:28:26.267120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:26.772319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:26.775473 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:28:26.263866 => 2023-07-25 01:28:26.775356
[0m01:28:26.775943 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:28:26.910400 [info ] [Thread-1 (]: 2 of 13 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.65s]
[0m01:28:26.911149 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:28:26.912010 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:28:26.912691 [info ] [Thread-1 (]: 3 of 13 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:28:26.913781 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:28:26.914172 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:28:26.917560 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:28:26.918152 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:28:26.914392 => 2023-07-25 01:28:26.918100
[0m01:28:26.918363 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:28:26.944589 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:28:26.946125 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:28:26.946340 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:28:26.946520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:27.576419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:27.596963 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:28:26.918493 => 2023-07-25 01:28:27.596904
[0m01:28:27.597298 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:28:27.726700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12638fa90>]}
[0m01:28:27.727525 [info ] [Thread-1 (]: 3 of 13 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.81s]
[0m01:28:27.728196 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:28:27.729301 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:28:27.730040 [info ] [Thread-1 (]: 4 of 13 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:28:27.730974 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:28:27.731781 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:28:27.737214 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:28:27.738505 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:28:27.732031 => 2023-07-25 01:28:27.738435
[0m01:28:27.738756 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:28:27.741165 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:28:27.742895 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:28:27.743105 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:28:27.743269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:28.881426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:28.884437 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:28:27.738901 => 2023-07-25 01:28:28.884332
[0m01:28:28.884890 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:28:29.025143 [info ] [Thread-1 (]: 4 of 13 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.29s]
[0m01:28:29.025878 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:28:29.026346 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:28:29.026757 [info ] [Thread-1 (]: 5 of 13 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:28:29.027821 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:28:29.028176 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:28:29.033264 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:28:29.033823 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:28:29.028384 => 2023-07-25 01:28:29.033772
[0m01:28:29.034016 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:28:29.036393 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:28:29.037198 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:28:29.037360 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:28:29.037510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:29.899618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:29.902607 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:28:29.034138 => 2023-07-25 01:28:29.902507
[0m01:28:29.903049 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:28:30.037956 [info ] [Thread-1 (]: 5 of 13 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.01s]
[0m01:28:30.039399 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:28:30.039983 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:28:30.040468 [info ] [Thread-1 (]: 6 of 13 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:28:30.041502 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:28:30.041936 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:28:30.048838 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:28:30.049480 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:28:30.042169 => 2023-07-25 01:28:30.049427
[0m01:28:30.049689 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:28:30.052183 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:28:30.053178 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:28:30.053350 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:28:30.053499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:30.982756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:30.986630 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:28:30.049820 => 2023-07-25 01:28:30.986530
[0m01:28:30.987043 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:28:31.121121 [info ] [Thread-1 (]: 6 of 13 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 1.08s]
[0m01:28:31.121892 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:28:31.123063 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:28:31.123920 [info ] [Thread-1 (]: 7 of 13 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:28:31.125070 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:28:31.125513 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:28:31.128509 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:28:31.129113 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:28:31.125691 => 2023-07-25 01:28:31.129057
[0m01:28:31.129332 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:28:31.132554 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:28:31.133908 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:28:31.134131 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:28:31.134298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:31.694737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:31.698313 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:28:31.129474 => 2023-07-25 01:28:31.698203
[0m01:28:31.698783 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:28:31.835863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12649edd0>]}
[0m01:28:31.836740 [info ] [Thread-1 (]: 7 of 13 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.71s]
[0m01:28:31.837483 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:28:31.838294 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:28:31.839404 [info ] [Thread-1 (]: 8 of 13 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:28:31.840547 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:28:31.840938 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:28:31.844559 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:28:31.845277 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:28:31.841213 => 2023-07-25 01:28:31.845205
[0m01:28:31.845534 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:28:31.849030 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:28:31.850373 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:28:31.850573 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
         -- create a primary key for this model
        md5(
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bathrooms, 0)
        ) as id,

        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:28:31.850753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:32.482742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:32.486157 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:28:31.845694 => 2023-07-25 01:28:32.486100
[0m01:28:32.486474 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:28:32.632212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12649ece0>]}
[0m01:28:32.633100 [info ] [Thread-1 (]: 8 of 13 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.79s]
[0m01:28:32.633801 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:28:32.634444 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:28:32.635018 [info ] [Thread-1 (]: 9 of 13 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:28:32.637903 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:28:32.638228 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:28:32.641872 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:28:32.642411 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:28:32.638374 => 2023-07-25 01:28:32.642360
[0m01:28:32.642609 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:28:32.645415 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:28:32.646556 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:28:32.646731 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        -- create a primary key for this model
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bedrooms, 0)
        ) as id,

        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:28:32.646884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:33.219610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:33.223203 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:28:32.642738 => 2023-07-25 01:28:33.223119
[0m01:28:33.223631 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:28:33.359741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12641ca90>]}
[0m01:28:33.360603 [info ] [Thread-1 (]: 9 of 13 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.72s]
[0m01:28:33.361112 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:28:33.361510 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:28:33.361973 [info ] [Thread-1 (]: 10 of 13 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:28:33.362853 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:28:33.363177 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:28:33.365989 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:28:33.366510 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:28:33.363338 => 2023-07-25 01:28:33.366463
[0m01:28:33.366707 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:28:33.369476 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:28:33.371289 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:28:33.371466 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

price_buckets as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from listings
    group by iteration_date, price_bucket
),

final as (
    -- create a primary key for this model
    select 
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(price_bucket::varchar, '')
        ) as id,

        iteration_date,
        price_bucket,
        avg_days_on_market
    from price_buckets
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m01:28:33.371616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:33.991424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:33.995136 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:28:33.366832 => 2023-07-25 01:28:33.995051
[0m01:28:33.995636 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:28:34.139575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437a672-5414-469a-a220-23830a27cce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261e9930>]}
[0m01:28:34.140454 [info ] [Thread-1 (]: 10 of 13 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.78s]
[0m01:28:34.141258 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:28:34.142127 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:28:34.142915 [info ] [Thread-1 (]: 11 of 13 START test not_null_beds_baths_median_price_id ........................ [RUN]
[0m01:28:34.144046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513'
[0m01:28:34.144440 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:28:34.150155 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:28:34.151083 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (compile): 2023-07-25 01:28:34.144653 => 2023-07-25 01:28:34.151003
[0m01:28:34.151387 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:28:34.156565 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:28:34.157847 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:28:34.158094 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.beds_baths_median_price
where id is null



      
    ) dbt_internal_test
[0m01:28:34.158309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:34.841362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:34.844257 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (execute): 2023-07-25 01:28:34.151584 => 2023-07-25 01:28:34.844164
[0m01:28:34.844638 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513: Close
[0m01:28:34.980390 [info ] [Thread-1 (]: 11 of 13 PASS not_null_beds_baths_median_price_id .............................. [[32mPASS[0m in 0.84s]
[0m01:28:34.981112 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:28:34.981559 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:28:34.981948 [info ] [Thread-1 (]: 12 of 13 START test not_null_beds_baths_median_price_iteration_date ............ [RUN]
[0m01:28:34.982802 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d'
[0m01:28:34.983158 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:28:34.987995 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:28:34.988547 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (compile): 2023-07-25 01:28:34.983364 => 2023-07-25 01:28:34.988495
[0m01:28:34.988755 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:28:34.991179 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:28:34.991951 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:28:34.992116 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.beds_baths_median_price
where iteration_date is null



      
    ) dbt_internal_test
[0m01:28:34.992271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:35.551657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:35.557859 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (execute): 2023-07-25 01:28:34.988896 => 2023-07-25 01:28:35.557737
[0m01:28:35.558394 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d: Close
[0m01:28:35.693271 [info ] [Thread-1 (]: 12 of 13 PASS not_null_beds_baths_median_price_iteration_date .................. [[32mPASS[0m in 0.71s]
[0m01:28:35.694061 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:28:35.694706 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:28:35.695167 [info ] [Thread-1 (]: 13 of 13 START test unique_beds_baths_median_price_id .......................... [RUN]
[0m01:28:35.696280 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9'
[0m01:28:35.696768 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:28:35.703198 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:28:35.703998 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (compile): 2023-07-25 01:28:35.697068 => 2023-07-25 01:28:35.703925
[0m01:28:35.704290 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:28:35.707911 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:28:35.709460 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:28:35.709929 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.beds_baths_median_price
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:28:35.710202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:36.359314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:28:36.362378 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (execute): 2023-07-25 01:28:35.704468 => 2023-07-25 01:28:36.362271
[0m01:28:36.362774 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9: Close
[0m01:28:36.493813 [info ] [Thread-1 (]: 13 of 13 PASS unique_beds_baths_median_price_id ................................ [[32mPASS[0m in 0.80s]
[0m01:28:36.494590 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:28:36.496432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:28:36.497280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:36.497606 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9' was properly closed.
[0m01:28:36.498036 [info ] [MainThread]: 
[0m01:28:36.498545 [info ] [MainThread]: Finished running 8 tests, 5 view models in 0 hours 0 minutes and 12.68 seconds (12.68s).
[0m01:28:36.499629 [debug] [MainThread]: Command end result
[0m01:28:36.560277 [info ] [MainThread]: 
[0m01:28:36.560712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:36.560989 [info ] [MainThread]: 
[0m01:28:36.561220 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m01:28:36.561622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259cd6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259cdff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259cd4e0>]}
[0m01:28:36.561978 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:38:38.904331 | 828df138-884a-48b7-8e7f-3b1e77c78602 ==============================
[0m01:38:38.904331 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:38:38.909928 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:38:38.910300 [debug] [MainThread]: Tracking: tracking
[0m01:38:38.910751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109114040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b631c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b630850>]}
[0m01:38:38.987188 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:38:39.052536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:38:39.053604 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/schema.yml
[0m01:38:39.073337 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/beds_baths_median_price.sql
[0m01:38:39.163155 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:38:39.170657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2880d0>]}
[0m01:38:39.183401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7ebd30>]}
[0m01:38:39.183927 [info ] [MainThread]: Found 5 models, 18 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:38:39.184291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d3c10>]}
[0m01:38:39.186518 [info ] [MainThread]: 
[0m01:38:39.188747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:38:39.190108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:38:39.209029 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:38:39.209569 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:38:39.209899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:40.089945 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:38:40.092214 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:38:40.243307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:38:40.250973 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:38:40.251280 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:38:40.251466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:38:40.787105 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:38:40.789782 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:38:40.925566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c245060>]}
[0m01:38:40.926830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:38:40.927399 [info ] [MainThread]: 
[0m01:38:40.933186 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:38:40.933798 [info ] [Thread-1 (]: 1 of 23 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:38:40.934978 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:38:40.935326 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:38:40.952849 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:38:40.953887 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:38:40.935509 => 2023-07-25 01:38:40.953814
[0m01:38:40.954158 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:38:40.972738 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:38:40.973846 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:38:40.974060 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:38:40.974229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:41.572082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:41.581790 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:38:40.954313 => 2023-07-25 01:38:41.581708
[0m01:38:41.582153 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:38:41.717777 [info ] [Thread-1 (]: 1 of 23 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.78s]
[0m01:38:41.720311 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:38:41.720837 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:38:41.721269 [info ] [Thread-1 (]: 2 of 23 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:38:41.722173 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:38:41.722486 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:38:41.727565 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:38:41.728172 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:38:41.722655 => 2023-07-25 01:38:41.728113
[0m01:38:41.728410 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:38:41.732203 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:38:41.733210 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:38:41.733400 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:38:41.733578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:42.261512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:42.264538 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:38:41.728563 => 2023-07-25 01:38:42.264424
[0m01:38:42.264966 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:38:42.399734 [info ] [Thread-1 (]: 2 of 23 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.68s]
[0m01:38:42.400513 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:38:42.401588 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:38:42.402292 [info ] [Thread-1 (]: 3 of 23 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:38:42.403361 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:38:42.403716 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:38:42.406989 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:38:42.408006 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:38:42.404034 => 2023-07-25 01:38:42.407935
[0m01:38:42.408251 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:38:42.432811 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:38:42.434405 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:38:42.434626 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:38:42.434818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:43.128341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:43.148364 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:38:42.408394 => 2023-07-25 01:38:43.148245
[0m01:38:43.148680 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:38:43.290189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c73aaa0>]}
[0m01:38:43.290982 [info ] [Thread-1 (]: 3 of 23 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.89s]
[0m01:38:43.291486 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:38:43.292376 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:38:43.292856 [info ] [Thread-1 (]: 4 of 23 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:38:43.295569 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:38:43.295823 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:38:43.299988 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:38:43.300574 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:38:43.295965 => 2023-07-25 01:38:43.300520
[0m01:38:43.300779 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:38:43.303052 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:38:43.304127 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:38:43.304336 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:38:43.304503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:44.467612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:44.471003 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:38:43.300912 => 2023-07-25 01:38:44.470885
[0m01:38:44.471462 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:38:44.605937 [info ] [Thread-1 (]: 4 of 23 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.31s]
[0m01:38:44.607350 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:38:44.608252 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:38:44.609081 [info ] [Thread-1 (]: 5 of 23 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:38:44.610234 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:38:44.610487 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:38:44.614385 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:38:44.615327 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:38:44.610629 => 2023-07-25 01:38:44.615272
[0m01:38:44.615540 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:38:44.617835 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:38:44.619011 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:38:44.619232 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:38:44.619409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:45.524001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:45.526948 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:38:44.615672 => 2023-07-25 01:38:45.526836
[0m01:38:45.527433 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:38:45.661970 [info ] [Thread-1 (]: 5 of 23 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.05s]
[0m01:38:45.662920 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:38:45.663903 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:38:45.664854 [info ] [Thread-1 (]: 6 of 23 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:38:45.665894 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:38:45.666379 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:38:45.674459 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:38:45.675153 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:38:45.666647 => 2023-07-25 01:38:45.675087
[0m01:38:45.675405 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:38:45.678274 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:38:45.679319 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:38:45.679508 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:38:45.679682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:46.647722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:46.650573 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:38:45.675570 => 2023-07-25 01:38:46.650471
[0m01:38:46.650978 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:38:46.788826 [info ] [Thread-1 (]: 6 of 23 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 1.12s]
[0m01:38:46.789554 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:38:46.790939 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:38:46.791797 [info ] [Thread-1 (]: 7 of 23 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:38:46.792764 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:38:46.793126 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:38:46.797332 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:38:46.797960 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:38:46.793349 => 2023-07-25 01:38:46.797906
[0m01:38:46.798174 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:38:46.801074 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:38:46.802304 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:38:46.802474 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:38:46.802633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:47.414718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:47.418260 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:38:46.798310 => 2023-07-25 01:38:47.418176
[0m01:38:47.418688 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:38:47.581843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7b3190>]}
[0m01:38:47.582675 [info ] [Thread-1 (]: 7 of 23 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.79s]
[0m01:38:47.583197 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:38:47.583600 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:38:47.584244 [info ] [Thread-1 (]: 8 of 23 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:38:47.585220 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:38:47.585569 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:38:47.588597 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:38:47.589230 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:38:47.585773 => 2023-07-25 01:38:47.589178
[0m01:38:47.589467 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:38:47.592300 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:38:47.593427 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:38:47.593598 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
         -- create a primary key for this model
        md5(
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bathrooms, 0)
        ) as id,

        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:38:47.593751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:48.269355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:48.273000 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:38:47.589606 => 2023-07-25 01:38:48.272919
[0m01:38:48.273404 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:38:48.419252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c703640>]}
[0m01:38:48.420028 [info ] [Thread-1 (]: 8 of 23 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.83s]
[0m01:38:48.420563 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:38:48.421014 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:38:48.421573 [info ] [Thread-1 (]: 9 of 23 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:38:48.422924 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:38:48.423540 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:38:48.427003 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:38:48.427574 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:38:48.423775 => 2023-07-25 01:38:48.427516
[0m01:38:48.427788 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:38:48.431947 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:38:48.433119 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:38:48.433293 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        -- create a primary key for this model
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bedrooms, 0)
        ) as id,

        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:38:48.433447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:49.080243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:49.083955 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:38:48.427921 => 2023-07-25 01:38:49.083854
[0m01:38:49.084371 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:38:49.234038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4cba00>]}
[0m01:38:49.235026 [info ] [Thread-1 (]: 9 of 23 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.81s]
[0m01:38:49.235895 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:38:49.236336 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:38:49.236824 [info ] [Thread-1 (]: 10 of 23 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:38:49.237495 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:38:49.237693 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:38:49.257333 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:38:49.261651 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:38:49.237820 => 2023-07-25 01:38:49.261450
[0m01:38:49.262282 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:38:49.274509 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:38:49.282636 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:38:49.286126 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

price_buckets as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from listings
    group by iteration_date, price_bucket
),

final as (
    -- create a primary key for this model
    select 
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(price_bucket::varchar, '')
        ) as id,

        iteration_date,
        price_bucket,
        avg_days_on_market
    from price_buckets
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m01:38:49.290331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:49.934572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:49.938133 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:38:49.263076 => 2023-07-25 01:38:49.938046
[0m01:38:49.938646 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:38:50.068852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828df138-884a-48b7-8e7f-3b1e77c78602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4c90c0>]}
[0m01:38:50.069657 [info ] [Thread-1 (]: 10 of 23 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.83s]
[0m01:38:50.070249 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:38:50.070934 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:38:50.071663 [info ] [Thread-1 (]: 11 of 23 START test not_null_beds_baths_median_price_id ........................ [RUN]
[0m01:38:50.073199 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513'
[0m01:38:50.073720 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:38:50.079713 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:38:50.080794 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (compile): 2023-07-25 01:38:50.073962 => 2023-07-25 01:38:50.080721
[0m01:38:50.081077 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:38:50.084065 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:38:50.085022 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:38:50.085218 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.beds_baths_median_price
where id is null



      
    ) dbt_internal_test
[0m01:38:50.085399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:50.715726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:50.719010 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (execute): 2023-07-25 01:38:50.081240 => 2023-07-25 01:38:50.718902
[0m01:38:50.719447 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513: Close
[0m01:38:50.880833 [info ] [Thread-1 (]: 11 of 23 PASS not_null_beds_baths_median_price_id .............................. [[32mPASS[0m in 0.81s]
[0m01:38:50.881553 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:38:50.881995 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:38:50.882390 [info ] [Thread-1 (]: 12 of 23 START test not_null_beds_baths_median_price_iteration_date ............ [RUN]
[0m01:38:50.883286 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d'
[0m01:38:50.883670 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:38:50.946663 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:38:50.947422 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (compile): 2023-07-25 01:38:50.883888 => 2023-07-25 01:38:50.947350
[0m01:38:50.947718 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:38:50.951787 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:38:50.953039 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:38:50.953345 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.beds_baths_median_price
where iteration_date is null



      
    ) dbt_internal_test
[0m01:38:50.953584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:51.603991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:51.606939 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (execute): 2023-07-25 01:38:50.947900 => 2023-07-25 01:38:51.606846
[0m01:38:51.607305 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d: Close
[0m01:38:51.745243 [info ] [Thread-1 (]: 12 of 23 PASS not_null_beds_baths_median_price_iteration_date .................. [[32mPASS[0m in 0.86s]
[0m01:38:51.745935 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:38:51.746458 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:38:51.746864 [info ] [Thread-1 (]: 13 of 23 START test unique_beds_baths_median_price_id .......................... [RUN]
[0m01:38:51.748006 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9'
[0m01:38:51.748408 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:38:51.753534 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:38:51.754120 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (compile): 2023-07-25 01:38:51.748657 => 2023-07-25 01:38:51.754066
[0m01:38:51.754328 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:38:51.756794 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:38:51.757669 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:38:51.757837 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.beds_baths_median_price
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:38:51.757989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:52.287733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:52.290801 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (execute): 2023-07-25 01:38:51.754461 => 2023-07-25 01:38:52.290686
[0m01:38:52.291249 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9: Close
[0m01:38:52.424992 [info ] [Thread-1 (]: 13 of 23 PASS unique_beds_baths_median_price_id ................................ [[32mPASS[0m in 0.68s]
[0m01:38:52.425759 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:38:52.426312 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m01:38:52.426783 [info ] [Thread-1 (]: 14 of 23 START test not_null_distinct_num_baths_per_iteration_id ............... [RUN]
[0m01:38:52.427835 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32'
[0m01:38:52.428275 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m01:38:52.433642 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m01:38:52.434223 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32 (compile): 2023-07-25 01:38:52.428541 => 2023-07-25 01:38:52.434169
[0m01:38:52.434441 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m01:38:52.438115 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m01:38:52.438992 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m01:38:52.439164 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where id is null



      
    ) dbt_internal_test
[0m01:38:52.439315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:53.207186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:53.211043 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32 (execute): 2023-07-25 01:38:52.434577 => 2023-07-25 01:38:53.210941
[0m01:38:53.211483 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32: Close
[0m01:38:53.351244 [info ] [Thread-1 (]: 14 of 23 PASS not_null_distinct_num_baths_per_iteration_id ..................... [[32mPASS[0m in 0.92s]
[0m01:38:53.352120 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m01:38:53.352905 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m01:38:53.353762 [info ] [Thread-1 (]: 15 of 23 START test not_null_distinct_num_baths_per_iteration_iteration_date ... [RUN]
[0m01:38:53.354679 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61'
[0m01:38:53.354913 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m01:38:53.359254 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m01:38:53.359859 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61 (compile): 2023-07-25 01:38:53.355059 => 2023-07-25 01:38:53.359801
[0m01:38:53.360084 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m01:38:53.362645 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m01:38:53.363489 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m01:38:53.363670 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where iteration_date is null



      
    ) dbt_internal_test
[0m01:38:53.363823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:54.057385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:54.060310 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61 (execute): 2023-07-25 01:38:53.360228 => 2023-07-25 01:38:54.060206
[0m01:38:54.064264 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61: Close
[0m01:38:54.238770 [info ] [Thread-1 (]: 15 of 23 PASS not_null_distinct_num_baths_per_iteration_iteration_date ......... [[32mPASS[0m in 0.88s]
[0m01:38:54.239680 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m01:38:54.240247 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m01:38:54.240739 [info ] [Thread-1 (]: 16 of 23 START test unique_distinct_num_baths_per_iteration_id ................. [RUN]
[0m01:38:54.241881 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3'
[0m01:38:54.242251 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m01:38:54.246573 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m01:38:54.247142 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3 (compile): 2023-07-25 01:38:54.242481 => 2023-07-25 01:38:54.247086
[0m01:38:54.247364 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m01:38:54.249788 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m01:38:54.250769 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m01:38:54.250984 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:38:54.251173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:54.837378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:54.840241 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3 (execute): 2023-07-25 01:38:54.247507 => 2023-07-25 01:38:54.840138
[0m01:38:54.840661 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3: Close
[0m01:38:54.997650 [info ] [Thread-1 (]: 16 of 23 PASS unique_distinct_num_baths_per_iteration_id ....................... [[32mPASS[0m in 0.76s]
[0m01:38:54.998372 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m01:38:54.998907 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m01:38:54.999261 [info ] [Thread-1 (]: 17 of 23 START test not_null_distinct_num_bedrooms_per_iteration_id ............ [RUN]
[0m01:38:55.000578 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827'
[0m01:38:55.001004 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m01:38:55.006522 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m01:38:55.007101 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827 (compile): 2023-07-25 01:38:55.001241 => 2023-07-25 01:38:55.007047
[0m01:38:55.007309 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m01:38:55.009642 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m01:38:55.010362 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m01:38:55.010523 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where id is null



      
    ) dbt_internal_test
[0m01:38:55.010673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:55.508466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:38:55.511675 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827 (execute): 2023-07-25 01:38:55.007438 => 2023-07-25 01:38:55.511554
[0m01:38:55.512191 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827: Close
[0m01:38:55.647558 [info ] [Thread-1 (]: 17 of 23 PASS not_null_distinct_num_bedrooms_per_iteration_id .................. [[32mPASS[0m in 0.65s]
[0m01:38:55.648316 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m01:38:55.648785 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m01:38:55.649242 [info ] [Thread-1 (]: 18 of 23 START test not_null_distinct_num_bedrooms_per_iteration_iteration_date  [RUN]
[0m01:38:55.650263 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c'
[0m01:38:55.650661 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m01:38:55.656982 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m01:38:55.657628 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c (compile): 2023-07-25 01:38:55.650904 => 2023-07-25 01:38:55.657566
[0m01:38:55.657875 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m01:38:55.660627 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m01:38:55.661535 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m01:38:55.661724 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where iteration_date is null



      
    ) dbt_internal_test
[0m01:38:55.661957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:56.490670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:56.494036 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c (execute): 2023-07-25 01:38:55.658029 => 2023-07-25 01:38:56.493901
[0m01:38:56.494544 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c: Close
[0m01:38:56.634235 [info ] [Thread-1 (]: 18 of 23 PASS not_null_distinct_num_bedrooms_per_iteration_iteration_date ...... [[32mPASS[0m in 0.98s]
[0m01:38:56.635063 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m01:38:56.635578 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m01:38:56.635977 [info ] [Thread-1 (]: 19 of 23 START test unique_distinct_num_bedrooms_per_iteration_id .............. [RUN]
[0m01:38:56.637184 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815'
[0m01:38:56.637547 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m01:38:56.642664 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m01:38:56.643270 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815 (compile): 2023-07-25 01:38:56.637807 => 2023-07-25 01:38:56.643214
[0m01:38:56.643487 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m01:38:56.647370 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m01:38:56.648491 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m01:38:56.648689 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:38:56.648866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:57.281040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:57.284103 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815 (execute): 2023-07-25 01:38:56.643625 => 2023-07-25 01:38:57.283985
[0m01:38:57.284566 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815: Close
[0m01:38:57.430435 [info ] [Thread-1 (]: 19 of 23 PASS unique_distinct_num_bedrooms_per_iteration_id .................... [[32mPASS[0m in 0.79s]
[0m01:38:57.433840 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m01:38:57.434637 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m01:38:57.435229 [info ] [Thread-1 (]: 20 of 23 START test not_null_price_buckets_days_on_market_id ................... [RUN]
[0m01:38:57.435888 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938'
[0m01:38:57.436093 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m01:38:57.440113 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m01:38:57.440671 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938 (compile): 2023-07-25 01:38:57.436229 => 2023-07-25 01:38:57.440616
[0m01:38:57.440874 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m01:38:57.443275 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m01:38:57.444028 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m01:38:57.444192 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where id is null



      
    ) dbt_internal_test
[0m01:38:57.444344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:58.004840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:58.007887 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938 (execute): 2023-07-25 01:38:57.441009 => 2023-07-25 01:38:58.007707
[0m01:38:58.008404 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938: Close
[0m01:38:58.157553 [info ] [Thread-1 (]: 20 of 23 PASS not_null_price_buckets_days_on_market_id ......................... [[32mPASS[0m in 0.72s]
[0m01:38:58.158250 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m01:38:58.158813 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m01:38:58.159252 [info ] [Thread-1 (]: 21 of 23 START test not_null_price_buckets_days_on_market_iteration_date ....... [RUN]
[0m01:38:58.160195 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc'
[0m01:38:58.160539 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m01:38:58.165241 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m01:38:58.165815 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc (compile): 2023-07-25 01:38:58.160746 => 2023-07-25 01:38:58.165764
[0m01:38:58.166008 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m01:38:58.168169 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m01:38:58.168883 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m01:38:58.169030 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where iteration_date is null



      
    ) dbt_internal_test
[0m01:38:58.169168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:58.669265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:58.672155 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc (execute): 2023-07-25 01:38:58.166126 => 2023-07-25 01:38:58.672053
[0m01:38:58.672574 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc: Close
[0m01:38:58.797533 [info ] [Thread-1 (]: 21 of 23 PASS not_null_price_buckets_days_on_market_iteration_date ............. [[32mPASS[0m in 0.64s]
[0m01:38:58.798300 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m01:38:58.798775 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m01:38:58.799280 [info ] [Thread-1 (]: 22 of 23 START test not_null_price_buckets_days_on_market_price_bucket ......... [RUN]
[0m01:38:58.800241 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936'
[0m01:38:58.800611 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m01:38:58.806820 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m01:38:58.807541 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936 (compile): 2023-07-25 01:38:58.800851 => 2023-07-25 01:38:58.807474
[0m01:38:58.807796 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m01:38:58.810786 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m01:38:58.811778 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m01:38:58.811974 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_bucket
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where price_bucket is null



      
    ) dbt_internal_test
[0m01:38:58.812154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:59.378804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:38:59.381959 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936 (execute): 2023-07-25 01:38:58.807955 => 2023-07-25 01:38:59.381820
[0m01:38:59.382346 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936: Close
[0m01:38:59.551446 [info ] [Thread-1 (]: 22 of 23 PASS not_null_price_buckets_days_on_market_price_bucket ............... [[32mPASS[0m in 0.75s]
[0m01:38:59.552327 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m01:38:59.552894 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m01:38:59.553393 [info ] [Thread-1 (]: 23 of 23 START test unique_price_buckets_days_on_market_id ..................... [RUN]
[0m01:38:59.554551 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685'
[0m01:38:59.554982 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m01:38:59.560531 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m01:38:59.561274 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685 (compile): 2023-07-25 01:38:59.555778 => 2023-07-25 01:38:59.561209
[0m01:38:59.561531 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m01:38:59.564566 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m01:38:59.565674 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m01:38:59.565870 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:38:59.566052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:00.218842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:39:00.222417 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685 (execute): 2023-07-25 01:38:59.561702 => 2023-07-25 01:39:00.222294
[0m01:39:00.222897 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685: Close
[0m01:39:00.354541 [info ] [Thread-1 (]: 23 of 23 PASS unique_price_buckets_days_on_market_id ........................... [[32mPASS[0m in 0.80s]
[0m01:39:00.355373 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m01:39:00.357420 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:39:00.358327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:00.358631 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685' was properly closed.
[0m01:39:00.359005 [info ] [MainThread]: 
[0m01:39:00.359490 [info ] [MainThread]: Finished running 18 tests, 5 view models in 0 hours 0 minutes and 21.17 seconds (21.17s).
[0m01:39:00.360836 [debug] [MainThread]: Command end result
[0m01:39:00.371056 [info ] [MainThread]: 
[0m01:39:00.371453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:39:00.371712 [info ] [MainThread]: 
[0m01:39:00.371928 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 TOTAL=23
[0m01:39:00.372270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c561630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ca1d0>]}
[0m01:39:00.372521 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 01:54:29.881083 | fcaa2cff-7f17-4333-b3e3-685a7383bfe3 ==============================
[0m01:54:29.881083 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:54:29.889308 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m01:54:29.889941 [debug] [MainThread]: Tracking: tracking
[0m01:54:29.890524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101bae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090d420>]}
[0m01:54:29.964653 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:54:30.027414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:54:30.027715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:54:30.028450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m01:54:30.035900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b6980>]}
[0m01:54:30.049568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111174fd0>]}
[0m01:54:30.050059 [info ] [MainThread]: Found 5 models, 18 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:54:30.050431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a2e90>]}
[0m01:54:30.052570 [info ] [MainThread]: 
[0m01:54:30.054746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:54:30.056111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m01:54:30.073897 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m01:54:30.074349 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m01:54:30.074603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:30.881433 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m01:54:30.883660 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m01:54:31.014764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m01:54:31.023363 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m01:54:31.023676 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m01:54:31.023865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:31.566231 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m01:54:31.569162 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m01:54:31.728833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111167400>]}
[0m01:54:31.729990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:31.730454 [info ] [MainThread]: 
[0m01:54:31.735902 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:54:31.736472 [info ] [Thread-1 (]: 1 of 23 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m01:54:31.738596 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m01:54:31.739024 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:54:31.756472 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:54:31.757438 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 01:54:31.739280 => 2023-07-25 01:54:31.757364
[0m01:54:31.757745 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:54:31.781332 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:54:31.782812 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m01:54:31.783059 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m01:54:31.783271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:32.240479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:54:32.251255 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 01:54:31.757932 => 2023-07-25 01:54:32.251176
[0m01:54:32.251608 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m01:54:32.499155 [info ] [Thread-1 (]: 1 of 23 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.76s]
[0m01:54:32.502082 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m01:54:32.502889 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:54:32.503381 [info ] [Thread-1 (]: 2 of 23 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m01:54:32.504451 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m01:54:32.504887 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:54:32.511760 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:54:32.512620 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 01:54:32.505126 => 2023-07-25 01:54:32.512542
[0m01:54:32.512955 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:54:32.516667 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:54:32.517989 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m01:54:32.518252 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m01:54:32.518495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:33.084724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:33.087782 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 01:54:32.513171 => 2023-07-25 01:54:33.087657
[0m01:54:33.088254 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m01:54:33.225285 [info ] [Thread-1 (]: 2 of 23 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.72s]
[0m01:54:33.226068 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m01:54:33.227129 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:54:33.227813 [info ] [Thread-1 (]: 3 of 23 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m01:54:33.229046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m01:54:33.229489 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:54:33.234139 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:54:33.234896 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 01:54:33.229733 => 2023-07-25 01:54:33.234823
[0m01:54:33.235276 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:54:33.264836 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:54:33.266820 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m01:54:33.267113 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m01:54:33.267362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:33.925166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:33.944703 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 01:54:33.235472 => 2023-07-25 01:54:33.944650
[0m01:54:33.945016 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m01:54:34.073386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176f760>]}
[0m01:54:34.074161 [info ] [Thread-1 (]: 3 of 23 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 0.84s]
[0m01:54:34.074800 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m01:54:34.075999 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:54:34.076512 [info ] [Thread-1 (]: 4 of 23 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m01:54:34.077408 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m01:54:34.077708 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:54:34.081940 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:54:34.082876 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 01:54:34.077860 => 2023-07-25 01:54:34.082805
[0m01:54:34.083153 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:54:34.085908 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:54:34.087089 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m01:54:34.087370 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m01:54:34.087563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:35.245973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:35.248976 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 01:54:34.083321 => 2023-07-25 01:54:35.248868
[0m01:54:35.249396 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m01:54:35.378373 [info ] [Thread-1 (]: 4 of 23 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.30s]
[0m01:54:35.379087 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m01:54:35.379509 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:54:35.379959 [info ] [Thread-1 (]: 5 of 23 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m01:54:35.380937 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m01:54:35.381315 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:54:35.386387 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:54:35.387028 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 01:54:35.381534 => 2023-07-25 01:54:35.386971
[0m01:54:35.387253 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:54:35.389718 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:54:35.390572 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m01:54:35.390742 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m01:54:35.390888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:36.216923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:36.221099 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 01:54:35.387389 => 2023-07-25 01:54:36.220994
[0m01:54:36.221543 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m01:54:36.357875 [info ] [Thread-1 (]: 5 of 23 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 0.98s]
[0m01:54:36.358718 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m01:54:36.359180 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:54:36.359675 [info ] [Thread-1 (]: 6 of 23 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m01:54:36.360697 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m01:54:36.361005 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:54:36.366898 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:54:36.367505 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 01:54:36.361154 => 2023-07-25 01:54:36.367453
[0m01:54:36.367716 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:54:36.371600 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:54:36.372592 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m01:54:36.372763 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:36.372915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:36.950122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:36.953010 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 01:54:36.367848 => 2023-07-25 01:54:36.952913
[0m01:54:36.953419 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m01:54:37.096667 [info ] [Thread-1 (]: 6 of 23 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 0.74s]
[0m01:54:37.097412 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m01:54:37.098551 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:54:37.099212 [info ] [Thread-1 (]: 7 of 23 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m01:54:37.100217 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m01:54:37.100584 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m01:54:37.103861 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:54:37.104529 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 01:54:37.100800 => 2023-07-25 01:54:37.104471
[0m01:54:37.104746 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m01:54:37.107604 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:54:37.108830 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m01:54:37.109011 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m01:54:37.109183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:37.693732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:37.697964 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 01:54:37.104881 => 2023-07-25 01:54:37.697886
[0m01:54:37.698382 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m01:54:37.826873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111778d30>]}
[0m01:54:37.827689 [info ] [Thread-1 (]: 7 of 23 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.73s]
[0m01:54:37.828242 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m01:54:37.828647 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:54:37.829291 [info ] [Thread-1 (]: 8 of 23 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m01:54:37.830210 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m01:54:37.830600 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:54:37.834223 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:54:37.834822 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 01:54:37.830839 => 2023-07-25 01:54:37.834769
[0m01:54:37.835034 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:54:37.837966 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:54:37.839147 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m01:54:37.839322 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
         -- create a primary key for this model
        md5(
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bathrooms, 0)
        ) as id,

        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m01:54:37.839471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:38.443965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:38.447406 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 01:54:37.835169 => 2023-07-25 01:54:38.447328
[0m01:54:38.447784 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m01:54:38.572288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111900bb0>]}
[0m01:54:38.573301 [info ] [Thread-1 (]: 8 of 23 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.74s]
[0m01:54:38.573812 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m01:54:38.574359 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:54:38.575062 [info ] [Thread-1 (]: 9 of 23 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m01:54:38.576147 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m01:54:38.576558 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:54:38.579256 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:54:38.579742 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 01:54:38.576780 => 2023-07-25 01:54:38.579692
[0m01:54:38.579939 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:54:38.582746 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:54:38.583839 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m01:54:38.583997 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        -- create a primary key for this model
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bedrooms, 0)
        ) as id,

        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m01:54:38.584142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:39.869853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:39.873401 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 01:54:38.580069 => 2023-07-25 01:54:39.873318
[0m01:54:39.873846 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m01:54:40.003058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185f940>]}
[0m01:54:40.004011 [info ] [Thread-1 (]: 9 of 23 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 1.43s]
[0m01:54:40.004635 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m01:54:40.005181 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:54:40.005942 [info ] [Thread-1 (]: 10 of 23 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m01:54:40.007161 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m01:54:40.007509 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:54:40.012475 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:54:40.013504 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 01:54:40.007738 => 2023-07-25 01:54:40.013408
[0m01:54:40.013824 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:54:40.018079 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:54:40.020893 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m01:54:40.021189 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

price_buckets as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from listings
    group by iteration_date, price_bucket
),

final as (
    -- create a primary key for this model
    select 
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(price_bucket::varchar, '')
        ) as id,

        iteration_date,
        price_bucket,
        avg_days_on_market
    from price_buckets
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m01:54:40.021409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:40.785650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:40.790262 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 01:54:40.014008 => 2023-07-25 01:54:40.790176
[0m01:54:40.790655 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m01:54:40.935059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcaa2cff-7f17-4333-b3e3-685a7383bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185f3d0>]}
[0m01:54:40.935847 [info ] [Thread-1 (]: 10 of 23 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.93s]
[0m01:54:40.936530 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m01:54:40.936997 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:54:40.937426 [info ] [Thread-1 (]: 11 of 23 START test not_null_beds_baths_median_price_id ........................ [RUN]
[0m01:54:40.938551 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513'
[0m01:54:40.938910 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:54:40.944469 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:54:40.945539 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (compile): 2023-07-25 01:54:40.939125 => 2023-07-25 01:54:40.945472
[0m01:54:40.945781 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:54:40.948265 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:54:40.949034 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m01:54:40.949200 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.beds_baths_median_price
where id is null



      
    ) dbt_internal_test
[0m01:54:40.949355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:41.559166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:41.562116 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (execute): 2023-07-25 01:54:40.945923 => 2023-07-25 01:54:41.562007
[0m01:54:41.562588 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513: Close
[0m01:54:41.702093 [info ] [Thread-1 (]: 11 of 23 PASS not_null_beds_baths_median_price_id .............................. [[32mPASS[0m in 0.76s]
[0m01:54:41.702879 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m01:54:41.703525 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:54:41.703998 [info ] [Thread-1 (]: 12 of 23 START test not_null_beds_baths_median_price_iteration_date ............ [RUN]
[0m01:54:41.705138 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d'
[0m01:54:41.705488 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:54:41.711611 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:54:41.712357 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (compile): 2023-07-25 01:54:41.705706 => 2023-07-25 01:54:41.712290
[0m01:54:41.712638 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:54:41.716033 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:54:41.717094 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m01:54:41.717312 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.beds_baths_median_price
where iteration_date is null



      
    ) dbt_internal_test
[0m01:54:41.717511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:42.538546 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:42.541733 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (execute): 2023-07-25 01:54:41.712817 => 2023-07-25 01:54:42.541631
[0m01:54:42.542151 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d: Close
[0m01:54:42.688731 [info ] [Thread-1 (]: 12 of 23 PASS not_null_beds_baths_median_price_iteration_date .................. [[32mPASS[0m in 0.98s]
[0m01:54:42.689507 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m01:54:42.690009 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:54:42.690463 [info ] [Thread-1 (]: 13 of 23 START test unique_beds_baths_median_price_id .......................... [RUN]
[0m01:54:42.691402 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9'
[0m01:54:42.691743 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:54:42.697125 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:54:42.697767 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (compile): 2023-07-25 01:54:42.691968 => 2023-07-25 01:54:42.697712
[0m01:54:42.697998 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:54:42.702189 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:54:42.703252 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m01:54:42.703449 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.beds_baths_median_price
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:42.703619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:43.215050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:43.218098 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (execute): 2023-07-25 01:54:42.698146 => 2023-07-25 01:54:43.217987
[0m01:54:43.218479 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9: Close
[0m01:54:43.345182 [info ] [Thread-1 (]: 13 of 23 PASS unique_beds_baths_median_price_id ................................ [[32mPASS[0m in 0.65s]
[0m01:54:43.346111 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m01:54:43.346638 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m01:54:43.347074 [info ] [Thread-1 (]: 14 of 23 START test not_null_distinct_num_baths_per_iteration_id ............... [RUN]
[0m01:54:43.348197 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32'
[0m01:54:43.348571 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m01:54:43.353389 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m01:54:43.354115 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32 (compile): 2023-07-25 01:54:43.348799 => 2023-07-25 01:54:43.354066
[0m01:54:43.354303 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m01:54:43.356435 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m01:54:43.357131 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m01:54:43.357275 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where id is null



      
    ) dbt_internal_test
[0m01:54:43.357409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:43.858725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:43.861791 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32 (execute): 2023-07-25 01:54:43.354419 => 2023-07-25 01:54:43.861675
[0m01:54:43.862282 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32: Close
[0m01:54:43.989063 [info ] [Thread-1 (]: 14 of 23 PASS not_null_distinct_num_baths_per_iteration_id ..................... [[32mPASS[0m in 0.64s]
[0m01:54:43.989786 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m01:54:43.990238 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m01:54:43.990686 [info ] [Thread-1 (]: 15 of 23 START test not_null_distinct_num_baths_per_iteration_iteration_date ... [RUN]
[0m01:54:43.991593 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61'
[0m01:54:43.991998 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m01:54:43.997788 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m01:54:43.998572 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61 (compile): 2023-07-25 01:54:43.992228 => 2023-07-25 01:54:43.998501
[0m01:54:43.998861 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m01:54:44.002235 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m01:54:44.003542 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m01:54:44.003768 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where iteration_date is null



      
    ) dbt_internal_test
[0m01:54:44.003978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:44.583439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:44.587571 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61 (execute): 2023-07-25 01:54:43.999041 => 2023-07-25 01:54:44.587474
[0m01:54:44.587976 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61: Close
[0m01:54:44.728934 [info ] [Thread-1 (]: 15 of 23 PASS not_null_distinct_num_baths_per_iteration_iteration_date ......... [[32mPASS[0m in 0.74s]
[0m01:54:44.729701 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m01:54:44.730160 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m01:54:44.730639 [info ] [Thread-1 (]: 16 of 23 START test unique_distinct_num_baths_per_iteration_id ................. [RUN]
[0m01:54:44.731507 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3'
[0m01:54:44.731934 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m01:54:44.787574 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m01:54:44.788189 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3 (compile): 2023-07-25 01:54:44.732150 => 2023-07-25 01:54:44.788135
[0m01:54:44.788402 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m01:54:44.790806 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m01:54:44.791707 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m01:54:44.791873 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:44.792026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:45.316431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:45.319365 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3 (execute): 2023-07-25 01:54:44.788534 => 2023-07-25 01:54:45.319260
[0m01:54:45.319942 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3: Close
[0m01:54:45.466145 [info ] [Thread-1 (]: 16 of 23 PASS unique_distinct_num_baths_per_iteration_id ....................... [[32mPASS[0m in 0.73s]
[0m01:54:45.466866 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m01:54:45.467339 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m01:54:45.467782 [info ] [Thread-1 (]: 17 of 23 START test not_null_distinct_num_bedrooms_per_iteration_id ............ [RUN]
[0m01:54:45.468748 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827'
[0m01:54:45.469321 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m01:54:45.474563 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m01:54:45.475194 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827 (compile): 2023-07-25 01:54:45.469599 => 2023-07-25 01:54:45.475143
[0m01:54:45.475399 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m01:54:45.477717 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m01:54:45.479983 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m01:54:45.480149 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where id is null



      
    ) dbt_internal_test
[0m01:54:45.480304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:45.988531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:45.991404 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827 (execute): 2023-07-25 01:54:45.475528 => 2023-07-25 01:54:45.991301
[0m01:54:45.992006 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827: Close
[0m01:54:46.130240 [info ] [Thread-1 (]: 17 of 23 PASS not_null_distinct_num_bedrooms_per_iteration_id .................. [[32mPASS[0m in 0.66s]
[0m01:54:46.131116 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m01:54:46.131738 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m01:54:46.132414 [info ] [Thread-1 (]: 18 of 23 START test not_null_distinct_num_bedrooms_per_iteration_iteration_date  [RUN]
[0m01:54:46.133534 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c'
[0m01:54:46.133958 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m01:54:46.138839 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m01:54:46.140297 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c (compile): 2023-07-25 01:54:46.134216 => 2023-07-25 01:54:46.140240
[0m01:54:46.140514 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m01:54:46.144084 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m01:54:46.144920 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m01:54:46.145086 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where iteration_date is null



      
    ) dbt_internal_test
[0m01:54:46.145234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:46.637463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m01:54:46.640370 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c (execute): 2023-07-25 01:54:46.140645 => 2023-07-25 01:54:46.640264
[0m01:54:46.640834 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c: Close
[0m01:54:46.775510 [info ] [Thread-1 (]: 18 of 23 PASS not_null_distinct_num_bedrooms_per_iteration_iteration_date ...... [[32mPASS[0m in 0.64s]
[0m01:54:46.776235 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m01:54:46.776667 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m01:54:46.777130 [info ] [Thread-1 (]: 19 of 23 START test unique_distinct_num_bedrooms_per_iteration_id .............. [RUN]
[0m01:54:46.778003 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815'
[0m01:54:46.778359 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m01:54:46.784852 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m01:54:46.785583 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815 (compile): 2023-07-25 01:54:46.778574 => 2023-07-25 01:54:46.785516
[0m01:54:46.785865 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m01:54:46.789115 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m01:54:46.790223 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m01:54:46.790438 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:46.790640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:47.427555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:47.430553 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815 (execute): 2023-07-25 01:54:46.786044 => 2023-07-25 01:54:47.430442
[0m01:54:47.431016 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815: Close
[0m01:54:47.562602 [info ] [Thread-1 (]: 19 of 23 PASS unique_distinct_num_bedrooms_per_iteration_id .................... [[32mPASS[0m in 0.78s]
[0m01:54:47.563350 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m01:54:47.563872 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m01:54:47.564323 [info ] [Thread-1 (]: 20 of 23 START test not_null_price_buckets_days_on_market_id ................... [RUN]
[0m01:54:47.565560 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938'
[0m01:54:47.565944 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m01:54:47.571073 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m01:54:47.571659 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938 (compile): 2023-07-25 01:54:47.566239 => 2023-07-25 01:54:47.571607
[0m01:54:47.571871 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m01:54:47.574261 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m01:54:47.575263 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m01:54:47.575475 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where id is null



      
    ) dbt_internal_test
[0m01:54:47.575636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:48.087780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:48.090891 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938 (execute): 2023-07-25 01:54:47.572003 => 2023-07-25 01:54:48.090779
[0m01:54:48.091359 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938: Close
[0m01:54:48.233133 [info ] [Thread-1 (]: 20 of 23 PASS not_null_price_buckets_days_on_market_id ......................... [[32mPASS[0m in 0.67s]
[0m01:54:48.234650 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m01:54:48.235527 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m01:54:48.236134 [info ] [Thread-1 (]: 21 of 23 START test not_null_price_buckets_days_on_market_iteration_date ....... [RUN]
[0m01:54:48.237049 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc'
[0m01:54:48.237403 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m01:54:48.242156 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m01:54:48.242803 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc (compile): 2023-07-25 01:54:48.237616 => 2023-07-25 01:54:48.242744
[0m01:54:48.243034 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m01:54:48.245807 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m01:54:48.246726 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m01:54:48.246913 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where iteration_date is null



      
    ) dbt_internal_test
[0m01:54:48.247086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:48.756237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:48.759113 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc (execute): 2023-07-25 01:54:48.243182 => 2023-07-25 01:54:48.759016
[0m01:54:48.759506 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc: Close
[0m01:54:48.883128 [info ] [Thread-1 (]: 21 of 23 PASS not_null_price_buckets_days_on_market_iteration_date ............. [[32mPASS[0m in 0.65s]
[0m01:54:48.883934 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m01:54:48.884392 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m01:54:48.884796 [info ] [Thread-1 (]: 22 of 23 START test not_null_price_buckets_days_on_market_price_bucket ......... [RUN]
[0m01:54:48.885708 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936'
[0m01:54:48.886061 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m01:54:48.891380 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m01:54:48.892136 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936 (compile): 2023-07-25 01:54:48.886280 => 2023-07-25 01:54:48.892084
[0m01:54:48.892347 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m01:54:48.894785 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m01:54:48.895559 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m01:54:48.895720 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_bucket
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where price_bucket is null



      
    ) dbt_internal_test
[0m01:54:48.895873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:49.420157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:49.428685 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936 (execute): 2023-07-25 01:54:48.892495 => 2023-07-25 01:54:49.428461
[0m01:54:49.429229 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936: Close
[0m01:54:49.584568 [info ] [Thread-1 (]: 22 of 23 PASS not_null_price_buckets_days_on_market_price_bucket ............... [[32mPASS[0m in 0.70s]
[0m01:54:49.585368 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m01:54:49.585943 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m01:54:49.586407 [info ] [Thread-1 (]: 23 of 23 START test unique_price_buckets_days_on_market_id ..................... [RUN]
[0m01:54:49.587406 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685'
[0m01:54:49.587803 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m01:54:49.593467 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m01:54:49.594449 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685 (compile): 2023-07-25 01:54:49.588035 => 2023-07-25 01:54:49.594367
[0m01:54:49.594749 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m01:54:49.599467 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m01:54:49.600720 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m01:54:49.600934 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:49.601123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:50.165051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m01:54:50.168244 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685 (execute): 2023-07-25 01:54:49.594929 => 2023-07-25 01:54:50.168088
[0m01:54:50.168703 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685: Close
[0m01:54:50.402248 [info ] [Thread-1 (]: 23 of 23 PASS unique_price_buckets_days_on_market_id ........................... [[32mPASS[0m in 0.82s]
[0m01:54:50.403249 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m01:54:50.406382 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:54:50.406982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:50.407165 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685' was properly closed.
[0m01:54:50.407408 [info ] [MainThread]: 
[0m01:54:50.407689 [info ] [MainThread]: Finished running 18 tests, 5 view models in 0 hours 0 minutes and 20.35 seconds (20.35s).
[0m01:54:50.408741 [debug] [MainThread]: Command end result
[0m01:54:50.417197 [info ] [MainThread]: 
[0m01:54:50.417572 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:54:50.417825 [info ] [MainThread]: 
[0m01:54:50.418030 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 TOTAL=23
[0m01:54:50.418335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111749a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090e830>]}
[0m01:54:50.418568 [debug] [MainThread]: Flushing usage events


============================== 2023-07-25 02:06:18.914188 | 3e8e71bf-73ec-44fd-a5b8-6472ca3eea75 ==============================
[0m02:06:18.914188 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:06:18.920111 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m02:06:18.920423 [debug] [MainThread]: Tracking: tracking
[0m02:06:18.920888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f25cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f24850>]}
[0m02:06:19.009149 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:06:19.075476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:06:19.075877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:06:19.076842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m02:06:19.086748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e8e71bf-73ec-44fd-a5b8-6472ca3eea75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af7ee0>]}
[0m02:06:19.102965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e8e71bf-73ec-44fd-a5b8-6472ca3eea75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120fd120>]}
[0m02:06:19.103549 [info ] [MainThread]: Found 5 models, 18 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:06:19.104005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8e71bf-73ec-44fd-a5b8-6472ca3eea75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107033c10>]}
[0m02:06:19.106820 [info ] [MainThread]: 
[0m02:06:19.109836 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:06:19.111714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m02:06:19.135293 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m02:06:19.135773 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m02:06:19.136081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:20.220949 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m02:06:20.223174 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m02:06:20.521253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m02:06:20.531165 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m02:06:20.531623 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m02:06:20.531897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:33.067287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:33.068537 [debug] [MainThread]: Connection 'list_ANALYTICS_DBT_NDW' was properly closed.
[0m02:06:33.069450 [info ] [MainThread]: 
[0m02:06:33.070493 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 13.96 seconds (13.96s).
[0m02:06:33.071528 [debug] [MainThread]: Flushing usage events
[0m02:06:33.249367 [info ] [MainThread]: ctrl-c


============================== 2023-07-25 02:06:52.585282 | 2d618975-566f-4489-9e49-424e7f45e57f ==============================
[0m02:06:52.585282 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:06:52.591286 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m02:06:52.591923 [debug] [MainThread]: Tracking: tracking
[0m02:06:52.592784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077baf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787ec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787ddb0>]}
[0m02:06:52.686510 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:06:52.744623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:06:52.744975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:06:52.745783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m02:06:52.754022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12859e9b0>]}
[0m02:06:52.767150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12855d000>]}
[0m02:06:52.767608 [info ] [MainThread]: Found 5 models, 18 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:06:52.767962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a2ec0>]}
[0m02:06:52.770156 [info ] [MainThread]: 
[0m02:06:52.772279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:06:52.773648 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m02:06:52.794421 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m02:06:52.794820 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m02:06:52.795081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:53.742807 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m02:06:53.745615 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m02:06:53.922527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m02:06:53.932116 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m02:06:53.932539 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m02:06:53.932773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:54.523202 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1 seconds
[0m02:06:54.526344 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m02:06:54.764326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a47580>]}
[0m02:06:54.765621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:06:54.766171 [info ] [MainThread]: 
[0m02:06:54.770706 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m02:06:54.771254 [info ] [Thread-1 (]: 1 of 23 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m02:06:54.772035 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m02:06:54.772272 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m02:06:54.786996 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m02:06:54.787879 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-25 02:06:54.772434 => 2023-07-25 02:06:54.787799
[0m02:06:54.788195 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m02:06:54.808771 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m02:06:54.810100 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m02:06:54.810346 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m02:06:54.810540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:57.075226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m02:06:57.086751 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-25 02:06:54.788383 => 2023-07-25 02:06:57.086633
[0m02:06:57.087239 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m02:06:57.347523 [info ] [Thread-1 (]: 1 of 23 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 2.58s]
[0m02:06:57.350900 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m02:06:57.351759 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m02:06:57.352213 [info ] [Thread-1 (]: 2 of 23 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m02:06:57.352937 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m02:06:57.353196 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m02:06:57.358233 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m02:06:57.358894 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-25 02:06:57.353353 => 2023-07-25 02:06:57.358834
[0m02:06:57.359135 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m02:06:57.361746 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m02:06:57.362714 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m02:06:57.362913 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m02:06:57.363100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:57.889476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:06:57.892538 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-25 02:06:57.359284 => 2023-07-25 02:06:57.892417
[0m02:06:57.893011 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m02:06:58.140237 [info ] [Thread-1 (]: 2 of 23 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.79s]
[0m02:06:58.141471 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m02:06:58.142421 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m02:06:58.143051 [info ] [Thread-1 (]: 3 of 23 START sql view model DBT_NDW.stg_property_sale_listings ................ [RUN]
[0m02:06:58.144014 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m02:06:58.144384 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m02:06:58.148089 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m02:06:58.148725 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-25 02:06:58.144703 => 2023-07-25 02:06:58.148660
[0m02:06:58.148974 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m02:06:58.175017 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m02:06:58.176539 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m02:06:58.176751 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    with listings_source as (

    select * from raw.realty_mole_property_api.property_sale_listings

),

final as (
    -- staging table for property_sale_listings, converting timestamps to dates
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
    
    -- convert timestamp to date
    -- iteration_date: the day this data was ingested into the raw database schema
    date(_airbyte_emitted_at) as iteration_date,
    
    -- address of the home in id form
    id,
    
    -- convert timestamp to date
    date(listeddate) as listed_date,
    
    formattedaddress as formatted_address,
    bathrooms as num_bathrooms,
    bedrooms as num_bedrooms,
    daysonmarket as days_on_market,
    price

    from listings_source
)

select * from final

-- from raw.realty_mole_property_api.property_sale_listings
  );
[0m02:06:58.176932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:58.984729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:06:59.008295 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-25 02:06:58.149130 => 2023-07-25 02:06:59.008236
[0m02:06:59.008633 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m02:06:59.184752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ecb490>]}
[0m02:06:59.185624 [info ] [Thread-1 (]: 3 of 23 OK created sql view model DBT_NDW.stg_property_sale_listings ........... [[32mSUCCESS 1[0m in 1.04s]
[0m02:06:59.186542 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m02:06:59.187687 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m02:06:59.188282 [info ] [Thread-1 (]: 4 of 23 START test not_null_stg_property_sale_listings_addr_iteration_date_id .. [RUN]
[0m02:06:59.189189 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m02:06:59.189549 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m02:06:59.194832 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m02:06:59.195525 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-25 02:06:59.189772 => 2023-07-25 02:06:59.195463
[0m02:06:59.195776 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m02:06:59.198431 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m02:06:59.199655 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m02:06:59.199889 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m02:06:59.200076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:00.503573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:00.506855 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-25 02:06:59.195936 => 2023-07-25 02:07:00.506727
[0m02:07:00.507342 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m02:07:00.674016 [info ] [Thread-1 (]: 4 of 23 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ........ [[32mPASS[0m in 1.49s]
[0m02:07:00.674748 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m02:07:00.675261 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m02:07:00.675688 [info ] [Thread-1 (]: 5 of 23 START test not_null_stg_property_sale_listings_iteration_date .......... [RUN]
[0m02:07:00.676719 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m02:07:00.677196 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m02:07:00.682729 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m02:07:00.683438 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-25 02:07:00.677415 => 2023-07-25 02:07:00.683377
[0m02:07:00.683682 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m02:07:00.686637 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m02:07:00.687652 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m02:07:00.687843 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m02:07:00.688018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:01.480384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:01.483780 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-25 02:07:00.683835 => 2023-07-25 02:07:01.483657
[0m02:07:01.484259 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m02:07:01.742808 [info ] [Thread-1 (]: 5 of 23 PASS not_null_stg_property_sale_listings_iteration_date ................ [[32mPASS[0m in 1.07s]
[0m02:07:01.744734 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m02:07:01.745672 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m02:07:01.746281 [info ] [Thread-1 (]: 6 of 23 START test unique_stg_property_sale_listings_addr_iteration_date_id .... [RUN]
[0m02:07:01.747428 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m02:07:01.747889 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m02:07:01.757186 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m02:07:01.757812 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-25 02:07:01.748124 => 2023-07-25 02:07:01.757753
[0m02:07:01.758054 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m02:07:01.762085 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m02:07:01.763130 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m02:07:01.763368 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:07:01.763586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:02.761598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:02.764524 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-25 02:07:01.758198 => 2023-07-25 02:07:02.764422
[0m02:07:02.764946 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m02:07:02.940108 [info ] [Thread-1 (]: 6 of 23 PASS unique_stg_property_sale_listings_addr_iteration_date_id .......... [[32mPASS[0m in 1.19s]
[0m02:07:02.942054 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m02:07:02.943774 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m02:07:02.944410 [info ] [Thread-1 (]: 7 of 23 START sql view model DBT_NDW.beds_baths_median_price ................... [RUN]
[0m02:07:02.945228 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m02:07:02.945482 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m02:07:02.948230 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m02:07:02.948774 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-25 02:07:02.945630 => 2023-07-25 02:07:02.948722
[0m02:07:02.948978 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m02:07:02.952006 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m02:07:02.953279 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.beds_baths_median_price"
[0m02:07:02.953447 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.beds_baths_median_price"} */
create or replace   view ANALYTICS.DBT_NDW.beds_baths_median_price
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this number of beds/baths and iteration_date,
    show the median price */
    select distinct 
        -- create a primary key for this model
        md5(
            coalesce(num_bedrooms, 0) ||
            coalesce(num_bathrooms, 0) ||
            coalesce(iteration_date::varchar, '') 
        ) as id,
        
        num_bedrooms, 
        num_bathrooms, 
        iteration_date, 
    
        median(price) as median_price
    
    from listings
    group by num_bedrooms, num_bathrooms, iteration_date
    order by num_bedrooms asc, num_bathrooms asc, iteration_date asc
)

select * from final
  );
[0m02:07:02.953599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:03.740509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:03.744307 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-25 02:07:02.949111 => 2023-07-25 02:07:03.744224
[0m02:07:03.744743 [debug] [Thread-1 (]: On model.real_estate_dbt_project.beds_baths_median_price: Close
[0m02:07:03.877539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1287ed6f0>]}
[0m02:07:03.878313 [info ] [Thread-1 (]: 7 of 23 OK created sql view model DBT_NDW.beds_baths_median_price .............. [[32mSUCCESS 1[0m in 0.93s]
[0m02:07:03.878897 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m02:07:03.879361 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m02:07:03.880106 [info ] [Thread-1 (]: 8 of 23 START sql view model DBT_NDW.distinct_num_baths_per_iteration .......... [RUN]
[0m02:07:03.881149 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m02:07:03.881523 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m02:07:03.884246 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m02:07:03.884787 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-25 02:07:03.881737 => 2023-07-25 02:07:03.884739
[0m02:07:03.884971 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m02:07:03.887563 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m02:07:03.888604 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m02:07:03.888756 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bathrooms */
    select distinct 
         -- create a primary key for this model
        md5(
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bathrooms, 0)
        ) as id,

        iteration_date, 
        num_bathrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bathrooms
    order by iteration_date asc, num_bathrooms asc
)

select * from final
  );
[0m02:07:03.888892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:04.637913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:04.642236 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-25 02:07:03.885104 => 2023-07-25 02:07:04.642152
[0m02:07:04.642806 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m02:07:04.858709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ee32b0>]}
[0m02:07:04.859600 [info ] [Thread-1 (]: 8 of 23 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ..... [[32mSUCCESS 1[0m in 0.98s]
[0m02:07:04.860469 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m02:07:04.861121 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m02:07:04.861593 [info ] [Thread-1 (]: 9 of 23 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ....... [RUN]
[0m02:07:04.862781 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m02:07:04.863227 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m02:07:04.865965 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m02:07:04.866561 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-25 02:07:04.863413 => 2023-07-25 02:07:04.866508
[0m02:07:04.866764 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m02:07:04.869545 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m02:07:04.870622 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m02:07:04.870784 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    with listings as (
    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings
),

final as (
    /* for this iteration_date, 
    show the count of each distinct number of bedrooms */
    select distinct 
        -- create a primary key for this model
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(num_bedrooms, 0)
        ) as id,

        iteration_date, 
        num_bedrooms, 
        
        count(*) as count
    
    from listings
    group by iteration_date, num_bedrooms
    order by iteration_date asc, num_bedrooms asc
)

select * from final
  );
[0m02:07:04.870931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:05.583807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:05.587302 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-25 02:07:04.866896 => 2023-07-25 02:07:05.587220
[0m02:07:05.587688 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m02:07:05.773040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ee0970>]}
[0m02:07:05.774180 [info ] [Thread-1 (]: 9 of 23 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration .. [[32mSUCCESS 1[0m in 0.91s]
[0m02:07:05.774938 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m02:07:05.775255 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m02:07:05.775540 [info ] [Thread-1 (]: 10 of 23 START sql view model DBT_NDW.price_buckets_days_on_market ............. [RUN]
[0m02:07:05.776185 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m02:07:05.776658 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m02:07:05.779553 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m02:07:05.780119 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-25 02:07:05.776848 => 2023-07-25 02:07:05.780064
[0m02:07:05.780342 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m02:07:05.783770 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m02:07:05.786011 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m02:07:05.786250 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    with listings as (

    select * from ANALYTICS.DBT_NDW.stg_property_sale_listings

),

price_buckets as (
    /* for this iteration_date, show the avg number of days on the market 
    per (pre-defined) price range */
    select distinct
        iteration_date, 
        case
            when price < 200000 then 'price_below_200000'
            when price between 200000 and 230000 then '01_price_in_low_200s'
            when price between 230001 and 250000 then '02_price_between_230001_250000'
            when price between 250001 and 260000 then '03_price_in_250s'
            when price between 260001 and 270000 then '04_price_in_260s'
            when price between 270001 and 280000 then '05_price_in_270s'
            when price between 280001 and 290000 then '06_price_in_280s'
            when price between 290001 and 300000 then '07_price_in_280s'
            when price between 300001 and 310000 then '08_price_in_300-310s'
            when price between 310001 and 310000 then '09_price_in_310s'
            ELSE 'price_above_310'
        end as price_bucket,
        
        round(avg(days_on_market), 2) as avg_days_on_market
    
    from listings
    group by iteration_date, price_bucket
),

final as (
    -- create a primary key for this model
    select 
        md5(            
            coalesce(iteration_date::varchar, '') ||
            coalesce(price_bucket::varchar, '')
        ) as id,

        iteration_date,
        price_bucket,
        avg_days_on_market
    from price_buckets
    order by iteration_date asc, price_bucket asc
)

select * from final
  );
[0m02:07:05.786426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:06.582411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:06.586312 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-25 02:07:05.780500 => 2023-07-25 02:07:06.586227
[0m02:07:06.586770 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m02:07:06.770356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d618975-566f-4489-9e49-424e7f45e57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ee2800>]}
[0m02:07:06.771113 [info ] [Thread-1 (]: 10 of 23 OK created sql view model DBT_NDW.price_buckets_days_on_market ........ [[32mSUCCESS 1[0m in 0.99s]
[0m02:07:06.771624 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m02:07:06.772134 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m02:07:06.772857 [info ] [Thread-1 (]: 11 of 23 START test not_null_beds_baths_median_price_id ........................ [RUN]
[0m02:07:06.774078 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513'
[0m02:07:06.774491 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m02:07:06.781125 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m02:07:06.782575 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (compile): 2023-07-25 02:07:06.774977 => 2023-07-25 02:07:06.782516
[0m02:07:06.782805 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m02:07:06.785226 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m02:07:06.785995 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m02:07:06.786160 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.beds_baths_median_price
where id is null



      
    ) dbt_internal_test
[0m02:07:06.786311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:07.827222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:07.830598 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (execute): 2023-07-25 02:07:06.782940 => 2023-07-25 02:07:07.830474
[0m02:07:07.831300 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513: Close
[0m02:07:08.004418 [info ] [Thread-1 (]: 11 of 23 PASS not_null_beds_baths_median_price_id .............................. [[32mPASS[0m in 1.23s]
[0m02:07:08.005147 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m02:07:08.005803 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m02:07:08.006262 [info ] [Thread-1 (]: 12 of 23 START test not_null_beds_baths_median_price_iteration_date ............ [RUN]
[0m02:07:08.007324 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d'
[0m02:07:08.007730 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m02:07:08.013975 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m02:07:08.014765 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (compile): 2023-07-25 02:07:08.008017 => 2023-07-25 02:07:08.014695
[0m02:07:08.015058 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m02:07:08.018778 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m02:07:08.020100 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m02:07:08.020374 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.beds_baths_median_price
where iteration_date is null



      
    ) dbt_internal_test
[0m02:07:08.020586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:08.778308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:08.781304 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (execute): 2023-07-25 02:07:08.015252 => 2023-07-25 02:07:08.781203
[0m02:07:08.781711 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d: Close
[0m02:07:09.000050 [info ] [Thread-1 (]: 12 of 23 PASS not_null_beds_baths_median_price_iteration_date .................. [[32mPASS[0m in 0.99s]
[0m02:07:09.000807 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m02:07:09.001280 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m02:07:09.001752 [info ] [Thread-1 (]: 13 of 23 START test unique_beds_baths_median_price_id .......................... [RUN]
[0m02:07:09.002896 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9'
[0m02:07:09.003308 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m02:07:09.008327 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m02:07:09.008987 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (compile): 2023-07-25 02:07:09.003528 => 2023-07-25 02:07:09.008925
[0m02:07:09.009231 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m02:07:09.013406 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m02:07:09.014435 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m02:07:09.014625 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.beds_baths_median_price
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:07:09.014797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:09.702647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:09.705772 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (execute): 2023-07-25 02:07:09.009380 => 2023-07-25 02:07:09.705659
[0m02:07:09.706212 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9: Close
[0m02:07:09.972051 [info ] [Thread-1 (]: 13 of 23 PASS unique_beds_baths_median_price_id ................................ [[32mPASS[0m in 0.97s]
[0m02:07:09.972974 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m02:07:09.973717 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m02:07:09.974150 [info ] [Thread-1 (]: 14 of 23 START test not_null_distinct_num_baths_per_iteration_id ............... [RUN]
[0m02:07:09.975447 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32'
[0m02:07:09.975835 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m02:07:09.980884 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m02:07:09.981901 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32 (compile): 2023-07-25 02:07:09.976089 => 2023-07-25 02:07:09.981841
[0m02:07:09.982127 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m02:07:09.984663 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m02:07:09.985488 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m02:07:09.985687 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where id is null



      
    ) dbt_internal_test
[0m02:07:09.985960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:10.740811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:10.743786 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32 (execute): 2023-07-25 02:07:09.982288 => 2023-07-25 02:07:10.743681
[0m02:07:10.744181 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32: Close
[0m02:07:10.972921 [info ] [Thread-1 (]: 14 of 23 PASS not_null_distinct_num_baths_per_iteration_id ..................... [[32mPASS[0m in 1.00s]
[0m02:07:10.973618 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m02:07:10.974110 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m02:07:10.974570 [info ] [Thread-1 (]: 15 of 23 START test not_null_distinct_num_baths_per_iteration_iteration_date ... [RUN]
[0m02:07:10.975503 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61'
[0m02:07:10.975857 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m02:07:10.981388 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m02:07:10.981999 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61 (compile): 2023-07-25 02:07:10.976138 => 2023-07-25 02:07:10.981942
[0m02:07:10.982216 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m02:07:10.984976 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m02:07:10.985846 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m02:07:10.986024 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where iteration_date is null



      
    ) dbt_internal_test
[0m02:07:10.986185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:11.584921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:11.587903 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61 (execute): 2023-07-25 02:07:10.982351 => 2023-07-25 02:07:11.587791
[0m02:07:11.588345 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61: Close
[0m02:07:11.761062 [info ] [Thread-1 (]: 15 of 23 PASS not_null_distinct_num_baths_per_iteration_iteration_date ......... [[32mPASS[0m in 0.79s]
[0m02:07:11.761817 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m02:07:11.762246 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m02:07:11.762687 [info ] [Thread-1 (]: 16 of 23 START test unique_distinct_num_baths_per_iteration_id ................. [RUN]
[0m02:07:11.763707 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3'
[0m02:07:11.764080 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m02:07:11.818060 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m02:07:11.818715 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3 (compile): 2023-07-25 02:07:11.764291 => 2023-07-25 02:07:11.818660
[0m02:07:11.818934 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m02:07:11.821374 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m02:07:11.822325 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m02:07:11.822504 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:07:11.822667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:12.669922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:12.675046 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3 (execute): 2023-07-25 02:07:11.819072 => 2023-07-25 02:07:12.674931
[0m02:07:12.675519 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3: Close
[0m02:07:12.926076 [info ] [Thread-1 (]: 16 of 23 PASS unique_distinct_num_baths_per_iteration_id ....................... [[32mPASS[0m in 1.16s]
[0m02:07:12.927062 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m02:07:12.927614 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m02:07:12.928131 [info ] [Thread-1 (]: 17 of 23 START test not_null_distinct_num_bedrooms_per_iteration_id ............ [RUN]
[0m02:07:12.929354 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827'
[0m02:07:12.929806 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m02:07:12.934702 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m02:07:12.935381 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827 (compile): 2023-07-25 02:07:12.930031 => 2023-07-25 02:07:12.935322
[0m02:07:12.935622 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m02:07:12.938385 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m02:07:12.939331 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m02:07:12.939532 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where id is null



      
    ) dbt_internal_test
[0m02:07:12.939705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:13.727782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:13.730757 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827 (execute): 2023-07-25 02:07:12.935786 => 2023-07-25 02:07:13.730667
[0m02:07:13.731122 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827: Close
[0m02:07:13.996520 [info ] [Thread-1 (]: 17 of 23 PASS not_null_distinct_num_bedrooms_per_iteration_id .................. [[32mPASS[0m in 1.07s]
[0m02:07:13.997221 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m02:07:13.997724 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m02:07:13.998183 [info ] [Thread-1 (]: 18 of 23 START test not_null_distinct_num_bedrooms_per_iteration_iteration_date  [RUN]
[0m02:07:13.999269 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c'
[0m02:07:13.999652 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m02:07:14.004720 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m02:07:14.005616 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c (compile): 2023-07-25 02:07:13.999864 => 2023-07-25 02:07:14.005549
[0m02:07:14.005861 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m02:07:14.009622 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m02:07:14.010528 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m02:07:14.010707 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where iteration_date is null



      
    ) dbt_internal_test
[0m02:07:14.010865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:14.698108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:14.701190 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c (execute): 2023-07-25 02:07:14.006008 => 2023-07-25 02:07:14.701074
[0m02:07:14.701649 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c: Close
[0m02:07:14.883899 [info ] [Thread-1 (]: 18 of 23 PASS not_null_distinct_num_bedrooms_per_iteration_iteration_date ...... [[32mPASS[0m in 0.89s]
[0m02:07:14.884641 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m02:07:14.885099 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m02:07:14.885581 [info ] [Thread-1 (]: 19 of 23 START test unique_distinct_num_bedrooms_per_iteration_id .............. [RUN]
[0m02:07:14.886673 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815'
[0m02:07:14.887128 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m02:07:14.893590 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m02:07:14.894505 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815 (compile): 2023-07-25 02:07:14.887361 => 2023-07-25 02:07:14.894429
[0m02:07:14.894798 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m02:07:14.898179 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m02:07:14.899399 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m02:07:14.899622 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:07:14.899822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:15.610637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:15.613883 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815 (execute): 2023-07-25 02:07:14.894982 => 2023-07-25 02:07:15.613775
[0m02:07:15.614327 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815: Close
[0m02:07:15.868579 [info ] [Thread-1 (]: 19 of 23 PASS unique_distinct_num_bedrooms_per_iteration_id .................... [[32mPASS[0m in 0.98s]
[0m02:07:15.869314 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m02:07:15.870021 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m02:07:15.870493 [info ] [Thread-1 (]: 20 of 23 START test not_null_price_buckets_days_on_market_id ................... [RUN]
[0m02:07:15.871824 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938'
[0m02:07:15.873110 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m02:07:15.877569 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m02:07:15.878146 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938 (compile): 2023-07-25 02:07:15.873320 => 2023-07-25 02:07:15.878098
[0m02:07:15.878352 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m02:07:15.880922 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m02:07:15.881761 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m02:07:15.881935 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where id is null



      
    ) dbt_internal_test
[0m02:07:15.882091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:16.699684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:16.702836 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938 (execute): 2023-07-25 02:07:15.878484 => 2023-07-25 02:07:16.702725
[0m02:07:16.703280 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938: Close
[0m02:07:16.973554 [info ] [Thread-1 (]: 20 of 23 PASS not_null_price_buckets_days_on_market_id ......................... [[32mPASS[0m in 1.10s]
[0m02:07:16.974551 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m02:07:16.975168 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m02:07:16.975624 [info ] [Thread-1 (]: 21 of 23 START test not_null_price_buckets_days_on_market_iteration_date ....... [RUN]
[0m02:07:16.976883 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc'
[0m02:07:16.977307 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m02:07:16.983091 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m02:07:16.983770 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc (compile): 2023-07-25 02:07:16.977544 => 2023-07-25 02:07:16.983710
[0m02:07:16.984014 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m02:07:16.986914 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m02:07:16.987925 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m02:07:16.988126 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where iteration_date is null



      
    ) dbt_internal_test
[0m02:07:16.988306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:18.795952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m02:07:18.798934 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc (execute): 2023-07-25 02:07:16.984169 => 2023-07-25 02:07:18.798822
[0m02:07:18.799390 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc: Close
[0m02:07:18.988426 [info ] [Thread-1 (]: 21 of 23 PASS not_null_price_buckets_days_on_market_iteration_date ............. [[32mPASS[0m in 2.01s]
[0m02:07:18.989164 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m02:07:18.989746 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m02:07:18.990215 [info ] [Thread-1 (]: 22 of 23 START test not_null_price_buckets_days_on_market_price_bucket ......... [RUN]
[0m02:07:18.991281 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936'
[0m02:07:18.991650 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m02:07:18.997563 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m02:07:18.999935 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936 (compile): 2023-07-25 02:07:18.991866 => 2023-07-25 02:07:18.999856
[0m02:07:19.000260 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m02:07:19.003747 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m02:07:19.005220 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m02:07:19.005502 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_bucket
from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where price_bucket is null



      
    ) dbt_internal_test
[0m02:07:19.005729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:19.714825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:19.717825 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936 (execute): 2023-07-25 02:07:19.000459 => 2023-07-25 02:07:19.717708
[0m02:07:19.718300 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936: Close
[0m02:07:19.972262 [info ] [Thread-1 (]: 22 of 23 PASS not_null_price_buckets_days_on_market_price_bucket ............... [[32mPASS[0m in 0.98s]
[0m02:07:19.973014 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m02:07:19.973453 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m02:07:19.973840 [info ] [Thread-1 (]: 23 of 23 START test unique_price_buckets_days_on_market_id ..................... [RUN]
[0m02:07:19.974730 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685'
[0m02:07:19.975079 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m02:07:19.980165 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m02:07:19.980890 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685 (compile): 2023-07-25 02:07:19.975297 => 2023-07-25 02:07:19.980830
[0m02:07:19.981132 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m02:07:19.985414 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m02:07:19.986451 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m02:07:19.986635 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.price_buckets_days_on_market
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:07:19.986802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:20.813999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m02:07:20.816959 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685 (execute): 2023-07-25 02:07:19.981283 => 2023-07-25 02:07:20.816846
[0m02:07:20.817425 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685: Close
[0m02:07:21.078540 [info ] [Thread-1 (]: 23 of 23 PASS unique_price_buckets_days_on_market_id ........................... [[32mPASS[0m in 1.10s]
[0m02:07:21.079475 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m02:07:21.081674 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:07:21.082712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:21.083076 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685' was properly closed.
[0m02:07:21.083452 [info ] [MainThread]: 
[0m02:07:21.083941 [info ] [MainThread]: Finished running 18 tests, 5 view models in 0 hours 0 minutes and 28.31 seconds (28.31s).
[0m02:07:21.085137 [debug] [MainThread]: Command end result
[0m02:07:21.093218 [info ] [MainThread]: 
[0m02:07:21.093598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:07:21.093859 [info ] [MainThread]: 
[0m02:07:21.094068 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 TOTAL=23
[0m02:07:21.094371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d68910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128fa5060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128fa5810>]}
[0m02:07:21.094596 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 00:47:15.057739 | 7de48127-ad15-427c-8d37-3971efc2319b ==============================
[0m00:47:15.057739 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:47:15.067688 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m00:47:15.068025 [debug] [MainThread]: Tracking: tracking
[0m00:47:15.068429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109259c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925ac50>]}
[0m00:47:15.143440 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:47:15.202658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:47:15.202990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:47:15.203787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m00:47:15.212175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7de48127-ad15-427c-8d37-3971efc2319b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096fbee0>]}
[0m00:47:15.224901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de48127-ad15-427c-8d37-3971efc2319b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942d000>]}
[0m00:47:15.225298 [info ] [MainThread]: Found 5 models, 18 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:47:15.225603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de48127-ad15-427c-8d37-3971efc2319b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942ceb0>]}
[0m00:47:15.227469 [info ] [MainThread]: 
[0m00:47:15.229454 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:47:15.230550 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m00:47:15.246948 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m00:47:15.247313 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m00:47:15.247564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:17.367749 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2 seconds
[0m00:47:17.370692 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m00:47:17.629546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de48127-ad15-427c-8d37-3971efc2319b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941a410>]}
[0m00:47:17.631040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:47:17.631503 [info ] [MainThread]: 
[0m00:47:17.636075 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:47:17.636750 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m00:47:17.636995 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:47:17.640385 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m00:47:17.641548 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-29 00:47:17.637156 => 2023-07-29 00:47:17.641476
[0m00:47:17.641816 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:47:17.642024 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-29 00:47:17.641976 => 2023-07-29 00:47:17.641990
[0m00:47:17.643950 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m00:47:17.644296 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:47:17.645132 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m00:47:17.645411 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:47:17.660302 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m00:47:17.661408 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-29 00:47:17.645584 => 2023-07-29 00:47:17.661342
[0m00:47:17.661668 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:47:17.661868 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-29 00:47:17.661824 => 2023-07-29 00:47:17.661834
[0m00:47:17.662535 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m00:47:17.662859 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:47:17.663380 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m00:47:17.663604 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:47:17.668312 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m00:47:17.668989 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-29 00:47:17.663828 => 2023-07-29 00:47:17.668900
[0m00:47:17.669268 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:47:17.669473 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-29 00:47:17.669429 => 2023-07-29 00:47:17.669440
[0m00:47:17.670091 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m00:47:17.670376 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:47:17.670959 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.beds_baths_median_price'
[0m00:47:17.671194 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.beds_baths_median_price
[0m00:47:17.675488 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.beds_baths_median_price"
[0m00:47:17.676458 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (compile): 2023-07-29 00:47:17.671346 => 2023-07-29 00:47:17.676387
[0m00:47:17.676724 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.beds_baths_median_price
[0m00:47:17.676925 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.beds_baths_median_price (execute): 2023-07-29 00:47:17.676882 => 2023-07-29 00:47:17.676891
[0m00:47:17.677555 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.beds_baths_median_price
[0m00:47:17.677831 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:47:17.678510 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m00:47:17.678742 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:47:17.681486 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m00:47:17.682055 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-29 00:47:17.678891 => 2023-07-29 00:47:17.682000
[0m00:47:17.682294 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:47:17.682473 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-29 00:47:17.682436 => 2023-07-29 00:47:17.682444
[0m00:47:17.683044 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m00:47:17.683307 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:47:17.683771 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m00:47:17.684155 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:47:17.686798 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m00:47:17.687330 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-29 00:47:17.684298 => 2023-07-29 00:47:17.687279
[0m00:47:17.687537 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:47:17.687713 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-29 00:47:17.687675 => 2023-07-29 00:47:17.687684
[0m00:47:17.688302 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m00:47:17.688573 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:47:17.689269 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m00:47:17.689506 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:47:17.692659 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m00:47:17.693351 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-29 00:47:17.689654 => 2023-07-29 00:47:17.693286
[0m00:47:17.693610 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:47:17.693841 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-29 00:47:17.693791 => 2023-07-29 00:47:17.693803
[0m00:47:17.694543 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m00:47:17.694855 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:47:17.695696 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m00:47:17.696126 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:47:17.700923 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m00:47:17.701598 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-29 00:47:17.696313 => 2023-07-29 00:47:17.701535
[0m00:47:17.701848 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:47:17.702056 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-29 00:47:17.702011 => 2023-07-29 00:47:17.702020
[0m00:47:17.702713 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m00:47:17.703018 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:47:17.703724 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m00:47:17.704010 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:47:17.709066 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m00:47:17.709785 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-29 00:47:17.704186 => 2023-07-29 00:47:17.709718
[0m00:47:17.710062 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:47:17.710271 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-29 00:47:17.710226 => 2023-07-29 00:47:17.710235
[0m00:47:17.710918 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m00:47:17.711232 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:47:17.711895 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m00:47:17.712173 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:47:17.719986 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m00:47:17.720693 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-29 00:47:17.712345 => 2023-07-29 00:47:17.720633
[0m00:47:17.720954 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:47:17.721169 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-29 00:47:17.721122 => 2023-07-29 00:47:17.721133
[0m00:47:17.721856 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m00:47:17.722163 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m00:47:17.722799 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513'
[0m00:47:17.723053 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m00:47:17.729311 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513"
[0m00:47:17.730586 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (compile): 2023-07-29 00:47:17.723221 => 2023-07-29 00:47:17.730507
[0m00:47:17.730902 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m00:47:17.731138 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513 (execute): 2023-07-29 00:47:17.731088 => 2023-07-29 00:47:17.731098
[0m00:47:17.731853 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_id.65e9359513
[0m00:47:17.732171 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m00:47:17.732927 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d'
[0m00:47:17.733264 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m00:47:17.738421 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d"
[0m00:47:17.739118 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (compile): 2023-07-29 00:47:17.733470 => 2023-07-29 00:47:17.739050
[0m00:47:17.739374 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m00:47:17.739580 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d (execute): 2023-07-29 00:47:17.739536 => 2023-07-29 00:47:17.739545
[0m00:47:17.740236 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_beds_baths_median_price_iteration_date.922275902d
[0m00:47:17.740540 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m00:47:17.741168 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9'
[0m00:47:17.741395 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m00:47:17.746381 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9"
[0m00:47:17.747065 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (compile): 2023-07-29 00:47:17.741557 => 2023-07-29 00:47:17.746991
[0m00:47:17.747326 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m00:47:17.747537 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9 (execute): 2023-07-29 00:47:17.747492 => 2023-07-29 00:47:17.747502
[0m00:47:17.748229 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_beds_baths_median_price_id.31189d6cf9
[0m00:47:17.748536 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m00:47:17.749348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32'
[0m00:47:17.749668 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m00:47:17.754707 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32"
[0m00:47:17.755827 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32 (compile): 2023-07-29 00:47:17.749863 => 2023-07-29 00:47:17.755759
[0m00:47:17.756093 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m00:47:17.756311 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32 (execute): 2023-07-29 00:47:17.756264 => 2023-07-29 00:47:17.756274
[0m00:47:17.756996 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_id.6ddc4e9e32
[0m00:47:17.757313 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m00:47:17.757861 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61'
[0m00:47:17.758100 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m00:47:17.763176 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61"
[0m00:47:17.763845 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61 (compile): 2023-07-29 00:47:17.758357 => 2023-07-29 00:47:17.763785
[0m00:47:17.764093 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m00:47:17.764309 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61 (execute): 2023-07-29 00:47:17.764264 => 2023-07-29 00:47:17.764273
[0m00:47:17.764968 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_baths_per_iteration_iteration_date.a7e208cb61
[0m00:47:17.765281 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m00:47:17.765973 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3'
[0m00:47:17.766276 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m00:47:17.771220 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3"
[0m00:47:17.771972 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3 (compile): 2023-07-29 00:47:17.766458 => 2023-07-29 00:47:17.771907
[0m00:47:17.772229 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m00:47:17.772445 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3 (execute): 2023-07-29 00:47:17.772399 => 2023-07-29 00:47:17.772409
[0m00:47:17.773318 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_distinct_num_baths_per_iteration_id.79898965a3
[0m00:47:17.773633 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m00:47:17.774239 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827'
[0m00:47:17.774468 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m00:47:17.779195 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827"
[0m00:47:17.779913 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827 (compile): 2023-07-29 00:47:17.774632 => 2023-07-29 00:47:17.779833
[0m00:47:17.780200 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m00:47:17.780427 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827 (execute): 2023-07-29 00:47:17.780378 => 2023-07-29 00:47:17.780389
[0m00:47:17.781126 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_id.405aacb827
[0m00:47:17.781440 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m00:47:17.781992 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c'
[0m00:47:17.782335 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m00:47:17.789138 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c"
[0m00:47:17.789875 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c (compile): 2023-07-29 00:47:17.782570 => 2023-07-29 00:47:17.789808
[0m00:47:17.790141 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m00:47:17.790356 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c (execute): 2023-07-29 00:47:17.790310 => 2023-07-29 00:47:17.790321
[0m00:47:17.791030 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_distinct_num_bedrooms_per_iteration_iteration_date.64f0fab09c
[0m00:47:17.791342 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m00:47:17.792008 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815'
[0m00:47:17.792283 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m00:47:17.797076 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815"
[0m00:47:17.797763 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815 (compile): 2023-07-29 00:47:17.792457 => 2023-07-29 00:47:17.797704
[0m00:47:17.798016 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m00:47:17.798226 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815 (execute): 2023-07-29 00:47:17.798182 => 2023-07-29 00:47:17.798191
[0m00:47:17.798888 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_distinct_num_bedrooms_per_iteration_id.9ab5e17815
[0m00:47:17.799214 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m00:47:17.799840 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938'
[0m00:47:17.800120 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m00:47:17.805085 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938"
[0m00:47:17.805768 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938 (compile): 2023-07-29 00:47:17.800305 => 2023-07-29 00:47:17.805705
[0m00:47:17.806025 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m00:47:17.806241 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938 (execute): 2023-07-29 00:47:17.806191 => 2023-07-29 00:47:17.806200
[0m00:47:17.806909 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_id.860df4d938
[0m00:47:17.807225 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m00:47:17.807744 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc'
[0m00:47:17.807972 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m00:47:17.813241 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc"
[0m00:47:17.813922 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc (compile): 2023-07-29 00:47:17.808218 => 2023-07-29 00:47:17.813855
[0m00:47:17.814188 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m00:47:17.814408 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc (execute): 2023-07-29 00:47:17.814361 => 2023-07-29 00:47:17.814372
[0m00:47:17.815092 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_iteration_date.6ea69889dc
[0m00:47:17.815402 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m00:47:17.816046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936'
[0m00:47:17.816327 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m00:47:17.821212 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936"
[0m00:47:17.821856 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936 (compile): 2023-07-29 00:47:17.816502 => 2023-07-29 00:47:17.821796
[0m00:47:17.822101 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m00:47:17.822312 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936 (execute): 2023-07-29 00:47:17.822268 => 2023-07-29 00:47:17.822277
[0m00:47:17.822963 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_price_buckets_days_on_market_price_bucket.c441145936
[0m00:47:17.823269 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m00:47:17.823922 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685'
[0m00:47:17.824202 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m00:47:17.829074 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685"
[0m00:47:17.829731 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685 (compile): 2023-07-29 00:47:17.824379 => 2023-07-29 00:47:17.829671
[0m00:47:17.829988 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m00:47:17.830197 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685 (execute): 2023-07-29 00:47:17.830153 => 2023-07-29 00:47:17.830162
[0m00:47:17.830855 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685
[0m00:47:17.831716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:17.831992 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_price_buckets_days_on_market_id.af96fa0685' was properly closed.
[0m00:47:17.833134 [debug] [MainThread]: Command end result
[0m00:47:17.844897 [info ] [MainThread]: Done.
[0m00:47:17.847741 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m00:47:17.847995 [info ] [MainThread]: Building catalog
[0m00:47:17.849726 [debug] [ThreadPool]: Acquiring new snowflake connection 'ANALYTICS.information_schema'
[0m00:47:17.859091 [debug] [ThreadPool]: Using snowflake connection "ANALYTICS.information_schema"
[0m00:47:17.859461 [debug] [ThreadPool]: On ANALYTICS.information_schema: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "ANALYTICS.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from ANALYTICS.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from ANALYTICS.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_ndw'))
      order by "column_index"
[0m00:47:17.859733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:20.486407 [debug] [ThreadPool]: SQL status: SUCCESS 57 in 3 seconds
[0m00:47:20.506006 [debug] [ThreadPool]: On ANALYTICS.information_schema: Close
[0m00:47:20.747879 [debug] [ThreadPool]: Acquiring new snowflake connection 'raw.information_schema'
[0m00:47:20.753489 [debug] [ThreadPool]: Using snowflake connection "raw.information_schema"
[0m00:47:20.753797 [debug] [ThreadPool]: On raw.information_schema: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "raw.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from raw.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from raw.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('realty_mole_property_api'))
      order by "column_index"
[0m00:47:20.753984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:47:23.655576 [debug] [ThreadPool]: SQL status: SUCCESS 30 in 3 seconds
[0m00:47:23.664909 [debug] [ThreadPool]: On raw.information_schema: Close
[0m00:47:23.852520 [info ] [MainThread]: Catalog written to /Users/nathanwessel/Library/Mobile Documents/com~apple~CloudDocs/dbt-snowflake-airflow/airflow_dbt_real_estate_data/dags/dbt/real_estate_dbt_project/target/catalog.json
[0m00:47:23.853068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6640d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a664640>]}
[0m00:47:23.853369 [debug] [MainThread]: Flushing usage events
[0m00:47:24.199999 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:47:24.200558 [debug] [MainThread]: Connection 'raw.information_schema' was properly closed.
